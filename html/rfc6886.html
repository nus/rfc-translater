<!DOCTYPE html>

<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>RFC 6886 - NAT Port Mapping Protocol (NAT-PMP) 日本語訳</title>

  
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <link rel="stylesheet" href="master.css">
  <script src="index.js"></script>

  <script>
    var host = window.location.hostname;
    if (host != "localhost") {
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-75892425-1', 'auto');
      ga('send', 'pageview');
    }
  </script>

</head>
<body>
    <nav class="navbar navbar-expand navbar-light bg-light">
    <a class="navbar-brand" href="index.html">RFC Trans</a>
    <div class="collapse navbar-collapse" id="navbarText">
      <div class="navbar-nav mr-auto">
        <a class="nav-item nav-link" href="privacy-policy.html">Privacy Policy</a>
        <a class="nav-item nav-link" href="contact.html">Contact</a>
      </div>
      <div class="navbar-nav ml-auto">
        <span class="navbar-text"><small>@tex2e</small></span>
      </div>
    </div>
  </nav>

  <div style="height: 1ex;"></div>
  <div class="container">
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <div class="alert alert-info" role="alert">
          <h4 class="alert-heading">RFC 6886 - NAT Port Mapping Protocol (NAT-PMP) 日本語訳</h4>
          <span class="URL">URL :
            <a href="https://tools.ietf.org/html/rfc6886">
              https://tools.ietf.org/html/rfc6886
            </a>
          </span><br>
          <span class="title_ja">
            タイトル : <strong>RFC 6886 - NATポートマッピングプロトコル（NAT-PMP）</strong></span><br>
          <span class="updated_by">翻訳編集 : 自動生成</span><br>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
Independent Submission                                       S. Cheshire
Request for Comments: 6886                                   M. Krochmal
Category: Informational                                       Apple Inc.
ISSN: 2070-1721                                               April 2013
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                  NAT Port Mapping Protocol (NAT-PMP)
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Abstract
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
抽象
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document describes a protocol for automating the process of creating Network Address Translation (NAT) port mappings. Included in the protocol is a method for retrieving the external IPv4 address of a NAT gateway, thus allowing a client to make its external IPv4 address and port known to peers that may wish to communicate with it. From 2005 onwards, this protocol was implemented in Apple products including Mac OS X, Bonjour for Windows, and AirPort wireless base stations. In 2013, NAT Port Mapping Protocol (NAT-PMP) was superseded by the IETF Standards Track RFC &#34;Port Control Protocol (PCP)&#34;, which builds on NAT-PMP and uses a compatible packet format, but adds a number of significant enhancements.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この文書では、ネットワークアドレス変換（NAT）ポートマッピングを作成するプロセスを自動化するためのプロトコルを記述しています。プロトコルに含まれ、したがってそれと通信することを望むかもしれないピアに知られているその外部IPv4アドレスとポートを作成するクライアントを可能に、NATゲートウェイの外部IPv4アドレスを取得する方法です。 2005年以降、このプロトコルは、Mac OS X、BonjourのWindows用、およびAirMac無線基地局などのApple製品に実装されました。 2013年に、NATポートマッピングプロトコル（NAT-PMP）は、NAT-PMPの上に構築し、互換性のあるパケットフォーマットを使用していますが、重要な機能強化の数を追加するIETF標準化過程RFCの「ポート制御プロトコル（PCP）」、取って代わられました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Status of This Memo
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このメモのステータス
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document is not an Internet Standards Track specification; it is published for informational purposes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントはインターネット標準化過程仕様ではありません。それは、情報提供の目的のために公開されています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This is a contribution to the RFC Series, independently of any other RFC stream. The RFC Editor has chosen to publish this document at its discretion and makes no statement about its value for implementation or deployment. Documents approved for publication by the RFC Editor are not a candidate for any level of Internet Standard; see Section 2 of RFC 5741.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これは、独立して、他のRFCストリームの、RFCシリーズへの貢献です。 RFC Editorはその裁量でこの文書を公開することを選択し、実装や展開のためにその値についての声明を出すていません。 RFC編集者によって公表のために承認されたドキュメントは、インターネット標準の任意のレベルの候補ではありません。 RFC 5741のセクション2を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc6886.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントの現在の状態、任意の正誤表、そしてどのようにフィードバックを提供するための情報がhttp://www.rfc-editor.org/info/rfc6886で取得することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Copyright Notice
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著作権表示
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Copyright (c) 2013 IETF Trust and the persons identified as the document authors. All rights reserved.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著作権（C）2013 IETF信託とドキュメントの作成者として特定の人物。全著作権所有。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document is subject to BCP 78 and the IETF Trust&#39;s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この文書では、BCP 78と、この文書の発行日に有効なIETFドキュメント（http://trustee.ietf.org/license-info）に関連IETFトラストの法律の規定に従うものとします。彼らは、この文書に関してあなたの権利と制限を説明するように、慎重にこれらの文書を確認してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Table of Contents
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
目次
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   1. Introduction ....................................................3
      1.1. Transition to Port Control Protocol ........................4
   2. Conventions and Terminology Used in This Document ...............5
   3. Protocol and Packet Format ......................................5
      3.1. Requests and Responses .....................................6
      3.2. Determining the External Address ...........................7
      3.3. Requesting a Mapping ......................................10
      3.4. Destroying a Mapping ......................................13
      3.5. Result Codes ..............................................14
      3.6. Seconds Since Start of Epoch ..............................16
      3.7. Recreating Mappings on NAT Gateway Reboot .................16
      3.8. NAT Gateways with NAT Function Disabled ...................18
      3.9. All Mappings Are Bidirectional ............................19
   4. UNSAF Considerations ...........................................20
      4.1. Scope .....................................................20
      4.2. Transition Plan ...........................................20
      4.3. Failure Cases .............................................21
      4.4. Long-Term Solution ........................................23
      4.5. Existing Deployed NATs ....................................23
   5. Security Considerations ........................................23
   6. IANA Considerations ............................................24
   7. Acknowledgments ................................................24
   8. Deployment History .............................................25
   9. Noteworthy Features of NAT Port Mapping Protocol and PCP .......26
      9.1. Simplicity ................................................27
      9.2. Focused Scope .............................................27
      9.3. Efficiency ................................................27
      9.4. Atomic Allocation Operations ..............................29
      9.5. Garbage Collection ........................................29
      9.6. State Change Announcements ................................30
      9.7. Soft State Recovery .......................................31
      9.8. On-Path NAT Discovery .....................................31
   10. References ....................................................32
      10.1. Normative References .....................................32
      10.2. Informative References ...................................32
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1. Introduction
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.はじめに
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Network Address Translation (NAT) is a method of sharing one public Internet address with a number of devices. This document is focused on devices that are formally classified as &#34;NAPTs&#34; (Network Address/Port Translators) [RFC2663]. A full description of NAT is beyond the scope of this document. The following brief overview will cover the aspects relevant to this port mapping protocol. For more information on NAT, see &#34;Traditional IP Network Address Translator (Traditional NAT)&#34; [RFC3022].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ネットワークアドレス変換（NAT）は、デバイスの数と1つのパブリックインターネットアドレスを共有する方法です。この文書は、正式には「NAPTs」（ネットワークアドレス/ポート翻訳者）[RFC2663]に分類されるデバイスに焦点を当てています。 NATの詳細については、このドキュメントの範囲を超えています。以下の簡単な概要は、このポートマッピングプロトコルに関連する側面をカバーします。 NATの詳細については、「伝統的なIPネットワークアドレス変換（NAT繁体字）」[RFC3022]を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATs have one or more external IP addresses. A private network is set up behind the NAT. Client devices on that private network behind the NAT are assigned private addresses, and those client devices use the private address of the NAT device as their default gateway.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATは、1つまたは複数の外部IPアドレスを持っています。プライベートネットワークは、NATの背後に設定されています。 NATの背後にあるもの、プライベートネットワーク上のクライアントデバイスは、プライベートアドレスを割り当てられ、それらのクライアントデバイスは、デフォルトゲートウェイとしてNATデバイスのプライベートアドレスを使用します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a packet from any device behind the NAT is sent to an address on the public Internet, the packet first passes through the NAT box. The NAT box looks at the source port and address. In some cases, a NAT will also keep track of the destination port and address. The NAT then creates a mapping from the internal address and internal port to an external address and external port if a mapping does not already exist.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATの背後にある任意のデバイスからパケットが公共のインターネット上のアドレスに送信された場合、パケットが最初のNATボックスを通過します。 NATボックスには、送信元ポートとアドレスを調べます。いくつかのケースでは、NATは、宛先ポートとアドレスを追跡します。マッピングが存在しない場合、NATは、外部アドレスと外部ポートに内部アドレスと内部ポートからのマッピングを作成します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT box replaces the internal address and port in the packet with the external entries from the mapping and sends the packet on to the next gateway.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATボックスは、マッピングから外部のエントリとパケット内の内部アドレスとポートを置き換えて、次のゲートウェイに上のパケットを送信します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a packet from any address on the Internet is received on the NAT&#39;s external side, the NAT will look up the destination address and port (external address and port) in the list of mappings. If an entry is found, it will contain the internal address and port to which the packet should be sent. The NAT gateway will then rewrite the destination address and port with those from the mapping. The packet will then be forwarded to the new destination addresses. If the packet did not match any mapping, the packet will most likely be dropped. Various NATs implement different strategies to handle this. The important thing to note is that if there is no mapping, the NAT does not know to which internal address the packet should be sent.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
インターネット上の任意のアドレスからのパケットは、NATの外部側に受信された場合、NATは、マッピングのリストに宛先アドレスとポート（外部アドレスとポート）を検索します。エントリが見つかった場合、それは、パケットが送信すべき内部アドレスとポートが含まれています。 NATゲートウェイは、マッピングのものと宛先アドレスおよびポートを書き換えるであろう。パケットは、新しい宛先アドレスに転送されます。パケットがどのマッピングが一致しなかった場合、パケットはほとんど削除されます。様々なNATはこれを処理するために異なる戦略を実装しています。注意すべき重要なことは、マップが存在しない場合、NATは内部どのアドレスのパケットを送信すべきか分からないということです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Mappings are usually created automatically as a result of observing outbound packets. There are a few exceptions. Some NATs may allow manually created permanent mappings that map an external port to a specific internal IP address and port. Such a mapping allows incoming connections to the device with that internal address. Some NATs also implement a default mapping where any inbound packet that does not match any other more specific mapping will be forwarded to a specified internal address. Both types of mappings are usually set up manually through some configuration tool. Such manual configuration of port mappings is unreasonably onerous for most residential NAT users.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピングは、通常、アウトバウンドパケットを観察した結果として自動的に作成されます。いくつかの例外があります。いくつかのNATは、特定の内部IPアドレスとポートに外部ポートをマッピングし、手動で作成した永続的なマッピングを可能にすることができます。そのようなマッピングは、その内部アドレスを持つデバイスへの着信接続を可能にします。いくつかのNATはまた、他のより具体的なマッピングが一致しないすべての着信パケットは、指定された内部アドレスに転送されるデフォルトのマッピングを実装します。マッピングの両方のタイプは、通常、いくつかの設定ツールを使用して手動で設定されています。ポートマッピングのような手動設定は、ほとんどの住宅NATのユーザーのための不当厄介です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Without these manually created inbound port mappings, clients behind the NAT would be unable to receive inbound connections, which represents a loss of connectivity when compared to the original Internet architecture [ETEAISD]. For those who view this loss of connectivity as a bad thing, NAT-PMP allows clients to operate more like a host directly connected to the unrestricted public Internet, with an unrestricted public IPv4 address. NAT-PMP allows client hosts to communicate with the NAT gateway to request the creation of inbound mappings on demand. Having created a NAT mapping to allow inbound connections, the client can then record its external IPv4 address and external port in a public registry (e.g., the worldwide Domain Name System) or otherwise make it accessible to peers that wish to communicate with it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これらの手動で作成したインバウンドポートマッピングがなければ、NATの背後にあるクライアントは、元のインターネットアーキテクチャ[ETEAISD]と比較すると、接続の損失を表して着信接続を受信することができないであろう。悪いこととして、接続の損失を見る人のために、NAT-PMPは、クライアントが無制限のパブリックIPv4アドレスを使用して、より直接的に無制限の公衆インターネットに接続されたホストのように動作することができます。 NAT-PMPは、クライアントホストがオンデマンドでのインバウンドマッピングの作成を要求するNATゲートウェイと通信することを可能にします。着信接続を許可するようにNATマッピングを作成した後、公共のレジストリにその外部IPv4アドレスおよび外部ポートを記録することができ、クライアントは、（例えば、世界中のドメインネームシステム）、あるいはそれと通信したいピアからのアクセスを可能にできます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.1. Transition to Port Control Protocol
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.1。ポート制御プロトコルへの移行
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMP enjoyed almost a decade of useful service, and operational experience with NAT-PMP informed the design of its IETF Standards Track successor, Port Control Protocol (PCP) [RFC6887]. PCP builds on NAT-PMP, using the same UDP ports 5350 and 5351, and a compatible packet format. PCP also adds significant enhancements, including IPv6 support, management of outbound mappings, management of firewall rules, full compatibility with large-scale NATs with a pool of external addresses, error lifetimes, and an extension mechanism to enable future enhancements.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPは、便利なサービスの約10年を楽しんだ、とNAT-PMPと運用経験は、そのIETF標準化過程の後継者、ポート制御プロトコル（PCP）[RFC6887]のデザインを通知しました。 PCPは、同じUDPポート5350と5351、及び互換性のあるパケット・フォーマットを使用して、NAT-PMP上に構築します。 PCPはまた、IPv6のサポート、アウトバウンドのマッピングの管理、ファイアウォールルールの管理、外部アドレスのプールを備えた大規模NATのとの完全な互換性、エラーの寿命、および将来の拡張を可能にするための拡張メカニズムを含む大幅に強化し、追加します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Because of the significant enhancements in PCP, all existing NAT-PMP implementations are encouraged to migrate to PCP. The version number in the packet header is 0 for NAT-PMP and 2 for PCP, so the packets are easily distinguished. (Version number 1 was used by a vendor that shipped products that use a protocol that is incompatible with the IETF Standard. PCP implementations MUST NOT use version number 1.)
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
そのためPCPの大幅な機能強化により、既存のすべてのNAT-PMPの実装は、PCPに移行することをお勧めします。パケットヘッダのバージョン番号は、PCPのためのNAT-PMP 0及び2であるので、パケットは容易に区別されます。 （版数1 IETF標準と互換性がないプロトコルを使用する製品を出荷ベンダーによって使用された。PCP実装はバージョン番号1を使用してはいけません）
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
For NAT-PMP servers, adding PCP support is simple. When packets are received, if the version number is 2, then the packet is interpreted as a PCP request, the request is handled, and replies and updates pertaining to that mapping are sent using PCP format. If the version number is 0, then the existing code handles the request exactly as it already does, and replies and updates pertaining to that mapping are sent using NAT-PMP format. If the version number is 1 or any other unsupported version, then result code 1 (Unsupported Version) is returned.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPサーバーの場合、PCPのサポートを追加するのは簡単です。パケットが受信されると、バージョン番号が2である場合、パケットは、PCP要求として解釈される要求が処理され、そのマッピングに関連する応答と更新はPCPの形式を使用して送信されます。バージョン番号が0である場合には、既存のコードでは、それはすでにとまったく同じようにリクエストを処理し、そのマッピングに関する回答と更新がNAT-PMP形式を使用して送信されます。バージョン番号は1または任意の他のサポートされていないバージョンである場合、コード1（サポートされていない版）結果が返されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMP clients should add PCP support, and should default to sending requests using PCP format, which will cause clients to prefer the newer format when possible. If a PCP request is sent to an old NAT-PMP server that doesn&#39;t understand the new PCP format, then it will return result code 1 (Unsupported Version), and the client should then immediately retry the same request using NAT-PMP format. The presence of the Unsupported Version reply allows fast fail-over to NAT-PMP format, without waiting for timeouts, retransmissions, or other arbitrary delays. It is recommended that clients always try PCP first for every new request, retransmission, and renewal, and only try NAT-PMP in response to an &#34;Unsupported Version&#34; error. Clients SHOULD NOT record that a given server only speaks NAT-PMP and subsequently default to NAT-PMP for that server, since NAT firmware gets updated, and even a NAT gateway that speaks only NAT-PMP today, may be updated to speak PCP tomorrow.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPクライアントは、PCPのサポートを追加する必要がありますし、可能な場合、クライアントは、新しい形式を好むようになりますPCPの形式を使用して、送信要求をデフォルトにする必要があります。 PCP要求は、新たなPCPの形式を理解していない古いNAT-PMPサーバーに送信された場合、それは（サポートされていないバージョン）結果コード1を返し、クライアントは、その後すぐにNAT-PMP形式を使用して、同じ要求を再試行する必要があります。サポートされていないバージョン応答の存在は、タイムアウト、再送信、または他の任意の遅延を待つことなく、高速なフェイルオーバNAT-PMP形式にできます。クライアントは常にすべての新しい要求、再送信、および更新するための第1のPCPを試し、そして唯一の「サポートされていないバージョン」エラーに応じてNAT-PMPを試すことをお勧めします。クライアントは、特定のサーバーにのみNAT-PMPを話し、その後、そのサーバー用にNAT-PMPにデフォルト設定、NATファームウェアが更新されているので、今日だけNAT-PMPを話すも、NATゲートウェイは、明日PCPを話すように更新することができることを記録すべきではありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
2. Conventions and Terminology Used in This Document
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
この文書で使用される2.表記と用語
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;MAY&#34;, and &#34;OPTIONAL&#34; in this document are to be interpreted as described in &#34;Key words for use in RFCs to Indicate Requirement Levels&#34; [RFC2119].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この文書のキーワード &#34;MUST&#34;、 &#34;MUST NOT&#34;、 &#34;REQUIRED&#34;、、、、 &#34;べきではない&#34; &#34;べきである&#34; &#34;ないもの&#34; &#34;ものとし&#34;、 &#34;推奨&#34;、 &#34;MAY&#34;、および &#34;OPTIONAL&#34; はあります「要求レベルを示すためのRFCsにおける使用のためのキーワード」[RFC2119]に記載されているように解釈されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3. Protocol and Packet Format
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.プロトコルおよびパケットフォーマット
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT Port Mapping Protocol runs over UDP. Every packet starts with an 8-bit version followed by an 8-bit operation code.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATポートマッピングプロトコルはUDP上で実行されます。すべてのパケットは、8ビットの操作コードに続く8ビットのバージョンで始まります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
All numeric quantities in NAT-PMP larger than a single byte (e.g., error values, Seconds Since Start of Epoch, and mapping lifetime) are transmitted in the traditional IETF network byte order (i.e., most significant byte first).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
単一バイトより大きいNAT-PMPにおけるすべての数値の量（例えば、エラー値、Epochの開始、およびマッピング寿命からの秒）伝統的なIETFネットワークバイト順（即ち、最上位バイトが最初）で送信されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Non-numeric quantities in NAT-PMP larger than a single byte (e.g., the NAT gateway&#39;s external IP address) are transmitted in the natural byte order, with no byte swapping.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPで非数値量なしバイトスワッピングと、（例えば、NATゲートウェイの外部IPアドレス）が天然のバイト順序で送信される単一のバイトよりも大きいです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document specifies version 0 of the protocol. Any NAT-PMP gateway implementing this version of the protocol, receiving a request with a version number other than 0, MUST return result code 1 (Unsupported Version), indicating the highest version number it does support (i.e., 0) in the version field of the response.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントでは、プロトコルのバージョン0を指定します。任意のNAT-PMPゲートウェイ、プロトコルのこのバージョンを実装0以外のバージョン番号の要求を受信したが、それがサポートしてい最も高いバージョン番号を示す、結果コード1（サポートされていないバージョン）を返さなければならない（すなわち、0）内のバージョンフィールド応答の。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Opcodes between 0 and 127 are client requests. Opcodes from 128 to 255 are corresponding server responses. Responses always contain a 16-bit result code in network byte order. A result code of zero indicates success. Responses also contain a 32-bit unsigned integer corresponding to the number of seconds since the NAT gateway was rebooted or since its port mapping state was otherwise reset.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
0〜127のオペコードは、クライアント要求です。 128から255までのオペコードは、サーバーの応答を対応しています。応答は常にネットワークバイト順で16ビットの結果コードが含まれています。ゼロの結果コードが成功を示しています。応答はまた、NATゲートウェイが再起動された以降、またはそのポートマッピング状態がそうでなければリセットされてからの秒数に対応する32ビットの符号なし整数を含みます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This protocol SHOULD only be used when the client determines that its primary IPv4 address is in one of the private IPv4 address ranges defined in &#34;Address Allocation for Private Internets&#34; [RFC1918]. This includes the address ranges 10/8, 172.16/12, and 192.168/16.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントがプライマリIPv4アドレスが「個人的なインターネットのための配分」[RFC1918]で定義されたプライベートIPv4アドレス範囲の一つであると判断した場合、このプロトコルにのみ使用してください。これは10月8日、172.16 / 12の範囲、および192.168 / 16アドレスが含まれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Clients always send their NAT-PMP requests to their default gateway, as learned via DHCP [RFC2131], or similar means. This protocol is designed for small home networks, with a single logical link (subnet) where the client&#39;s default gateway is also the NAT for that network. For more complicated networks where the NAT is some device other than the client&#39;s default gateway, this protocol is not appropriate.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
DHCP [RFC2131]、または類似の手段を介して学習としてクライアントは常に、自分のデフォルトゲートウェイへのNAT-PMP要求を送信します。このプロトコルは、クライアントのデフォルトゲートウェイはまた、そのネットワークのNATで単一の論理リンク（サブネット）と、小規模なホームネットワーク用に設計されています。 NATは、クライアントのデフォルトゲートウェイ以外のいくつかのデバイスでより複雑なネットワークの場合、このプロトコルは適切ではありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.1. Requests and Responses
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.1。リクエストとレスポンス
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT gateways are often low-cost devices, with limited memory and CPU speed. For this reason, to avoid making excessive demands on the NAT gateway, clients SHOULD NOT issue multiple concurrent requests. If a client needs to perform multiple requests (e.g., on boot, wake from sleep, network connection, etc.), it SHOULD queue them and issue them serially, one at a time. Once the NAT gateway responds to one request the client machine may issue the next. In the case of a fast NAT gateway, the client may be able to complete requests at a rate of hundreds per second. In the case of a slow NAT gateway that takes perhaps half a second to respond to a NAT-PMP request, the client SHOULD respect this and allow the NAT gateway to operate at the pace it can manage, and not overload it by issuing requests faster than the rate it&#39;s answering them.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイは、限られたメモリやCPU速度で、多くの場合、低コストのデバイスです。このため、NATゲートウェイに過度の要求を避けるために、クライアントが複数の同時要求を発行するべきではありません。クライアントが複数の要求を実行する必要がある場合（例えば、ブート、スリープからのウェイク、ネットワーク接続などに）、それはそれらをキューすべきであり、それらは、連続的に一度に一つを発行します。 NATゲートウェイは一つのリクエストに応答すると、クライアント・マシンは、次を発行することができます。速いNATゲートウェイの場合、クライアントは、毎秒数百人の割合でリクエストを完了することができます。 NAT-PMP要求に応答するために、おそらく半分秒かかり遅いNATゲートウェイの場合、クライアントはこれを尊重し、NATゲートウェイは、それが管理できるペースで動作することを可能にし、より高速な要求を発行することによって、それをオーバーロードべきではありません率よりも、それはそれらに答えるいます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To determine the external IPv4 address, or to request a port mapping, a NAT-PMP client sends its request packet to port 5351 of its configured gateway address, and waits 250 ms for a response. If no NAT-PMP response is received from the gateway after 250 ms, the client retransmits its request and waits 500 ms. The client SHOULD repeat this process with the interval between attempts doubling each time. If, after sending its ninth attempt (and then waiting for 64 seconds), the client has still received no response, then it SHOULD conclude that this gateway does not support NAT Port Mapping Protocol and MAY log an error message indicating this fact. In addition, if the NAT-PMP client receives an &#34;ICMP Port Unreachable&#34; message from the gateway for port 5351, then it can skip any remaining retransmissions and conclude immediately that the gateway does not support NAT-PMP.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
外部IPv4アドレスを決定するために、またはポートマッピングを要求するために、NAT-PMPクライアントは、その構成ゲートウェイアドレスのポート5351への要求パケットを送信し、応答を250ミリ秒待機します。いかなるNAT-PMP応答が250ミリ秒後に、ゲートウェイから受信されない場合、クライアントは要求を再送信し、500ミリ秒待機します。クライアントは、各倍加時間試行間間隔でこのプロセスを繰り返す必要があります。 、その第九の試みを送信する（してから64秒間待って）した後、クライアントがまだ応答を受信しなかった場合、それは、このゲートウェイはNATポートマッピングプロトコルをサポートしていませんし、その旨を示すエラーメッセージを記録することがありますことを締結すべきです。 NAT-PMPクライアントは、ポート5351のゲートウェイから「ICMPポート到達不能」メッセージを受信した場合また、それは、残りの再送をスキップすることができ、ゲートウェイはNAT-PMPをサポートしていないことがすぐに結論付けています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
As a performance optimization the client MAY record this information and use it to suppress further attempts to use NAT-PMP, but the client should not retain this information for too long. In particular, any event that may indicate a potential change of gateway or a change in gateway configuration (hardware link change indication, change of gateway MAC address, acquisition of new DHCP lease, receipt of NAT-PMP announcement packet from gateway, etc.) should cause the client to discard its previous information regarding the gateway&#39;s lack of NAT-PMP support, and send its next NAT-PMP request packet normally.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パフォーマンスを最適化するクライアントは、この情報を記録し、NAT-PMPを使用するための更なる試みを抑制するためにそれを使用しますが、クライアントは、あまりにも長い間、この情報を保持すべきではないかもしれません。ゲートウェイまたはゲートウェイ構成（などのハードウェアリンク変更指示、ゲートウェイMACアドレスの変更、新しいDHCPリースの取得、ゲートウェイからNAT-PMP告知パケットの受信）の変化の電位変化を示すことができる。特に、いずれにせよクライアントがNAT-PMP対応のゲートウェイの不足に関する以前の情報を破棄させ、そして通常はその次のNAT-PMP要求パケットを送信する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When deleting a port mapping, the client uses the same initial 250 ms timeout, doubling on each successive interval, except that clients may choose not to try the full nine times before giving up. This is because mapping deletion requests are in some sense advisory. They are useful for efficiency, but not required for correctness; it is always possible for client software to crash, or for power to fail, or for a client device to be physically unplugged from the network before it gets a chance to send its mapping deletion request(s), so NAT gateways already need to cope with this case. Because of this, it may be acceptable for a client to retry only once or twice before giving up on deleting its port mapping(s), but a client SHOULD always send at least one deletion request whenever possible, to reduce the amount of stale state that accumulates on NAT gateways.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ポートマッピングを削除する場合、クライアントは、クライアントがあきらめる前にフル9回をしようとしないことを選択することができることを除いて、それぞれの連続する区間に倍増し、同じ初期250ミリ秒のタイムアウトを使用しています。マッピングの削除要求がある意味顧問であるためです。彼らは、効率のために有用であるが、正確には必要ありません。それは、クライアントソフトウェアがクラッシュするために常に可能である、または失敗する電源用、またはそれはそのマッピングの削除要求（複数可）を送信するための機会を得る前に、クライアントデバイスは、ネットワークから物理的に抜かであるためには、そのNATゲートウェイはすでに対処する必要がありますこのケース付き。このため、クライアントはそのポートマッピング（複数可）の削除をあきらめる前に2回だけ再試行することが許容できるかもしれませんが、可能な限り、クライアントは常に、少なくとも一つの削除要求を送るべきで、古い状態の量を減らすためにそれは、NATゲートウェイで蓄積します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A client need not continue trying to delete a port mapping after the time when that mapping would naturally have expired anyway.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントは、そのマッピングが自然とにかく期限が切れていた時間の後にポートマッピングを削除しようとし続ける必要はありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.2. Determining the External Address
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.2。外部アドレスの決定
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To determine the external address, the client behind the NAT sends the following UDP payload to port 5351 of the configured gateway address:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
外部アドレスを判別するには、NATの背後にあるクライアントが構成されたゲートウェイアドレスのポート5351に次のUDPペイロードを送信します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Vers = 0      | OP = 0        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A compatible NAT gateway MUST generate a response with the following format:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
互換性のNATゲートウェイは、次の形式で応答を生成しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Vers = 0      | OP = 128 + 0  | Result Code (net byte order)  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Seconds Since Start of Epoch (in network byte order)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | External IPv4 Address (a.b.c.d)                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This response indicates that the NAT gateway implements this version of the protocol, and returns the external IPv4 address of the NAT gateway. If the result code is non-zero, the value of the External IPv4 Address field is undefined (MUST be set to zero on transmission, and MUST be ignored on reception).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この応答は、NATゲートウェイは、プロトコルのこのバージョンを実装し、NATゲートウェイの外部IPv4アドレスを返すことを示しています。結果コードが非ゼロである場合、外部IPv4アドレスフィールドの値は、（送信にゼロに設定しなければならなくて、受信時には無視されなければならない）、未定義です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT gateway MUST fill in the Seconds Since Start of Epoch field with the time elapsed since its port mapping table was initialized on startup, or reset for any other reason (see Section 3.6, &#34;Seconds Since Start of Epoch&#34;).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイは、そのポートマッピングテーブルからの経過時間でエポックフィールドのスタート以来秒で入力する必要があります起動時に初期化され、あるいはその他の理由（3.6項「エポック開始からの秒」を参照）のためにリセットされました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Upon receiving a response packet, the client MUST check the source IP address, and silently discard the packet if the address is not the address of the gateway to which the request was sent.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
応答パケットを受信すると、クライアントは、送信元IPアドレスをチェックし、そして静かにアドレス要求が送信されたゲートウェイのアドレスでない場合はパケットを廃棄しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.2.1. Announcing Address Changes
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.2.1。アドレス変更を発表
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Upon boot, acquisition of an external IPv4 address, subsequent change of the external IPv4 address, reboot, or any other event that may indicate possible loss or change of NAT mapping state, the NAT gateway MUST send a gratuitous response to the link-local multicast address 224.0.0.1, port 5350, with the packet format above, to notify clients of the external IPv4 address and Seconds Since Start of Epoch.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
起動時に、外部のIPv4アドレスの取得は、外部のIPv4アドレス、リブート、または可能な損失やNATマッピングの状態の変化を示すことができる任意の他のイベントの後続の変更は、NATゲートウェイは、リンクローカルマルチキャストに無償応答を送らなければなりません上記パケットフォーマットとアドレス224.0.0.1、ポート5350は、エポックの開始から外部IPv4アドレスのクライアントおよび秒を通知します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To accommodate packet loss, the NAT gateway SHOULD multicast 10 address notifications. The interval between the first two notifications SHOULD be 250 ms, and the interval between each subsequent notification SHOULD double. The Seconds Since Start of Epoch field in each transmission MUST be updated appropriately to reflect the passage of time, so as not to trigger unnecessary additional mapping renewals (see Section 3.7, &#34;Recreating Mappings on NAT Gateway Reboot&#34;).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パケット損失に対応するために、NATゲートウェイは10のアドレスの通知をマルチキャストすべきです。最初の2つの通知間隔は250ミリ秒であるべきであり、その後の各通知間隔が倍増すべきです。不要な追加のマッピングの更新をトリガしないように各伝送におけるエポックフィールドの開始から秒（セクション3.7、「NATゲートウェイ再起動に再作成マッピング」を参照）、時間の経過を反映するように適切に更新されなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Upon receiving a gratuitous address announcement packet, the client MUST check the source IP address, and silently discard the packet if the address is not the address of the client&#39;s current configured gateway. This is to guard against inadvertent misconfigurations where there may be more than one NAT gateway active on the network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
無償アドレス告知パケットを受信すると、クライアントは、送信元IPアドレスをチェックして、黙っアドレスは、クライアントの現在の構成されたゲートウェイのアドレスでない場合は、パケットを捨てなければなりません。これは、ネットワーク上でアクティブな複数のNATゲートウェイが存在し得る偶発的な設定ミスを防ぐことです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the source IP address is correct, then the Seconds Since Start of Epoch field is checked as described in Section 3.6, and if the value is outside the expected plausible range, indicating that a NAT gateway state loss has occurred, then the NAT-PMP client promptly recreates all its active port mapping leases, as described in Section 3.7, &#34;Recreating Mappings on NAT Gateway Reboot&#34;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
送信元IPアドレスが正しい場合、セクション3.6で説明したように、次に秒エポックフィールドの開始が確認されているので、その値がNATゲートウェイの状態の損失が発生したことを示す、予想される妥当範囲外である場合、NAT-PMPクライアントは、速やかに「NATゲートウェイの再起動時に再作成マッピング」を、3.7節で説明したように、そのすべてのアクティブポートマッピングリースを再作成します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
IMPLEMENTATION NOTE: Earlier implementations of NAT-PMP used UDP port 5351 as the destination both for client requests (address and port mapping) and for address announcements. NAT-PMP servers would listen on UDP 5351 for client requests, and NAT-PMP clients would listen on UDP 5351 for server announcements. However, implementers encountered difficulties when a single device is acting in both roles, for example, a home computer with Internet Sharing enabled. This computer is acting in the role of NAT-PMP server to its DHCP clients, yet, at the same time, it has to act in the role of NAT-PMP client in order to determine whether it is, itself, behind another NAT gateway. While in principle it might be possible on some operating systems for two processes to coordinate sharing of a single UDP port, on many platforms this is difficult or even impossible, so, for pragmatic engineering reasons, it is convenient to have clients listen on UDP 5350 and servers listen on UDP 5351.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
実装上の注意：NAT-PMPの初期の実装では、クライアントの要求（アドレスとポートマッピング）のため、アドレスの発表のために、両方の宛先としてUDPポート5351を使用していました。 NAT-PMPサーバは、クライアント要求をUDP 5351をリッスンだろう、とNAT-PMPクライアントは、サーバーのアナウンスのためにUDP 5351をリッスンします。しかし、単一のデバイスは、両方の役割で機能している場合、実装が困難に遭遇した、例えば、インターネット共有と自宅のコンピュータが使用可能に。このコンピュータは、そのDHCPクライアントにNAT-PMPサーバーの役割で行動している、まだ、同時に、それは別のNATゲートウェイの背後に、それがあるかどうかを判断するために、NAT-PMPクライアントの役割に自分自身を行動することがあります。原理的には、単一のUDPポートの共有を調整するために、2つのプロセスのためのいくつかのオペレーティングシステム上で可能かもしれませんが、多くのプラットフォーム上で、これは困難または不可能でさえあるので、実用的なエンジニアリング上の理由から、クライアントがUDP 5350をリッスンしておくと便利ですそして、サーバはUDP 5351に聞きます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
IMPLEMENTATION NOTE: A given host may have more than one independent NAT-PMP client running at the same time, and address announcements need to be available to all of them. Clients should therefore set the SO_REUSEPORT option or equivalent in order to allow other processes to also listen on port 5350. Additionally, implementers have encountered issues when one or more processes on the same device listen to port 5350 on *all* addresses. Clients should therefore bind specifically to 224.0.0.1:5350, not to 0.0.0.0:5350.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
実装上の注意：指定したホストは、複数の独立したNAT-PMPクライアントが同時に実行していること、およびアドレスの発表は、それらのすべてが利用できるようにする必要があります。クライアントは、したがって、同じデバイス上の1つのまたは複数のプロセスが*すべて*アドレスにポート5350を聞くときに、他のプロセスが、ポート5350.また、実装者が直面している問題について聞くことができるようにするために、SO_REUSEPORTオプションまたは同等のものを設定する必要があります。クライアントは、そのためではない0.0.0.0:5350に、224.0.0.1:5350に特異的に結合する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.3. Requesting a Mapping
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.3。マッピングを要求
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To create a mapping, the client sends a UDP packet to port 5351 of the gateway&#39;s internal IP address with the following format:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピングを作成するには、クライアントは、次の形式のゲートウェイの内部IPアドレスのポート5351にUDPパケットを送信します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Vers = 0      | OP = x        | Reserved                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Internal Port                 | Suggested External Port       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Requested Port Mapping Lifetime in Seconds                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Opcodes supported: 1 - Map UDP 2 - Map TCP
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
オペコードサポート：1  - 地図UDP 2  - 地図TCP
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Reserved field MUST be set to zero on transmission and MUST be ignored on reception.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Reservedフィールドは、送信にゼロに設定しなければならなくて、受信時に無視しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Ports and Lifetime are transmitted in the traditional network byte order (i.e., most significant byte first).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ポートおよび寿命は従来のネットワークバイト順（即ち、最上位バイトが最初）で送信されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Internal Port is set to the local port on which the client is listening.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
内部ポートは、クライアントが待機しているローカルポートに設定されています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the client would prefer to have a high-numbered &#34;anonymous&#34; external port assigned, then it should set the Suggested External Port to zero, which indicates to the gateway that it should allocate a high-numbered port of its choosing. If the client would prefer instead to have the mapped external port be the same as its local internal port if possible (e.g., a web server listening on port 80 that would ideally like to have external port 80), then it should set the Suggested External Port to the desired value. However, the gateway is not obliged to assign the port suggested, and may choose not to, either for policy reasons (e.g., port 80 is reserved and clients may not request it) or because that port has already been assigned to some other client. Because of this, some product developers have questioned the value of having the Suggested External Port field at all. The reason is for failure recovery. Most low-cost home NAT gateways do not record temporary port mappings in persistent storage, so if the gateway crashes or is rebooted, all the mappings are lost. A renewal packet is formatted identically to an initial mapping request packet, except that for renewals the client sets the Suggested External Port field to the port the gateway actually assigned, rather than the port the client originally wanted.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントが割り当てられた高い番号の「匿名」の外部ポートを持っていることを好む場合は、それはそれはその選択した高い番号のポートを割り当てる必要があることをゲートウェイに指示する、ゼロに推奨外部ポートを設定する必要があります。クライアントが可能な場合にマッピングされた外部ポートは、（理想的には、外部ポート80を持っていると思い、ポート80でリッスン例えば、Webサーバ）、ローカルの内部ポートと同じである持っている代わりに、希望した場合、それは推奨外付けを設定する必要があります所望の値にポート。しかし、ゲートウェイが提案ポートを割り当てるように義務付けていない、そして、いずれかのポリシー上の理由（例えば、ポート80が予約され、クライアントがそれを要求しないかもしれない）しないことを選んでもよいか、またはポートがすでにいくつかの他のクライアントに割り当てられているからです。このため、一部の製品開発者は、提案されたすべての外部ポートフィールドを持つことの価値を疑問視しています。その理由は、障害復旧のためです。最も低コストのホームNATゲートウェイは、永続ストレージに一時的なポートマッピングを記録していないので、ゲートウェイがクラッシュした場合または再起動され、すべてのマッピングが失われます。更新パケットは、クライアントではなく、クライアントが最初に望んでいたポートよりも、ゲートウェイが実際に割り当てられたポートに推奨外部ポート]フィールドを設定し、更新するためにことを除いて、最初のマッピング要求パケットと同一にフォーマットされます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a freshly rebooted NAT gateway receives a renewal packet from a client, it appears to the gateway just like an ordinary initial request for a port mapping, except that in this case the Suggested External Port is likely to be one that the NAT gateway *is* willing to allocate (it allocated it to this client right before the reboot, so it should presumably be willing to allocate it again). This improves the stability of external ports across NAT gateway restarts.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
たての再起動NATゲートウェイはクライアントから更新パケットを受信すると、それはこの場合には推奨外部ポートは、NATゲートウェイ*であることを1である可能性が高い除いて、それは、単にポートマッピングのための通常の最初の要求のようにゲートウェイに表示されます*（それは右、再起動する前に、このクライアントに割り当てられたので、おそらくそれを再度割り当てることをいとわないする必要があります）を割り当てることをいといません。これは、NATゲートウェイの再起動に接続された外部ポートの安定性を向上させることができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The RECOMMENDED Port Mapping Lifetime is 7200 seconds (two hours).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
推奨ポートマッピングの寿命は7200秒（2時間）です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
After sending the port mapping request, the client then waits for the NAT gateway to respond. If after 250 ms the client hasn&#39;t received a response from the gateway, the client SHOULD reissue its request as described above in Section 3.1, &#34;Requests and Responses&#34;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ポートマッピング要求を送信した後、クライアントは、応答するNATゲートウェイのを待ちます。 250ミリ秒後に、クライアントは、ゲートウェイからの応答を受信しなかった場合、クライアントは、セクション3.1、「リクエストとレスポンス」で上述したようにその要求を再発行すべきです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT gateway responds with the following packet format:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイは、次のパケットフォーマットで応答します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Vers = 0      | OP = 128 + x  | Result Code                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Seconds Since Start of Epoch                                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Internal Port                 | Mapped External Port          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Port Mapping Lifetime in Seconds                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The epoch time, ports, and lifetime are transmitted in the traditional network byte order (i.e., most significant byte first).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
エポック時間、ポート、および寿命は従来のネットワークバイト順（即ち、最上位バイトが最初）で送信されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The &#39;x&#39; in the OP field MUST match what the client requested. Some NAT gateways are incapable of creating a UDP port mapping without also creating a corresponding TCP port mapping, and vice versa, and these gateways MUST NOT implement NAT Port Mapping Protocol until this deficiency is fixed. A NAT gateway that implements this protocol MUST be able to create TCP-only and UDP-only port mappings. If a NAT gateway silently creates a pair of mappings for a client that only requested one mapping, then it may expose that client to receiving inbound UDP packets or inbound TCP connection requests that it did not ask for and does not want.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
OPフィールドの「x」は、クライアントが要求したものと一致しなければなりません。いくつかのNATゲートウェイは、対応するTCPポートのマッピングを作成せずにUDPポートマッピングを作成することができない、またはその逆、及びこの欠陥が修正されるまで、これらのゲートウェイは、NATポートマッピングプロトコルを実装してはなりません。このプロトコルを実装してNATゲートウェイは、TCP-のみとUDP専用ポートのマッピングを作成できなければなりません。 NATゲートウェイは静かに一つだけのマッピングを要求したクライアントのマッピングのペアを作成した場合、それは、インバウンドUDPパケットまたはそれがために要求していないと望んでいないインバウンドTCP接続要求を受信することをクライアントに公開することがあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
While a NAT gateway MUST NOT automatically create mappings for TCP when the client requests UDP, and vice versa, the NAT gateway MUST reserve the companion port so the same client can choose to map it in the future. For example, if a client requests to map TCP port 80, as long as the client maintains the lease for that TCP port mapping, another client with a different internal IP address MUST NOT be able to successfully acquire the mapping for UDP port 80.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントがUDP、およびその逆を要求したときにNATゲートウェイが自動的にTCPのマッピングを作成してはいけませんしながら、同じクライアントが、将来的にそれをマッピングするために選択することができますので、NATゲートウェイはコンパニオンポートを予約する必要があります。たとえば、クライアント要求場合限り、クライアントはそのTCPポートマッピングのリースを維持して、TCPポート80をマッピングするために、異なる内部IPアドレスを持つ別のクライアントが正常にUDPポート80のマッピングを取得できないようにする必要があり。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The client normally requests the external port matching the internal port. If that external port is not available, the NAT gateway MUST return an available external port if possible, or return an error code if no external ports are available.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントは通常、内部ポートに一致する外部ポートを要求します。その外部ポートが使用できない場合は、可能であれば、NATゲートウェイは、使用可能な外部ポートを返さなければならない、又は外部ポートが使用できない場合、エラーコードを返します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The source address of the packet MUST be used for the internal address in the mapping. This protocol is not intended to facilitate one device behind a NAT creating mappings for other devices. If there are legacy devices that require inbound mappings, permanent mappings can be created manually by the user through an administrative interface, just as they are today.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パケットの送信元アドレスは、マッピングにおける内部アドレスのために使用されなければなりません。このプロトコルは、他のデバイスのマッピングを作成するNATの背後にあるデバイスを容易にするためのものではありません。インバウンドのマッピングを必要とするレガシーデバイスがある場合は、恒久的なマッピングは、彼らは今日と同じように、管理インターフェースを介してユーザによって手動で作成することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If a mapping already exists for a given internal address and port (whether that mapping was created explicitly using NAT-PMP, implicitly as a result of an outgoing TCP SYN packet, or manually by a human administrator) and that client requests another mapping for the same internal port (possibly requesting a different external port), then the mapping request should succeed, returning the already-assigned external port. This is necessary to handle the case where a client requests a mapping with suggested external port X, and is granted a mapping with actual external port Y, but the acknowledgment packet gets lost. When the client retransmits its mapping request, it should get back the same positive acknowledgment as was sent (and lost) the first time.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピングは、すでに与えられた内部アドレスとポートのために存在する（そのマッピングは暗黙的に発信TCP SYNパケットの結果として、または手動で人間の管理者によって、NAT-PMPを使用して明示的に作成されたかどうか）と、そのクライアントは、のために別のマッピングを要求した場合（おそらく別の外部ポートを要求する）同じ内部ポートは、その後、マッピング要求は、すでに割り当てられた外部ポートを返し、成功しなければなりません。これは、クライアントが提案され、外部ポートXとのマッピングを要求した場合に対処する必要があり、実際の外部ポートYとのマッピングを付与されますが、確認応答パケットが失われます。クライアントは、そのマッピング要求を再送信すると、それは最初の時間を送った（そして失われた）されたのと同じ肯定応答が返されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT gateway MUST NOT accept mapping requests destined to the NAT gateway&#39;s external IP address or received on its external network interface. Only packets received on the internal interface(s) with a destination address matching the internal address(es) of the NAT gateway should be allowed.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイは、NATゲートウェイの外部IPアドレスを宛先またはその外部ネットワークインタフェースで受信したマッピング要求を受け入れてはいけません。のみNATゲートウェイの内部アドレスを一致する宛先アドレスと内部のインターフェース（複数可）上で受信されたパケットが許可されるべきです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT gateway MUST fill in the Seconds Since Start of Epoch field with the time elapsed since its port mapping table was initialized on startup or reset for any other reason (see Section 3.6, &#34;Seconds Since Start of Epoch&#34;).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイは、そのポートマッピングテーブルからの経過時間でエポックフィールドのスタート以来秒で入力する必要があります起動時に初期化されるか、またはその他の理由（3.6項「エポック開始からの秒」を参照）のためにリセットされました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Port Mapping Lifetime is an unsigned integer in seconds. The NAT gateway MAY reduce the lifetime from what the client requested. The NAT gateway SHOULD NOT offer a lease lifetime greater than that requested by the client.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ポートマッピングの有効期間は、秒単位の符号なし整数です。 NATゲートウェイは、クライアントが要求したものから、寿命を減らすことができます。 NATゲートウェイは、クライアントから要求されたものよりも大きいリース寿命を提供すべきではありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Upon receiving the response packet, the client MUST check the source IP address, and silently discard the packet if the address is not the address of the gateway to which the request was sent.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
応答パケットを受信すると、クライアントは、送信元IPアドレスをチェックし、そして静かにアドレス要求が送信されたゲートウェイのアドレスでない場合はパケットを廃棄しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The client SHOULD begin trying to renew the mapping halfway to expiry time, like DHCP. The renewal packet should look exactly the same as a request packet, except that the client SHOULD set the Suggested External Port to what the NAT gateway previously mapped, not what the client originally suggested. As described above, this enables the gateway to automatically recover its mapping state after a crash or reboot.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントがDHCPのように、時間を満了する途中のマッピングを更新しようとして開始する必要があります。更新パケットは、クライアントがNATゲートウェイは、以前にマッピングされたものに推奨外部ポートを設定すべきであることを除いて、要求パケットとまったく同じになります、クライアントはもともと示唆されていないものを。上述したように、これは自動的にクラッシュまたは再起動後にそのマッピング状態を回復するためにゲートウェイを可能にします。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.4. Destroying a Mapping
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.4。マッピングを破棄
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A mapping may be destroyed in a variety of ways. If a client fails to renew a mapping, then at the time its lifetime expires, the mapping MUST be automatically deleted. In the common case where the gateway device is a combined DHCP server and NAT gateway, when a client&#39;s DHCP address lease expires, the gateway device MAY automatically delete any mappings belonging to that client. Otherwise, a new client being assigned the same IP address could receive unexpected inbound UDP packets or inbound TCP connection requests that it did not ask for and does not want.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピングは、様々な方法で破壊されてもよいです。クライアントは、マッピングを更新するために失敗した場合は、その寿命が満了した時点で、マッピングは自動的に削除されなければなりません。クライアントのDHCPアドレスのリース期限が切れると、ゲートウェイ装置は、組み合わせたDHCPサーバとNATゲートウェイである一般的なケースでは、ゲートウェイ装置が自動的にそのクライアントに属するすべてのマッピングを削除することができます。そうでない場合は、新しいクライアントが同じIPアドレスが予期しないインバウンドUDPパケットやそれがために要求していないと望んでいないインバウンドTCP接続要求を受ける可能性が割り当てられています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A client MAY also send an explicit packet to request deletion of a mapping that is no longer needed. A client requests explicit deletion of a mapping by sending a message to the NAT gateway requesting the mapping, with the Requested Lifetime in Seconds set to zero. The Suggested External Port MUST be set to zero by the client on sending, and MUST be ignored by the gateway on reception.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
また、クライアントは、もはや必要とされているマッピングの削除を要求するために、明示的なパケットを送信することができます。クライアントはゼロに設定された秒で要求された寿命で、マッピングを要求するNATゲートウェイにメッセージを送信することにより、マッピングを明示的に削除を要求します。推奨外部ポートは、送信時にクライアントによってゼロに設定しなければならなくて、受信上のゲートウェイで無視しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a mapping is destroyed successfully as a result of the client explicitly requesting the deletion, the NAT gateway MUST send a response packet that is formatted as defined in Section 3.3, &#34;Requesting a Mapping&#34;. The response MUST contain a result code of 0, the internal port as indicated in the deletion request, an external port of 0, and a lifetime of 0. The NAT gateway MUST respond to a request to destroy a mapping that does not exist as if the request were successful. This is because of the case where the acknowledgment is lost, and the client retransmits its request to delete the mapping. In this case, the second request to delete the mapping MUST return the same response packet as the first request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピングが明示的に削除を要求しているクライアントの結果として成功した破壊された場合には、NATゲートウェイは、「マッピングの要求」、3.3節で定義されているようにフォーマットされた応答パケットを送らなければなりません。応答があるかのように存在していないマッピングを破壊するNATゲートウェイが要求に応答しなければならない0の結果コード、削除要求、0の外部ポートで示されるように、内部ポート、および0.1の寿命を含まなければなりませんリクエストが成功しました。これは、確認応答が失われた場合のものであり、クライアントがマッピングを削除するには、その要求を再送信します。この場合には、マッピングを削除する第2の要求は、最初の要求と同じ応答パケットを返さなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the deletion request was unsuccessful, the response MUST contain a non-zero result code and the requested mapping; the lifetime is undefined (MUST be set to zero on transmission, and MUST be ignored on reception). If the client attempts to delete a port mapping that was manually assigned by some kind of configuration tool, the NAT gateway MUST respond with a &#34;Not Authorized&#34; error, result code 2.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
削除要求が失敗した場合は、応答が非ゼロの結果コードと、要求のマッピングを含まなければなりません。寿命は不定（伝送にゼロに設定しなければならなくて、受信時には無視されなければならない）されています。クライアントが手動で設定ツールのいくつかの種類によって割り当てられたポートマッピングを削除しようとすると、NATゲートウェイは、「認証されていません」エラー、結果コード2で応じなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a mapping is destroyed as a result of its lifetime expiring or for any other reason, if the NAT gateway&#39;s internal state indicates that there are still active TCP connections traversing that now-defunct mapping, then the NAT gateway SHOULD send appropriately constructed TCP RST (reset) packets both to the local client and to the remote peer on the Internet to terminate that TCP connection.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイの内部状態は、その今はなきマッピングを横断するアクティブなTCP接続がまだあることを示す場合、マッピングは、失効その寿命の結果として、または他の理由のために破壊された場合、その後NATゲートウェイは（適切に構築されたTCP RSTを送信すべきですローカルクライアントへの）パケットの両方をリセットし、インターネット上のリモートピアにそのTCP接続を終了します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A client can request the explicit deletion of all its UDP or TCP mappings by sending the same deletion request to the NAT gateway with the external port, internal port, and lifetime set to zero. A client MAY choose to do this when it first acquires a new IP address in order to protect itself from port mappings that were performed by a previous owner of the IP address. After receiving such a deletion request, the gateway MUST delete all its UDP or TCP port mappings (depending on the opcode). The gateway responds to such a deletion request with a response as described above, with the internal port set to zero. If the gateway is unable to delete a port mapping, for example, because the mapping was manually configured by the administrator, the gateway MUST still delete as many port mappings as possible, but respond with a non-zero result code. The exact result code to return depends on the cause of the failure. If the gateway is able to successfully delete all port mappings as requested, it MUST respond with a result code of zero.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントはゼロに設定された外部ポート、内部ポート、および寿命でNATゲートウェイに同じ削除要求を送信することにより、そのすべてのUDPまたはTCPのマッピングを明示的に削除を要求することができます。それが最初のIPアドレスの以前の所有者によって行われたポートマッピングから自身を保護するために、新しいIPアドレスを取得する場合、クライアントはこれを行うことを選択するかもしれません。そのような削除要求を受信した後、ゲートウェイは、そのすべてのUDPまたはTCPポートのマッピング（オペコードに依存する）を削除する必要があります。ゼロに設定された内部ポートと、上記のようにゲートウェイが応答を有するそのような削除要求に応答します。マッピングは手動で管理者によって設定されたため、ゲートウェイは、例えば、ポートマッピングを削除することができない場合、ゲートウェイは依然として可能な限り多くのポートマッピングを削除するが、非ゼロの結果コードで応答しなければなりません。返すために正確な結果コードが障害の原因によって異なります。ゲートウェイが要求されるように成功し、すべてのポートマッピングを削除することができた場合、それはゼロの結果コードで応じなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.5. Result Codes
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.5。結果コード
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Currently defined result codes:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
現在、定義された結果コード：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
0 - Success 1 - Unsupported Version 2 - Not Authorized/Refused (e.g., box supports mapping, but user has turned feature off) 3 - Network Failure (e.g., NAT box itself has not obtained a DHCP lease) 4 - Out of resources (NAT box cannot create any more mappings at this time) 5 - Unsupported opcode
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
0  - 成功1  - サポートされていないバージョン2  - 許可されない/拒否（例えば、ボックスのマッピングをサポートしていますが、ユーザーが機能をオフにしている）3  - ネットワーク障害4（例えば、NATボックス自体がDHCPリースを取得していない） - リソースの不足（ NATボックス現時点ではこれ以上のマッピングを作成することはできません）5  - サポートされていないオペコード
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the version in the request is not zero, then the NAT-PMP server MUST return the following &#34;Unsupported Version&#34; error response to the client:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
リクエスト内のバージョンがゼロでない場合は、NAT-PMPサーバは、クライアントに次の「サポートされていないバージョン」のエラー応答を返さなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Vers = 0      | OP = 0        | Result Code = 1               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Seconds Since Start of Epoch (in network byte order)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the opcode in the request is 128 or greater, then this is not a request; it&#39;s a response, and the NAT-PMP server MUST silently ignore it. Otherwise, if the opcode in the request is less than 128, but is not a supported opcode (currently 0, 1, or 2), then the entire request MUST be returned to the sender, with the top bit of the opcode set (to indicate that this is a response) and the result code set to 5 (Unsupported opcode).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
要求にオペコードが128以上である場合、これは要求ではありません。それは、応答だし、NAT-PMPサーバは黙ってそれを無視しなければなりません。そうでなければ、要求にオペコードが128未満であるが、（現在は0、1、又は2）、次いで、全体要求する（オペコードセットの先頭ビットと、送信者に返さなければならないサポートオペコードでない場合これが応答であることを示す）と5に設定結果コード（オペコードサポートされていません）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
For version 0 and a supported opcode (0, 1, or 2), if the operation fails for some reason (Not Authorized, Network Failure, or Out of resources), then a valid response MUST be sent to the client, with the top bit of the opcode set (to indicate that this is a response) and the result code set appropriately. Other fields in the response MUST be set appropriately. Specifically:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
バージョン0およびサポートされているオペコード（0、1、または2）操作が何らかの理由（権限がない、ネットワーク障害、またはリソース不足）で失敗した場合、その後、有効な応答がトップで、クライアントに送信されなければならないためにオペコードセットのビットは適宜設定結果コード（これは応答であることを示します）。応答の他のフィールドを適切に設定する必要があります。具体的に：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Seconds Since Start of Epoch MUST be set correctly
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
O秒エポックのスタートを正しく設定する必要がありますので、
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The External IPv4 Address should be set to the correct address, or to 0.0.0.0, as appropriate.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
O外部IPv4アドレスは、必要に応じて、正しいアドレスに、または0.0.0.0に設定する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The Internal Port MUST be set to the client&#39;s requested Internal Port. This is particularly important, because the client needs this information to identify which request suffered the failure.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
O内部ポートは、クライアントの要求の内部ポートに設定する必要があります。クライアントが障害を被った要求を識別するために、この情報を必要とするので、これは、特に重要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The Mapped External Port and Port Mapping Lifetime MUST be set appropriately -- i.e., zero if no successful port mapping was created.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Oマッピングされた外部ポートとポートマッピング寿命を適切に設定しなければならない - すなわち、ゼロ全く成功したポートマッピングは作成されなかった場合。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Should future NAT-PMP opcodes be defined, their error responses MUST similarly be specified to include sufficient information to identify which request suffered the failure. By design, NAT-PMP messages do not contain any transaction identifiers. All NAT-PMP messages are idempotent and self-describing; therefore, the specifications of future NAT-PMP messages need to include enough information for their responses to be self-describing.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
将来のNAT-PMPのオペコードを定義する必要があり、そのエラー応答は、同様の障害を被った要求を識別するのに十分な情報を含めるように指定しなければなりません。設計により、NAT-PMPメッセージは、任意のトランザクション識別子を含んでいません。すべてのNAT-PMPメッセージは冪等と自己記述されています。そのため、将来のNAT-PMPメッセージの仕様は、それらの応答は自己記述されるようにするには十分な情報を含める必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Clients MUST be able to properly handle result codes not defined in this document. Undefined results codes MUST be treated as fatal errors of the request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントは、適切に、この文書で定義されていない結果コードを処理できなければなりません。未定義の結果コードは、要求の致命的なエラーとして処理されなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.6. Seconds Since Start of Epoch
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.6。エポック開始からの秒
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Every packet sent by the NAT gateway includes a Seconds Since Start of Epoch (SSSoE) field. If the NAT gateway resets or loses the state of its port mapping table, due to reboot, power failure, or any other reason, it MUST reset its epoch time and begin counting SSSoE from zero again. Whenever a client receives any packet from the NAT gateway, either unsolicited or in response to a client request, the client computes its own conservative estimate of the expected SSSoE value by taking the SSSoE value in the last packet it received from the gateway and adding 7/8 (87.5%) of the time elapsed according to the client&#39;s local clock since that packet was received. If the SSSoE in the newly received packet is less than the client&#39;s conservative estimate by more than 2 seconds, then the client concludes that the NAT gateway has undergone a reboot or other loss of port mapping state, and the client MUST immediately renew all its active port mapping leases as described in Section 3.7, &#34;Recreating Mappings on NAT Gateway Reboot&#34;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイによって送信されたすべてのパケットは、エポック（SSSoE）フィールドの開始からの秒数を含んでいます。 NATゲートウェイをリセットまたは再起動することにより、そのポートマッピングテーブルの状態、電源障害、または任意の他の理由を失った場合、そのエポック時間をリセットし、再びゼロからSSSoEをカウント開始しなければなりません。クライアントが迷惑またはクライアント要求に応答してのいずれかで、NATゲートウェイから任意のパケットを受信するたびに、クライアントは、ゲートウェイから受信した最後のパケットでSSSoE値を取ると7を追加することによって、期待SSSoE値の独自の控えめな推定値を計算しますそのパケットを受信して​​から、クライアントのローカルクロックに従って経過時間/ 8（87.5％）。新たに受信したパケット内のSSSoEが2秒以上により、クライアントの保守的な見積もりよりも小さい場合、クライアントは、NATゲートウェイが再起動やポートマッピング状態の他の損失を受けたと判断し、クライアントはすぐにそのすべてのアクティブを更新する必要があります3.7節、「NATゲートウェイをリブートの再作成マッピング」で説明したように、ポートマッピングが賃借しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.7. Recreating Mappings on NAT Gateway Reboot
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.7。 NATゲートウェイの再起動時にマッピングを再作成
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT gateway MAY store mappings in persistent storage so that, when it is powered off or rebooted, it remembers the port mapping state of the network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
それが電源オフまたはリブートされたとき、それはネットワークのポートマッピングの状態を記憶し、そのようNATゲートウェイは、永続ストレージ内のマッピングを格納することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
However, maintaining this state is not essential for correct operation. When the NAT gateway powers on or clears its port mapping state as the result of a configuration change, it MUST reset the epoch time and re-announce its IPv4 address as described in Section 3.2.1, &#34;Announcing Address Changes&#34;. Reception of this packet where time has apparently gone backwards serves as a hint to clients on the network that they SHOULD immediately send renewal packets (to immediately recreate their mappings) instead of waiting until the originally scheduled time for those renewals. Clients who miss receiving those gateway announcement packets for any reason will still renew their mappings at the originally scheduled time and cause their mappings to be recreated; it will just take a little longer for these clients.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
しかし、この状態を維持することが正しい操作のために必須ではありません。 NATゲートウェイの電源がオンまたは設定変更の結果として、そのポートマッピングの状態をクリアすると、それはエポックタイムをリセットしなければなりませんし、「アドレス変更のお知らせ」、3.2.1項で説明したように、そのIPv4アドレスを再発表します。時間は明らかに逆方向に行ってしまったこのパケットの受信は、彼らはすぐに代わり、これらの更新のために当初予定時刻まで待機する（すぐにそのマッピングを再作成する）更新パケットを送信すべきであるネットワーク上のクライアントへのヒントとして機能します。何らかの理由でこれらのゲートウェイアナウンスパケットを受信欠場するクライアントは、まだ当初予定時刻にそのマッピングを更新し、そのマッピングを再作成されます。それだけで、これらのクライアントのために少し時間がかかります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A mapping renewal packet is formatted identically to an original mapping request; from the point of view of the client, it is a renewal of an existing mapping, but from the point of view of the freshly rebooted NAT gateway, it appears as a new mapping request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マッピング更新パケットは、元のマッピング要求と同一フォーマットさ。クライアントの観点から、それは既存のマッピングの更新ですが、新鮮に再起動NATゲートウェイの観点から、それは新しいマッピング要求として表示されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This self-healing property of the protocol is very important.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
プロトコルのこの自己修復性は非常に重要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The remarkable reliability of the Internet as a whole derives in large part from the fact that important state is held in the endpoints, not in the network itself [ETEAISD]. Power-cycling an Ethernet switch results only in a brief interruption in the flow of packets; established TCP connections through that switch are not broken, merely delayed for a few seconds. Indeed, a failing Ethernet switch can even be replaced with a new one, and as long as the cables are transferred over reasonably quickly, after the upgrade all the TCP connections that were previously going through the old switch will be unbroken and now going through the new one. The same is true of IP routers, wireless base stations, etc. The one exception is NAT gateways. Because the port mapping state is required for the NAT gateway to know where to forward inbound packets, loss of that state breaks connectivity through the NAT gateway. By allowing clients to detect when this loss of NAT gateway state has occurred, and recreate it on demand, we turn hard state in the network into soft state, and allow it to be recovered automatically when needed.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
全体としてインターネットの顕著な信頼性は重要な状態ではないネットワーク自体【ETEAISD]で、エンドポイントに保持されるという事実から、大部分が導出します。パワー・サイクリングのみパケットのフローにおける短い中断にイーサネットスイッチ結果を、そのスイッチを介して確立されたTCP接続は、単に数秒間遅らせ、破壊されません。確かに、失敗したイーサネットスイッチであっても新しいものと交換することができ、そして限り、ケーブルはアップグレード後に、合理的に迅速上で転送される以前の古いスイッチを通過されたすべてのTCP接続が途切れないだろうと今を通過します新しいもの。同じことは、IPルータ、無線基地局、など一つの例外は、NATゲートウェイでの事実です。ポートマッピングの状態がどこインバウンドパケットを転送するために知ってNATゲートウェイのために必要であるため、その状態の損失は、NATゲートウェイを介して接続を切断します。クライアントがNATゲートウェイの状態のこの損失が発生したときを検出し、必要に応じて、それを再作成することを可能にすることによって、我々は柔らかい状態にし、ネットワーク内のハード状態をオンにし、必要なときに、それが自動的に回復することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Without this automatic recreation of soft state in the NAT gateway, reliable long-term networking would not be achieved. As mentioned above, the reliability of the Internet does not come from trying to build a perfect network in which errors never happen, but from accepting that in any sufficiently large system there will always be some component somewhere that&#39;s failing, and designing mechanisms that can handle those failures and recover. To illustrate this point with an example, consider the following scenario: Imagine a network security camera that has a web interface and accepts incoming connections from web browser clients. Imagine this network security camera uses NAT-PMP or a similar protocol to set up an inbound port mapping in the NAT gateway so that it can receive incoming connections from clients on the other side of the NAT gateway. Now, this camera may well operate for weeks, months, or even years. During that time, it&#39;s possible that the NAT gateway could experience a power failure or be rebooted. The user could upgrade the NAT gateway&#39;s firmware, or even replace the entire NAT gateway device with a newer model. The general point is that if the camera operates for a long enough period of time, some kind of disruption to the NAT gateway becomes inevitable. The question is not whether the NAT gateway will lose its port mappings, but when, and how often. If the network camera and devices like it on the network can detect when the NAT gateway has lost its port mappings, and recreate them automatically, then these disruptions are self-correcting and largely invisible to the end user. If, on the other hand, the disruptions are not self-correcting, and after a NAT gateway reboot the user has to manually reset or reboot all the other devices on the network too, then these disruptions are *very* visible to the end user. This aspect of the design is part of what makes the difference between a protocol that keeps on working indefinitely over a time scale of months or years, and a protocol that works in brief testing, but in the real world is continually failing and requiring manual intervention to get it going again.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATゲートウェイにおけるソフトステートのこの自動レクリエーションがなければ、信頼性の高い長期的なネットワーキングは達成されないでしょう。前述したように、インターネットの信頼性は、エラーが起こることはありませんここで完璧なネットワークを構築しようとしているから来るが、任意の十分に大きなシステムでは常に失敗していますいくつかのコンポーネントどこかに存在することを受け入れて、そして扱うことができる仕組みを設計からしません。これらの障害と回復します。例を挙げてこの点を説明するために、次のシナリオを検討してください：Webインタフェースを持ち、Webブラウザクライアントからの着信接続を受け付けるネットワークセキュリティカメラを想像してみてください。防犯カメラは、それがNATゲートウェイの反対側にクライアントからの着信接続を受信できるようにNATゲートウェイにインバウンドポートマッピングを設定するNAT-PMPまたは類似のプロトコルを使用してこのネットワークを想像します。さて、このカメラはよく、数週間、数ヶ月、あるいは数年もの間動作することができます。その間、それはNATゲートウェイに電源障害が発生したか、または再起動することが可能です。ユーザーは、NATゲートウェイのファームウェアをアップグレードする、あるいは新しいモデルと全体のNATゲートウェイデバイスを置き換えることができます。一般的な点は、カメラが時間の十分長い時間動作している場合、NATゲートウェイの中断のいくつかの種類が避けられないということです。質問は、NATゲートウェイは、そのポートマッピングを失いますが、いつ、どのくらいの頻度になるかどうかではありません。ネットワーク上のネットワークカメラおよびそれのようなデバイスがNATゲートウェイはそのポートマッピングを失ったときを検出し、自動的にそれらを再作成することができた場合は、これらの混乱は、自己修正、エンドユーザーへの大部分は見えません。一方、混乱が自己修正されず、NATゲートウェイの後にユーザが手動でリセットまたはすぎるネットワーク上の他のすべてのデバイスを再起動しなければ再起動した場合、これらの混乱は、エンドユーザーには見え*非常に*です。デザインのこの側面は、数ヶ月または数年の時間スケール、および簡単なテストで動作するプロトコルで無期限に作業を続けているプロトコルの違いを作るものの一部ですが、現実の世界では、継続的に失敗し、手動の介入を必要とされますそれが再び起こって取得します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a client renews its port mappings as the result of receiving a packet where the Seconds Since Start of Epoch (SSSoE) field indicates that a reboot or similar loss of state has occurred, the client MUST first delay by a random amount of time selected with uniform random distribution in the range 0 to 5 seconds, and then send its first port mapping request. After that request is acknowledged by the gateway, the client may then send its second request, and so on, as rapidly as the gateway allows. The requests SHOULD be issued serially, one at a time; the client SHOULD NOT issue multiple concurrent requests.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
クライアントは、エポックの開始（SSSoE）フィールドは、状態のリブートまたは同様の損失が発生したことを示して以来の秒は、クライアントが最初で選択された時間のランダムな量だけ遅延しなければならないパケットを受信した結果として、そのポートマッピングを更新する場合均一な範囲のランダム分布0〜5秒、及びその第1のポートマッピング要求を送信します。その要求は、ゲートウェイによって確認された後、クライアントは次にとして急速にゲートウェイが許す限り、ようにその第2の要求を送信し、そしてよいです。要求は、シリアルに一つずつ発行する必要があります。クライアントは、複数の同時要求を発行するべきではありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The discussion in this section focuses on recreating inbound port mappings after loss of NAT gateway state, because that is the more serious problem. Losing port mappings for outgoing connections destroys those currently active connections, but does not prevent clients from establishing new outgoing connections. In contrast, losing inbound port mappings not only destroys all existing inbound connections, but also prevents the reception of any new inbound connections until the port mapping is recreated. Accordingly, we consider recovery of inbound port mappings more important. However, clients that want outgoing connections to survive a NAT gateway reboot can also achieve that using NAT-PMP, in the common case of a residential NAT gateway with a single, relatively stable, external IP address. After initiating an outbound TCP connection (which will cause the NAT gateway to establish an implicit port mapping), the client should send the NAT gateway a port mapping request for the source port of its TCP connection, which will cause the NAT gateway to send a response giving the external port it allocated for that mapping. The client can then store this information, and use it later to recreate the mapping if it determines that the NAT gateway has lost its mapping state.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
それは、より深刻な問題であるため、この節での議論は、NATゲートウェイの状態が失われた後、インバウンドポートマッピングを再作成に焦点を当てています。発信接続のためのポートマッピングを失うことは、それらの現在アクティブな接続を破壊するが、新しい発信接続を確立するクライアントを防ぐことはできません。これとは対照的に、インバウンドポートマッピングを失うことは、既存のすべての着信接続を破壊するだけでなく、ポートマッピングが再作成されるまで、すべての新しい着信接続の受信を防止するだけでなく。したがって、我々は、インバウンドポートマッピングの回復がより重要と考えます。しかし、外部への接続がNATゲートウェイの再起動を生き残るためにしたいクライアントは、単一の、比較的安定し、外部IPアドレスを持つ住宅のNATゲートウェイの一般的な場合には、NAT-PMPを使用していることを達成することができます。 （NATゲートウェイは、暗黙的なポートマッピングを確立するようになります）アウトバウンドTCP接続を開始した後、クライアントがNATゲートウェイがお送りしますこれは、NATゲートウェイにそのTCPコネクションの送信元ポートのポートマッピング要求を送信する必要がありますそれはそのマッピングに割り当てられた外部ポートを与えて応答。クライアントは、この情報を保存し、それがNATゲートウェイはそのマッピング状態を失ったと判断した場合、マッピングを再作成し、後でそれを使用することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.8. NAT Gateways with NAT Function Disabled
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.8。 NAT機能とNATゲートウェイは無効
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note that only devices that are *currently* acting in the role of NAT gateway should participate in NAT-PMP protocol exchanges with clients. A network device that is capable of NAT (and NAT-PMP) but is currently configured not to perform that function (e.g., it is acting as a traditional IP router, forwarding packets without modifying them) MUST NOT respond to NAT-PMP requests from clients nor send spontaneous NAT-PMP address-change announcements.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
*現在* NATゲートウェイの役割で行動しているだけのデバイスがクライアントとNAT-PMPプロトコル交換に参加すべきであることに注意してください。 （例えば、それはそれらを変更せずにパケットを転送する、従来のIPルータとして動作している）、NAT（およびNAT-PMP）が可能であるが、現在はその機能を実行しないように構成されたネットワークデバイスからNAT-PMPの要求に応じてはいけませんクライアントも自発的なNAT-PMPアドレス変更のアナウンスを送信します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In particular, a network device not currently acting in the role of NAT gateway should not even respond to NAT-PMP requests by returning an error code such as 2, &#34;Not Authorized/Refused&#34;, since to do so is misleading to clients -- it suggests that NAT port mapping is necessary on this network for the client to successfully receive inbound connections, but is not available because the administrator has chosen to disable that functionality.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
具体的には、ネットワークデバイスは、現在、そのクライアントに誤解されてやっているので、「/認定拒否しない」にも、このような2通りのエラーコードを返すことにより、NAT-PMP要求に応じるべきではないNATゲートウェイの役割で行動していません - それは、NATポートマッピングが正常に着信接続を受信するためのクライアントのために、このネットワーク上で必要であることを示唆しているが、管理者がその機能を無効にすることを選択したため、利用できません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Clients should also be careful to avoid making unfounded assumptions, such as the assumption that if the client has an IPv4 address in one of the private IPv4 address ranges [RFC1918], then that means NAT necessarily must be in use. Net 10/8 has enough addresses to build a private network with millions of hosts and thousands of interconnected subnets, all without any use of NAT. Many organizations have built such private networks that benefit from using standard TCP/IP technology, but by choice do not connect to the public Internet. The purpose of NAT-PMP is to mitigate some of the damage caused by NAT. It would be an ironic and unwanted side effect of this protocol if it were to lead well-meaning but misguided developers to create products that refuse to work on a private network *unless* they can find a NAT gateway to talk to. Consequently, a client finding that NAT-PMP is not available on its network should not give up, but should proceed on the assumption that the network may be a traditional routed IP network, with no address translation being used. This assumption may not always be true, but it is better than the alternative of falsely assuming the worst and not even trying to use normal (non-NAT) IP networking.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
また、クライアントは、クライアントがプライベートIPv4アドレス範囲[RFC1918]のいずれかで、IPv4アドレスを持っている場合、それはNATが必ずしも使用でなければならないことを意味していることを前提として、根拠のない仮定を、することを避けるように注意する必要があります。ネット10/8は、すべてのNATのいずれかを使用せず、相互接続されたサブネットのホストと数千人の何百万人とプライベートネットワークを構築するための十分な数のアドレスを持っています。多くの組織では、標準のTCP / IP技術を使用して恩恵を受け、このようなプライベートネットワークを構築していますが、選択によって公共のインターネットに接続しないでください。 NAT-PMPの目的は、NATによる被害の一部を軽減することです。それは、プライベートネットワーク上で動作することを拒否した製品を作成するために、よく意味が、見当違いの開発をリードしていた場合、彼らは話をするNATゲートウェイを見つけることができます*ない限り、それは*このプロトコルの皮肉と不要な副作用だろう。そのため、NAT-PMPは、そのネットワーク上で利用できないことを発見クライアントがあきらめるべきではありませんが、ネットワークが使用されていないアドレス変換で、伝統的なルーティングされたIPネットワークであってもよいことを前提に進めるべき。この仮定は常に真ではないかもしれないが、それは誤って最悪の事態を想定し、さらには、通常の（非NAT）IPネットワークを使用しようとしていないの代替よりも優れています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If a network device not currently acting in the role of NAT gateway receives UDP packets addressed to port 5351, it SHOULD respond immediately with an &#34;ICMP Port Unreachable&#34; message to tell the client that it needn&#39;t continue with timeouts and retransmissions, and it should assume that NAT-PMP is not available and not needed on this network. Typically, this behavior can be achieved merely by not having an open socket listening on UDP port 5351.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
現在、NATゲートウェイの役割で行動していないネットワークデバイスは、UDPパケットがポート5351宛受信した場合、それはタイムアウトと再送信を続行する必要はないことをクライアントに伝えるために、「ICMPポート到達不能」メッセージで即座に対応し、それべきですNAT-PMPが利用可能にし、このネットワーク上で必要ではないではないことを前提とすべきです。通常、この動作は、UDPポート5351でリッスン開いたソケットを持っていないだけで達成することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.9. All Mappings Are Bidirectional
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.9。すべてのマッピングは双方向であります
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
All NAT mappings, whether created implicitly by an outbound packet, created explicitly using NAT-PMP, or configured statically, are bidirectional. This means that when an outbound packet from a particular internal address and port is translated to an external address and port, replies addressed to that external address and port need to be translated back to the corresponding internal address and port.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
すべてのNATマッピングが、アウトバウンドパケットによって暗黙的に作成されたかどうかを、明示的にNAT-PMPを使用して作成した、または静的に設定され、双方向です。これは、特定の内部アドレスおよびポートからの発信パケットが外部アドレス・ポートに変換される場合、応答がその外部アドレス宛のポートが対応する内部アドレスとポートに戻って翻訳される必要があることを意味します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The converse is also true. When an inbound packet is received that is addressed to an external address and port that matches an existing mapping (implicit, explicit, or static), it is translated to the corresponding internal address and port and forwarded. Outbound replies from that internal address and port need to be translated to the correct external address and port so that they are correctly recognized by the remote peer.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
逆もまた真です。着信パケットが既存のマッピング（暗黙的、明示的、または静的）と一致する外部アドレス・ポートにアドレス指定された受信されたとき、それが対応する内部アドレスとポートに変換され、転送されます。その内部アドレスとポートからのアウトバウンドの応答は、それらが正しくリモートピアによって認識されるように、正しい外部アドレスとポートに変換する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In particular, if an outbound UDP reply that matches an existing explicit or static mapping is instead treated like a &#34;new&#34; outbound UDP packet, and a new dynamic mapping is created (with a different external address and port), then at the time that packet arrives at the remote peer it will not be recognized as a valid reply. For TCP this bug is quickly spotted because all TCP implementations will ignore replies with the wrong apparent source address and port. For UDP this bug can more easily go unnoticed because some UDP clients neglect to check the source address and port of replies; thus, they will appear to work some of the time with NAT gateways that put the wrong source address and port in outbound packets. All NAT gateways MUST ensure that mappings, however created, are bidirectional.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
具体的には、その時点で、次いで、既存の明示的または静的マッピングと一致するアウトバウンドUDP応答が代わりに「新しい」アウトバウンドUDPパケットのように扱われ、そして新たな動的マッピングが（異なる外部アドレスとポートで）作成された場合パケットは、それが有効な応答として認識されませんリモートピアに到着します。すべてのTCP実装が間違って見かけの送信元アドレスとポートで応答を無視するので、TCPの場合、このバグはすぐに発見されます。いくつかのUDPクライアントの怠慢は、応答の送信元アドレスとポートを確認するため、UDPの場合、このバグは、より簡単に見過ごされることができます。このように、彼らはアウトバウンドパケットに間違った送信元アドレスとポートを入れNATゲートウェイとの時間の一部を動作するように表示されます。すべてのNATゲートウェイは、しかし、作成したマッピングは、双方向であることを確認しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. UNSAF Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. UNSAFの考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The document &#34;IAB Considerations for UNilateral Self-Address Fixing (UNSAF) Across Network Address Translation (NAT)&#34; [RFC3424] covers a number of issues when working with NATs. It outlines some requirements for any document that attempts to work around problems associated with NATs. This section addresses those requirements.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATので作業するとき、ドキュメント[RFC3424]「ネットワークアドレス変換（NAT）アクロス一方的な自己アドレス固定（UNSAF）のためのIABの考慮事項は、」多くの問題をカバーしています。それは、NATのに関連する問題を回避しようとするすべてのドキュメントのいくつかの要件の概要を説明します。ここでは、これらの要件に対応しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.1. Scope
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.1。範囲
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This protocol addresses the needs of TCP and UDP transport peers that are separated from the public Internet by exactly one IPv4 NAT. Such peers must have access to some form of directory server for registering the public IPv4 address and port at which they can be reached.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このプロトコルは、正確に1つのIPv4 NATによって公共のインターネットから分離されているTCPとUDPトランスポート・ピアのニーズに対応しています。このようなピアは、彼らが到達可能なパブリックIPv4アドレスとポートを登録するためのディレクトリサーバのいくつかのフォームへのアクセス権を持っている必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.2. Transition Plan
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.2。移行計画
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Any client making use of this protocol SHOULD implement IPv6 support. If a client supports IPv6 and is running on a device with a global IPv6 address, that IPv6 address SHOULD be preferred to the IPv4 external address learned via this NAT mapping protocol. In case other clients do not have IPv6 connectivity, both the IPv4 and IPv6 addresses SHOULD be registered with whatever form of directory server is used. Preference SHOULD be given to IPv6 addresses when available. By implementing support for IPv6 and using this protocol for IPv4, vendors can ship products today that will work under both scenarios. As IPv6 becomes more widely deployed, clients of this protocol following these recommendations will transparently make use of IPv6.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このプロトコルを利用して任意のクライアントは、IPv6のサポートを実装する必要があります。クライアントは、IPv6をサポートし、IPv6アドレスは、このNATマッピングプロトコルを介して学習のIPv4外部アドレスに優先されるべきであること、グローバルIPv6アドレスを持つデバイス上で実行されている場合。場合、他のクライアントがIPv6接続を持っていない、IPv4とIPv6の両方のアドレスは、ディレクトリサーバの形式が使用されているものに登録する必要があります。利用可能な場合選好は、IPv6アドレスに与えられるべきです。 IPv6のサポートを実装し、IPv4のためにこのプロトコルを使用することにより、ベンダーは両方のシナリオの下で動作する今日の製品を出荷することができます。 IPv6がより広く展開になるにつれて、これらの推奨事項以下このプロトコルのクライアントは、透過的にIPv6の使用を行います。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3. Failure Cases
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3。失敗事例
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Aside from NATs that do not implement this protocol, there are a number of situations where this protocol may not work.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
別にこのプロトコルを実装していないNATのから、このプロトコルが動作しない状況がいくつかあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.1. NAT behind NAT
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.1。 NATの背後にあるNAT
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Some people&#39;s primary IPv4 address, assigned by their ISP, may itself be a NAT address. In addition, some people may have an external IPv4 address, but may then double NAT themselves, perhaps by choice or perhaps by accident. Although it might be possible in principle for one NAT gateway to recursively request a mapping from the next one, this document does not advocate that and does not try to prescribe how it would be done.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
そのISPによって割り当てられた一部の人々のプライマリIPv4アドレスは、自身がNATアドレスであってもよいです。また、一部の人々は、外部IPv4アドレスを持っているかもしれませんが、おそらく選択するか、おそらく事故により、NATそのものを2倍にすることができます。 1 NATゲートウェイは、次のいずれかからのマッピングを再帰的に要求することは原理的には可能かもしれませんが、本書はそれを提唱していないと、それがどのように行われるか規定しようとしません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
It would be a lot of work to implement nested NAT port mapping correctly, and there are a number of reasons why the end result might not be as useful as we might hope. Consider the case of an ISP that offers each of its customers only a single NAT address. This ISP could instead have chosen to provide each customer with a single public IPv4 address, or, if the ISP insists on running NAT, it could have chosen to allow each customer a reasonable number of addresses, enough for each customer device to have its own NAT address directly from the ISP. If, instead, this ISP chooses to allow each customer just one and only one NAT address, forcing said customer to run nested NAT in order to use more than one device, it seems unlikely that such an ISP would be so obliging as to provide a NAT service that supports NAT-PMP. Supposing that such an ISP did wish to offer its customers NAT service with NAT-PMP so as to give them the ability to receive inbound connections, this ISP could easily choose to allow each client to request a reasonable number of DHCP addresses from that gateway. Remember that Net 10/8 [RFC1918] allows for over 16 million addresses, so NAT addresses are not in any way in short supply. A single NAT gateway with 16 million available addresses is likely to run out of packet forwarding capacity before it runs out of internal addresses to hand out. In this way, the ISP could offer single-level NAT with NAT-PMP, obviating the need to support nested NAT-PMP. In addition, an ISP that is motivated to provide their customers with unhindered access to the Internet by allowing incoming as well as outgoing connections has better ways to offer this service. Such an ISP could offer its customers real public IPv4 addresses instead of NAT addresses, or could choose to offer its customers full IPv6 connectivity, where no mapping or translation is required at all.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
正しくネストされたNATポートマッピングを実装するために多くの作業となり、そして最終結果は我々が期待しかもしれないほど便利ではないかもしれない理由がいくつかあります。唯一のNATアドレス顧客のそれぞれを提供していますISPの場合を考えてみましょう。このISPではなく、単一のパブリックIPv4アドレスを使用して、各顧客に提供することを選択したかもしれない、または、ISPがNATを実行しているを主張する場合は、各顧客のデバイスは、独自のを持っているため、それが各顧客に十分なアドレスの合理的な数を、許可することを選択した可能性がNATは、ISPから直接取り組みます。代わりに、このISPは、複数のデバイスを使用するために、ネストされたNATを実行すると、顧客を強制的に、各顧客はただ、唯一のNATアドレス許可することを選択した場合、提供するようなISPはとても親切だろうとは考えにくいですNAT-PMPをサポートしてNATサービス。彼らにインバウンド接続を受信する機能を提供するようなISPがNAT-PMPと顧客NATサービスを提供したいということを仮定すると、このISPは簡単に各クライアントがそのゲートウェイからDHCPアドレスの合理的な数を要求できるようにすることを選択することができます。そのNATアドレスは供給不足でどのような方法ではありませんが、ネット10/8 [RFC1918]は1600万アドレスを可能にすることを忘れないでください。それは配るために内部アドレスを使い果たす前に1600万使用可能なアドレスを持つ単一のNATゲートウェイは、パケット転送能力の不足する可能性があります。この方法では、ISPは、ネストされたNAT-PMPをサポートする必要がなくなり、NAT-PMPと単一レベルのNATを提供することができます。また、入ってくるだけでなく、外部への接続を可能にすることにより、インターネットへの妨害のないアクセスを顧客に提供するために意欲的であるISPは、このサービスを提供するためのより良い方法があります。このようなISPは、実際のパブリックIPv4の代わりにNATアドレスのアドレスを顧客に提供することができ、またはその顧客のマッピングや変換はまったく必要とされない完全なIPv6接続を提供することを選択することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note: In the nine years since NAT-PMP was designed, the pool of available IPv4 addresses has been exhausted, and many ISPs now offer translated IPv4 addresses out of necessity. Such ISPs have indicated a willingness to offer PCP service to their customers.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPを設計したことから、可能なIPv4アドレスのプールが枯渇した9年間で、多くのISPは現在翻訳のIPv4が必要に迫られて対処します：注意してください。このようなISPは顧客にPCPサービスを提供する意欲を示しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.2. NATs with Multiple External IPv4 Addresses
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.2。複数の外部IPv4アドレスとNATの
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If a NAT maps internal addresses to multiple external addresses, then it SHOULD pick one of those external addresses as the one it will support for inbound connections, and for the purposes of this protocol it SHOULD act as if that address were its only address.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NATは、複数の外部アドレスへの内部アドレスをマッピングした場合、それはそれは、着信接続のためにサポートする一つとして、これらの外部アドレスのいずれかを選択する必要があり、そのアドレスはそのアドレスだけであれば、このプロトコルの目的のためには、として行動しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.3. NATs and Routed Private Networks
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.3。 NATのとルーティングプライベートネットワーク
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In some cases, a large network may be subnetted. Some sites may install a NAT gateway and subnet the private network. Such subnetting breaks this protocol because the router address is not necessarily the address of the device performing NAT.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
いくつかのケースでは、大規模なネットワークは、サブネットされてもよいです。一部のサイトではNATゲートウェイとサブネットプライベートネットワークをインストールすることができます。ルーターのアドレスは必ずしもNATを実行するデバイスのアドレスではありませんので、そのようなサブネットは、このプロトコルを破ります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Addressing this problem is not a high priority. Any site with the resources to set up such a configuration should have the resources to add manual mappings or attain a range of globally unique addresses.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この問題に対処する高い優先度ではありません。リソースを持つ任意のサイトには、手動マッピングを追加したり、グローバルに一意なアドレスの範囲を達成するためのリソースを持っている必要があり、このような構成を設定します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Not all NATs will support this protocol. In the case where a client is run behind a NAT that does not support this protocol, the software relying on the functionality of this protocol may be unusable.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
すべてではないNATは、このプロトコルをサポートします。クライアントは、このプロトコルをサポートしていないNATの背後で実行された場合には、このプロトコルの機能に依存するソフトウェアが使用できなくなることがあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.4. Communication between Hosts behind the Same NAT
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.4。同じNATの背後にあるホスト間の通信
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT gateways supporting NAT-PMP should also implement &#34;hairpin translation&#34;. Hairpin translation means supporting communication between two local clients being served by the same NAT gateway.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPをサポートするNATゲートウェイはまた、「ヘアピン翻訳」を実装する必要があります。ヘアピン翻訳は、同じNATゲートウェイによって提供されている2つのローカルクライアント間の通信をサポートすることを意味します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Suppose device A is listening on internal address and port 10.0.0.2:80 for incoming connections. Using NAT-PMP, device A has obtained a mapping to external address and port x.x.x.x:80, and has recorded this external address and port in a public directory of some kind. For example, it could have created a DNS SRV record containing this information, and recorded it, using DNS Dynamic Update [RFC3007], in a publicly accessible DNS server. Suppose then that device B, behind the same NAT gateway as device A, but unknowing or uncaring of this fact, retrieves device A&#39;s DNS SRV record and attempts to open a TCP connection to x.x.x.x:80. The outgoing packets addressed to this public Internet address will be sent to the NAT gateway for translation and forwarding. Having translated the source address and port number on the outgoing packet, the NAT gateway needs to be smart enough to recognize that the destination address is in fact itself, and then feed this packet back into its packet reception engine, to perform the destination port mapping lookup to translate and forward this packet to device A at address and port 10.0.0.2:80.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
仮定デバイスAは、着信接続のための内部アドレスとポート10.0.0.2:80でリッスンしています。 80を、そしていくつかの種類の公開ディレクトリに、この外部アドレスとポートを記録しました：NAT-PMPを使用して、デバイスAは、外部アドレスとポートx.x.x.xへのマッピングを取得しています。例えば、それは、この情報を含むDNS SRVレコードを作成している可能性があり、かつ公的にアクセス可能なDNSサーバーで、DNS動的更新[RFC3007]を使用して、それを記録しました。デバイスAと同じNATゲートウェイの背後に、その装置Bを想定するが、この事実を知らない、または思いやり、デバイスAのDNS SRVレコードを検索し、x.x.x.xへのTCP接続をオープンしようと試みる：80。発信パケットは、翻訳および転送のためのNATゲートウェイに送信されます。このパブリックインターネットアドレス宛。発信パケットに送信元アドレスとポート番号を翻訳したが、NATゲートウェイは、宛先アドレスが実際に自分自身であることを認識するのに十分スマートする必要があり、宛先ポートマッピングを実行するために、バックそのパケット受信エンジンにこのパケットを送りますルックアップは翻訳し、アドレスとポート10.0.0.2:80でデバイスAにこのパケットを転送します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.5. Non-UDP/TCP Transport Traffic
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3.5。非UDP / TCP交通交通
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Any communication over transport protocols other than TCP and UDP will not be served by this protocol. Examples are Generic Routing Encapsulation (GRE), Authentication Header (AH), and Encapsulating Security Payload (ESP).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
TCPやUDP以外のトランスポートプロトコルの上に任意の通信は、このプロトコルによって提供されることはありません。例としては、汎用ルーティングカプセル化（GRE）、認証ヘッダー（AH）、およびカプセル化セキュリティペイロード（ESP）です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.4. Long-Term Solution
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.4。長期的な解決策
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
As IPv6 is deployed, clients of this protocol supporting IPv6 will be able to bypass this protocol and the NAT when communicating with other IPv6 devices. In order to ensure this transition, any client implementing this protocol SHOULD also implement IPv6 and use this solution only when IPv6 is not available to both peers.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IPv6が展開されているように、IPv6をサポートこのプロトコルのクライアントは、他のIPv6デバイスと通信するとき、このプロトコルとNATをバイパスすることができるであろう。この移行を確実にするために、このプロトコルを実装する任意のクライアントはまた、IPv6を実装するとIPv6の両方のピアに利用可能ではない場合にのみ、このソリューションを使用すべきです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.5. Existing Deployed NATs
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.5。既存の展開のNAT
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Existing deployed NATs will not support this protocol. This protocol will only work with NATs that are upgraded to support it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
既存の展開NATは、このプロトコルをサポートしていません。このプロトコルは、それをサポートするようにアップグレードされているNATので動作します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5. Security Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5.セキュリティについての考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
As discussed in Section 3.2, &#34;Determining the External Address&#34;, only a client on the internal side of the NAT may create port mappings, and it may do so only on its own behalf. By using IP address spoofing, it&#39;s possible for one client to delete the port mappings of another client. It&#39;s also possible for one client to create port mappings on behalf of another client. In cases where this is a concern, it can be dealt with using IPsec [RFC4301].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
「外部アドレスの決定」、3.2節で述べたように、NATの内側にのみクライアントは、ポートマッピングを作成することができ、そしてそれは、独自に代わってこれだけ行うことができます。 1つのクライアントが別のクライアントのポートマッピングを削除するためにIPアドレスのスプーフィングを使用することにより、それが可能です。 1つのクライアントが別のクライアントの代わりにポートマッピングを作成することも可能です。これが懸念される場合には、それは、IPsec [RFC4301]を使用して対応することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The multicast announcements described in Section 3.2.1, &#34;Announcing Address Changes&#34;, could be spoofed, facilitating a denial-of-service attack. This makes NAT-PMP unsuitable for use on LANs with large numbers of hosts where one or more of the hosts may be untrustworthy.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マルチキャストアナウンスメントは、「アドレス変更のお知らせ」、3.2.1項で説明したサービス拒否攻撃を容易に詐称することができます。これは、ホストの1つ以上が信頼できないかもしれ多数のホストを持つLAN上で使用するためにNAT-PMPは適しません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Another concern is that rogue software running on a local host could create port mappings for unsuspecting hosts, thereby rendering them vulnerable to external attack. However, it&#39;s not clear how realistic this threat model is, since rogue software on a local host could attack such unsuspecting hosts directly itself, without resorting to such a convoluted indirect technique. This concern is also a little misguided because it is based on the assumption that a NAT gateway and a firewall are the same thing, which they are not.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
もう一つの懸念は、ローカルホスト上で実行されている不正なソフトウェアが、これにより外部からの攻撃に対して脆弱にそれらをレンダリング、疑うことを知らないホストに対してポートマッピングを作成することができることです。しかし、それはこの脅威モデルは、ローカルホスト上の不正なソフトウェアは、このような複雑な間接的な手法に頼ることなく、直接自身、そのような疑いを持たないホストを攻撃する可能性があるので、どのように現実的では明らかではありません。それは、NATゲートウェイとファイアウォールは、彼らがされていない、同じものであるという仮定に基づいているため、この懸念も少し見当違いです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Some people view the property of NATs blocking inbound connections as a security benefit that is undermined by this protocol. The authors of this document have a different point of view. In the days before NAT became prevalent, all hosts had unique public IP addresses, and had unhindered ability to communicate with any other host on the Internet (a configuration that is still surprisingly common). Using NAT breaks this unhindered connectivity, relegating hosts to second-class status, unable to receive inbound connections. This protocol goes some way to partially reverse that damage. The purpose of a NAT gateway should be to allow several hosts to share a single address, not to simultaneously impede those host&#39;s ability to communicate freely. Security is most properly provided by end-to-end cryptographic security, and/or by explicit firewall functionality, as appropriate. Blocking of certain connections should occur only as a result of explicit and intentional firewall policy, not as an accidental side effect of some other technology.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
一部の人々は、このプロトコルによって損なわれたセキュリティ上の利点として、着信接続をブロックするNATのプロパティを表示します。本書の著者は、別の視点を持っています。 NATは、流行になる前の日には、すべてのホストは、一意のパブリックIPアドレスを持っていたし、インターネット上の他のホスト（まだ驚くほど共通した構成）と通信するための妨害されていない能力を持っていました。 NATを使用すると、着信接続を受信できない二級の状態にホストを格下げ、この妨害されていない接続を切断します。このプロトコルは、部分的にそのダメージを逆転するためにいくつかの道を行きます。 NATゲートウェイの目的は、同時に自由に通信するために、それらのホストの能力を妨害しないように、複数のホストが単一のアドレスを共有できるようにするためであるべきです。セキュリティは、最も適切に適宜、エンドツーエンドの暗号化、セキュリティ、および/またはによる明示的なファイアウォール機能により提供されます。特定の接続のブロッキングは、明示的で意図的なファイアウォールポリシーの結果としてではなく、他のいくつかの技術の不慮の副作用としてのみ発生する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
However, since many users do have an expectation that their NAT gateways can function as a kind of firewall, any NAT gateway implementing this protocol SHOULD have an administrative mechanism to disable it, thereby restoring the pre-NAT-PMP behavior.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
多くのユーザーが自分のNATゲートウェイは、ファイアウォールの一種として機能することを期待を持っているので、このプロトコルを実装する任意のNATゲートウェイは、これにより、プリNAT-PMPの動作を復元、それを無効にするには、管理メカニズムを持っているべきです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6. IANA Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6. IANAの考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
UDP ports 5350 and 5351 have been assigned for use by NAT-PMP, and subsequently by its successor, Port Control Protocol [RFC6887].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UDPポート5350と5351は、その後継者、ポート制御プロトコル[RFC6887]で、その後NAT-PMPで使用するために割り当てられ、およびされています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
No further IANA services are required by this document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これ以上のIANAサービスは、この文書で必要ありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7. Acknowledgments
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.謝辞
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The concepts described in this document have been explored, developed, and implemented with help from Mark Baugher, Bob Bradley, Josh Graessley, Rory McGuire, Rob Newberry, Roger Pantos, John Saxton, Kiren Sekar, Jessica Vazquez, and James Woodyatt.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この文書に記載された概念は、探求開発、およびマーク・Baugher、ボブ・ブラッドリー、ジョシュGraessley、ロリー・マクガイア、ロブ・ニューベリー、ロジャーPantos、ジョン・サクストン、Kirenスカール、ジェシカ・バスケス、そしてジェームズWoodyattからの助けを借りて実施されています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Special credit goes to Mike Bell, the Apple Vice President who recognized the need for a clean, elegant, reliable Port Mapping Protocol, and made the decision early on that Apple&#39;s AirPort base stations would support NAT-PMP.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
特別クレジットは、クリーンでエレガントな、信頼性の高いポートマッピングプロトコルの必要性を認識し、早期にそのAppleのAirMacベースステーション上の意思決定は、NAT-PMPをサポートする作られたマイク・ベル、アップル副社長に行きます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8. Deployment History
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.展開の歴史
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In August 2004, NAT-PMP client software first became available to the public through Apple&#39;s Darwin Open Source code. In April 2005, NAT-PMP implementations began shipping to end users with the launch of Mac OS X 10.4 Tiger and Bonjour for Windows 1.0, and in June 2005 the protocol was first publicly documented in the original draft version of this document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2004年8月には、NAT-PMPクライアントソフトウェアは、最初にAppleのダーウィンのオープンソースコードを通じて公衆に利用できるようになりました。 2005年4月には、NAT-PMPの実装は、Windows 1.0は、Mac OS X 10.4 Tigerにし、ボンジュールの発売とエンドユーザーへの出荷を開始し、2005年6月にプロトコルが最初に公にこのドキュメントのオリジナルドラフト版に記載されていました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The NAT-PMP client in Mac OS X 10.4 Tiger and Bonjour for Windows exists as part of the mDNSResponder/mdnsd system service. When a client advertises a service using Wide Area Bonjour [RFC6763], and the machine is behind a NAT-PMP-capable NAT gateway, and the machine is so configured, the mDNSResponder system service automatically uses NAT-PMP to set up an inbound port mapping, and then records the external IPv4 address and port in the global DNS. Existing client software using the Bonjour programming APIs [Bonjour] got this new NAT traversal functionality automatically. The logic behind this decision was that if client software publishes its information into the global DNS via Wide Area Bonjour service advertising, then it&#39;s reasonable to infer an expectation that this information should actually be usable by the peers retrieving it. Generally speaking, recording a private IPv4 address like 10.0.0.2 in the public DNS is likely to be pointless because that address is not reachable from clients on the other side of the NAT gateway. In the case of a home user with a single computer directly connected to their Cable or DSL modem, with a single global IPv4 address and no NAT gateway (a common configuration at that time), publishing the machine&#39;s global IPv4 address into the global DNS is useful, because that IPv4 address is globally reachable. In contrast, a home user using a NAT gateway to share a single global IPv4 address between several computers loses this ability to receive inbound connections. This breaks many peer-to-peer collaborative applications, like the multi-user text editor SubEthaEdit [SEE]. For many users, moving from one computer with a global IPv4 address, to two computers using NAT to share a single global IPv4 address, loss of inbound reachability was an unwanted side effect of using NAT for address sharing. Automatically creating the necessary inbound port mappings helped remedy this unwanted side effect of NAT.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Windows用のMac OS X 10.4 Tigerにし、ボンジュールでNAT-PMPクライアントはmDNSResponder / mdnsdシステムサービスの一部として存在しています。クライアントがワイドエリアBonjourの[RFC6763]を使用してサービスをアドバタイズし、マシンがNAT-PMP対応NATゲートウェイの背後にある、機械がそのように構成され、mDNSResponderシステムサービスを自動的に受信ポートを設定するNAT-PMPを使用する場合マッピングした後、グローバルDNSに外部IPv4アドレスとポートを記録します。 BonjourのプログラミングAPIを使用してクライアントソフトウェアを既存の[Bonjourは]自動的にこの新しいNATトラバーサル機能を得ました。この決定の背後にある論理は、クライアントソフトウェアは、広域Bonjourサービスの広告を介してグローバルDNSにその情報を公開していた場合、それは、この情報が実際にそれを取得するピアが利用可能でなければならないという期待を推測するのが合理的だということでした。一般的に、そのアドレスがNATゲートウェイの反対側上のクライアントから到達可能ではないので、パブリックDNSに10.0.0.2のようなプライベートIPv4アドレスを記録することは無意味である可能性が高い、話します。直接単一のグローバルIPv4アドレスとNATなしゲートウェイ（当時一般的な構成）で、彼らのケーブルまたはDSLモデムに接続された単一のコンピュータとホームユーザーの場合は、グローバルDNSにマシンのグローバルIPv4アドレスを公開ですそのIPv4アドレスがグローバルに到達可能であるので、便利。これとは対照的に、複数のコンピュータ間で単一のグローバルIPv4アドレスを共有するためにNATゲートウェイを使用して、ホームユーザーは、着信接続を受信するには、この能力を失います。これは、マルチユーザーテキストエディタSubEthaEdit [SEE]のような多くのピアツーピアコラボレーションアプリケーションを、壊します。多くのユーザーのために、単一のグローバルIPv4アドレスを共有するためにNATを使用して2台のコンピュータに、グローバルIPv4アドレスを一つのコンピュータから移動し、インバウンド到達可能性の損失は、アドレス共有のためのNATを使用しての不要な副作用でした。自動的に必要なインバウンドポートマッピングは、NATのこの不要な副作用を改善する助け作成します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The server side of the NAT-PMP protocol is implemented in Apple&#39;s AirPort Extreme, AirPort Express, and Time Capsule wireless base stations, and in the Internet Sharing feature of Mac OS X 10.4 and later. Some third-party NAT vendors, such as Peplink, also offer NAT-PMP in their products.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPプロトコルのサーバ側は、AppleのAirMac Extremeに、AirMac Expressを、およびTime Capsuleの無線基地局に実装、およびMac OS X 10.4以降のインターネット共有機能でされています。このようPeplinkなどの一部のサードパーティのNATのベンダーも、自社製品でNAT-PMPを提供します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In Mac OS X 10.4 Tiger, the NAT-PMP client was invoked automatically as a side effect of clients requesting Wide Area Bonjour service registrations. Using NAT-PMP without an associated Wide Area Bonjour service registration required use of a third-party client library.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マックOS X 10.4 Tigerのでは、NAT-PMPクライアントは、広域Bonjourサービスの登録を要求するクライアントの副作用として自動的に呼び出されました。サードパーティのクライアントライブラリを使用する必要が関連する広域Bonjourサービスの登録なしNAT-PMPを使用しました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In October 2007, Mac OS X 10.5 Leopard added the &#34;DNSServiceNATPort-MappingCreate&#34; API, which made NAT-PMP client functionality directly available, so software could use it with other directory and rendezvous mechanisms in addition to Wide Area Bonjour DNS Updates.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2007年10月にはMac OS X 10.5 Leopardには、NAT-PMPクライアント機能を直接利用できるように「DNSServiceNATPort-MappingCreate」APIを追加したので、ソフトウェアは、ワイドエリアBonjourのDNSアップデートに加えて、他のディレクトリとのランデブーメカニズムでそれを使用することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In 2013, NAT-PMP was superseded by the IETF Standards Track Port Control Protocol [RFC6887]. PCP builds on NAT-PMP and uses a compatible packet format, and adds a number of significant enhancements, including IPv6 support, management of outbound mappings, management of firewall rules, full compatibility with large-scale NATs with a pool of external addresses, error lifetimes, and an extension mechanism to enable future enhancements.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2013年に、NAT-PMPは、IETF標準化過程ポート制御プロトコル[RFC6887]に取って代わられました。 PCPは、NAT-PMPの上に構築し、互換性のあるパケットフォーマットを使用し、IPv6のサポートを含む大幅な機能強化の数を、追加し、アウトバウンドのマッピングの管理、ファイアウォールルールの管理、外部アドレスのプールを備えた大規模NATのとの完全な互換性、エラー寿命、および将来の拡張を可能にするための拡張メカニズム。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9. Noteworthy Features of NAT Port Mapping Protocol and PCP
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
NATポートマッピングプロトコルとPCPの9注目の特長
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Some readers have asked how NAT-PMP and PCP compare to other similar solutions, particularly the UPnP Forum&#39;s Internet Gateway Device (IGD) Device Control Protocol [IGD].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
一部の読者は、NAT-PMPとPCPは、他の同様のソリューション、特にUPnPフォーラムのインターネットゲートウェイデバイス（IGD）デバイス制御プロトコル[IGD]と比較する方法を求めています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The answer is that although the Universal Plug and Play (UPnP) IGD protocol is often used as a way for client devices to create port mappings programmatically, it&#39;s not ideal for that task. Whereas NAT-PMP was explicitly designed to be used primarily by software entities managing their own port mappings, UPnP IGD is more tailored towards being used by humans configuring all the settings of their gateway using some GUI tool. This difference in emphasis leads to protocol differences. For example, while it is reasonable and sensible to require software entities to renew their mappings periodically to prove that they are still there (like a device renewing its DHCP address lease), it would be unreasonable to require the same thing of a human user. When a human user configures their gateway, they expect it to stay configured that way until they decide to change it. If they configure a port mapping, they expect it to stay configured until they decide to delete it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
答えは、ユニバーサルプラグアンドプレイ（UPnP）IGDプロトコルは、多くの場合、クライアントデバイスは、プログラム、ポートマッピングを作成するための方法として使用されているが、それはそのタスクのために理想的ではないということです。 NAT-PMPが明示的に自分自身のポートマッピングを管理するソフトウェアエンティティで主に使用されるように設計されていたのに対し、UPnPのIGDは、より多くのいくつかのGUIツールを使用してゲートウェイのすべての設定を人間によって使用されている方に調整されています。重点のこの違いは、プロトコルの違いにつながります。それは、彼らはまだそこにあることを証明するために、定期的にそのマッピングを更新するソフトウェアエンティティを必要とする合理的かつ賢明である一方、例えば、（そのDHCPアドレスのリースを更新するデバイスのように）、人間のユーザの同じことを要求するのは無理だろう。人間のユーザが自分のゲートウェイを構成するとき、彼らはそれを変更することを決定するまで、それがそのように構成された滞在することを期待しています。彼らはポートマッピングを設定した場合、彼らはそれを削除することを決定するまでは、設定済みとどまることを期待しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Because of this focus on being a general administration protocol for all aspects of home gateway configuration, UPnP IGD is a large and complicated collection of protocols (360 pages of specification spread over 13 separate documents, not counting supporting protocol specifications like Simple Service Discovery Protocol (SSDP) and Extensible Markup Language (XML)). While it may be a fine way for human users to configure their home gateways, it is not especially suited to the task of programmatically creating dynamic port mappings.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
そのため、ホームゲートウェイ構成のすべての側面のための一般的な投与プロトコルであることに、この焦点、UPnPのIGDはシンプルサービス発見プロトコル（のようなサポートするプロトコル仕様を数えていない、プロトコル13の別の文書に広がっ仕様の（360ページの大規模かつ複雑なコレクションですSSDP）および拡張マークアップ言語（XML））。それは人間のユーザが自分のホームゲートウェイを設定するための細かな道であるかもしれないが、それはプログラムで動的ポートマッピングを作成するタスクに特に適していません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The requirements for a good port mapping protocol, requirements that are met by NAT-PMP, are outlined below.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
良いポートマッピングプロトコルのための要件は、NAT-PMPによって満たされる要件は、以下の通りです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.1. Simplicity
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.1。単純
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Many home gateways, and many of the devices that connect to them, are small, low-cost devices, with limited RAM, flash memory, and CPU resources. Protocols they use should be considerate of this, supporting a small number of simple operations that can be implemented easily with a small amount of code. A quick comparison, based on page count of the respective documents alone, suggests that NAT-PMP is at least ten times simpler than UPnP IGD.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
、多くのホームゲートウェイ、およびそれらに接続するデバイスの多くは、限られたRAM、フラッシュメモリ、およびCPUリソースを持つ小型、低コストの装置です。彼らが使用するプロトコルは、コードの少量で容易に実現することができる簡単な操作少数の支持、これに配慮すべきです。迅速な比較は、単独の各文書のページ数に基づいて、NAT-PMPがUPnP IGDよりも少なくとも10倍単純であることを示唆しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.2. Focused Scope
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.2。集束範囲
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The more things a protocol can do, the more chance there is that something it does could be exploited for malicious purposes. NAT-PMP is tightly focused on the specific task of creating port mappings. Were the protocol to be misused in some way, this helps limit the scope of what mischief could be performed using the protocol.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
プロトコルが行うことができますより多くのものは、より多くのチャンスはそれがない何かが悪意のある目的のために悪用される可能性があることがあります。 NAT-PMPはしっかりとポートマッピングを作成するための特定のタスクに焦点を当てています。何らかの方法で悪用されるためのプロトコルだった、これは、プロトコルを使用して行うことができるものいたずらの範囲を制限することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Because UPnP IGD allows control over all home gateway configuration settings, the potential for mischief is far greater. For example, a UPnP IGD home gateway allows messages that tell it to change the DNS server addresses that it sends to clients in its DHCP packets. Using this mechanism, a single item of malicious web content (e.g., a rogue Flash banner advert on a web page) can make a persistent change to the home gateway&#39;s configuration without the user&#39;s knowledge, such that all future DNS requests by all local clients will be sent to a rogue DNS server. This allows criminals to perform a variety of mischief, such as hijacking connections to bank web sites and redirecting them to the criminals&#39; web servers instead [VU347812].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnPのIGDは、すべてのホームゲートウェイの構成設定を制御できますので、いたずらの可能性がはるかに大きいです。例えば、UPnPのIGDのホームゲートウェイは、そのDHCPパケット内のクライアントに送信するDNSサーバーのアドレスを変更するには、それを伝えるメッセージを可能にします。このメカニズム、悪質なWebコンテンツの単一のアイテムを使用すること（例えば、ウェブページ上の不正のFlashバナー広告）は、ユーザーの知識がなくてホームゲートウェイの設定に永続的な変更を加えることができ、その結果、すべてのローカルクライアントによる将来のすべてのDNS要求意志不正なDNSサーバに送信されます。これは、銀行のウェブサイトへの接続をハイジャックし、[VU347812]の代わりに犯罪者のWebサーバにそれらをリダイレクトするように、犯罪者はいたずらの様々なを実行することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.3. Efficiency
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.3。効率
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In addition to low-cost home gateways, many of the clients will also be similarly constrained low-cost devices with limited RAM resources.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
低コストのホームゲートウェイに加えて、クライアントの多くも同様に限られたRAMリソースを備えた低コストのデバイスを制約されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When implementing a NAT-PMP client on a constrained device, it&#39;s beneficial to have well-defined bounds on RAM requirements that are fixed and known in advance. For example, when requesting the gateway&#39;s external IPv4 address, a NAT-PMP client on Ethernet knows that to receive the reply it will require 14 bytes for the Ethernet header, 20 bytes for the IPv4 header, 8 bytes for the UDP header, and 12 bytes for the NAT-PMP payload, making a total of 54 bytes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
拘束されたデバイス上でNAT-PMPクライアントを実装する場合は、事前に固定され、知られているRAMの要件の明確に定義された境界を有することは有益です。ゲートウェイの外部IPv4アドレスを要求するとき、例えば、イーサネット（登録商標）上でNAT-PMPクライアントは、イーサネットヘッダの14バイト、IPv4ヘッダは20バイト、UDPヘッダの8バイト、及び12を必要とする応答を受信することを知っています54バイトの合計を作り、NAT-PMPペイロードのバイト。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In contrast, UPnP IGD uses an XML reply of unbounded size. It is not uncommon for a UPnP IGD device to return an XML document 4000 to 8000 bytes in size to communicate its 4-byte external IPv4 address, and the protocol specification places no upper bound on how large the XML response may be, so there&#39;s nothing to stop the reply being even larger. This means that developers of UPnP client devices can only guess at how much memory they may need to receive the XML reply. Operational experience suggests that 10,000 bytes is usually enough for most UPnP IGD home gateways today, but that&#39;s no guarantee that some future UPnP IGD home gateway might not return a perfectly legal XML reply much larger than that.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これとは対照的に、UPnPのIGDは、無制限のサイズのXML応答を使用しています。これは、UPnP IGDデバイスは、その4バイトの外部IPv4アドレスを伝達するために、サイズが8000バイトに、XML文書4000を返すことは珍しいことではありませんん、およびプロトコル仕様の場所XML応答がいかに大規模には上限なので、何もありませんでも大きい応答を停止します。これは、UPnPクライアントデバイスの開発者は、彼らだけがXML応答を受信する必要があるかもしれませんどのくらいのメモリを推測できることを意味します。運用経験は10,000バイトは、ほとんどのUPnP IGDのホームゲートウェイ用に通常、今日は十分であることを示唆しているが、それはいくつかの将来のUPnP IGDホームゲートウェイはそれよりもはるかに大きい完全に合法XML応答を返さないかもしれないことを保証ません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In addition, because the XML reply is too large to fit in a single UDP packet, UPnP IGD has to use a TCP connection, thereby adding the overhead of TCP connection setup and teardown.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
XML応答は、単一のUDPパケットに収まるには大きすぎるので、また、UPnPのIGDは、これにより、TCP接続のセットアップとティアダウンのオーバーヘッドを追加して、TCP接続を使用する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The process of discovering a UPnP IGD home gateway&#39;s external IPv4 address consists of:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnPのIGDのホームゲートウェイの外部IPv4アドレスを発見するプロセスは、から構成されています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o SSDP transaction to discover the TCP port to use, and the &#34;URL&#34; of the XML document to fetch from the gateway. Following the SSDP specification, this is 3 multicast requests, eliciting 9 unicast responses.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
O SSDPトランザクションが使用するTCPポートを発見すると、XML文書の「URL」はゲートウェイからフェッチします。 SSDP仕様に続き、これは9つのユニキャスト応答を誘発、3つのマルチキャスト要求です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o HTTP &#34;GET&#34; request to get the device description. Typically, 16 packets: 3 for TCP connection setup, 9 packets of data exchange, and a 4-packet FIN-ACK-FIN-ACK sequence to close the connection.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
O HTTPデバイスの説明を取得するための要求を「GET」。典型的には、16のパケット：3 TCP接続設定、データ交換の9つのパケット、及び4-パケットFIN-ACK、FIN-ACKシーケンスの接続を閉じます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o HTTP &#34;POST&#34; to request the external IPv4 address. Typically, 14 packets: 3 for TCP connection setup, 7 packets of data exchange, and a 4-packet FIN-ACK-FIN-ACK sequence to close the connection.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
外部IPv4アドレスを要求するO HTTP「POST」。典型的には、14のパケット：3 TCP接続設定、データ交換の7つのパケット、及び4-パケットFIN-ACK、FIN-ACKシーケンスの接続を閉じます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To retrieve the external IPv4 address NAT-PMP takes a 2-packet UDP exchange (44-byte request, 54-byte response); the same thing using UPnP IGD takes 42 packets and thousands of bytes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
外部IPv4アドレスを取得するにはNAT-PMPは、2パケットのUDP交換（44バイトの要求、54バイトの応答）を取ります。 UPnPのIGDを使用して同じことがバイトの42のパケットと数千人になります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Similarly, UPnP IGD&#39;s HTTP &#34;POST&#34; request for a port mapping is typically a 14-packet exchange, compared with NAT-PMP&#39;s 2-packet UDP exchange.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
同様に、ポートマッピングのためのUPnP IGDのHTTP「POST」要求は、NAT-PMPの2パケットのUDP交換と比較して、典型的には14パケット交換です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.4. Atomic Allocation Operations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.4。アトミック割り当て操作
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Some of the useful properties of NAT-PMP were inspired by DHCP, a reliable and successful protocol. For example, DHCP allows a client to request a desired IP address, but if that address is already in use the DHCP server will instead assign some other available address.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPの有用な特性のいくつかは、DHCP、信頼性が高く、成功したプロトコルに触発されました。たとえば、DHCPは、クライアントが必要なIPアドレスを要求することができますが、そのアドレスがすでに使用されている場合は、DHCPサーバーではなく、いくつかの他の利用可能なアドレスを割り当てます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Correspondingly, NAT-PMP allows a client to request a desired external port, and if that external port is already in use by some other client, the NAT-PMP server will instead assign some other available external port.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これに対応し、NAT-PMPは、クライアントが必要な外部ポートを要求することができ、その外部ポートが他のクライアントによってすでに使用されている場合は、NAT-PMPサーバーではなく、他のいくつかの利用可能な外部ポートを割り当てます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnP IGD does not do this. If a UPnP IGD client requests an external port that has already been allocated, then one of two things happens.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnPのIGDはこれを行いません。 UPnPのIGDクライアントがすでに割り当てられている外部ポートを要求した場合には、2つのいずれかが起こります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Some UPnP IGD home gateways just silently overwrite the old mapping with the new one, causing the previous client to lose connectivity. If the previous client renews its port mapping, then it in turn overwrites the new mapping, and the two clients fight over the same external port indefinitely, neither achieving reliable connectivity.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
いくつかのUPnP IGDのホームゲートウェイは、ただ黙って、接続を失い、以前のクライアントを引き起こして、新しいものと古いマッピングを上書きします。以前のクライアントがそのポートマッピングを更新した場合、それは順番に新しいマッピングを上書きし、そして2つのクライアントが無期限に同一の外部ポートを介して戦うん、どちらも信頼性の高い接続を実現します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Other IGD home gateways return a &#34;Conflict&#34; error if the port is already in use, which does at least tell the client what happened, but doesn&#39;t tell the client what to do. Instead of the NAT gateway (which does know which ports are available) assigning one to the client, the NAT gateway makes the client (which doesn&#39;t know) keep guessing until it gets lucky. This problem remains mild as long as not many clients are using UPnP IGD, but gets progressively worse as the number of clients on the network requesting port mappings goes up. In addition, UPnP IGD works particularly badly in conjunction with the emerging policy of allocating pre-assigned port ranges to each client. If a client is assigned TCP port range 63488-64511, and the UPnP IGD client requests TCP port 80, trying successive incrementing ports until it succeeds, then the UPnP IGD client will have to issue 63,409 requests before it succeeds.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
他のIGDのホームゲートウェイは、ポートが既に使用中である場合、少なくとも何が起こったのか、クライアントを教えてくれんた、「競合」エラーを返しますが、何をすべきかをクライアントに通知しません。代わりに、（利用可能なポートを知っているん）NATゲートウェイはクライアントに1を割り当てるので、NATゲートウェイは（知らない）クライアントは、それは幸運なるまで推測しておくことができます。この問題は、限り多くないクライアントは、UPnP IGDを使用していると穏やかなままですが、ポートマッピングを要求して、ネットワーク上のクライアントの数が上がると徐々に悪化します。また、UPnPのIGDは、各クライアントに事前に割り当てられたポート範囲を割り当てるの新興政策と関連して特にひどく動作します。クライアントは、TCPポート範囲63488から64511を割り当てられ、UPnPのIGDクライアントは、それが成功するまで、連続するインクリメントポートをしようと、TCPポート80を要求した場合、その後のUPnP IGDクライアントは、それが成功する前に63409件のリクエストを発行する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.5. Garbage Collection
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.5。ガーベジコレクション
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In any system that operates for a long period of time (as a home gateway should), it is important that garbage data does not accumulate indefinitely until the system runs out of memory and fails.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
（ホームゲートウェイ必要として）長時間の動作どのようなシステムでは、システムがメモリ不足と失敗するまでゴミデータが無限に蓄積しないことが重要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Similar to how DHCP leases an IP address to a client for a finite length of time, NAT-PMP leases an external port to a client for a finite length of time. The NAT-PMP client must renew the port mapping before it expires, or, like an unrenewed DHCP address, it will be reclaimed. If a laptop computer is abruptly disconnected from the network without the opportunity to delete its port mappings, the NAT gateway will reclaim those mappings when they are not renewed.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
DHCPは、時間の有限の長さのために、クライアントにIPアドレスをリースする方法と同様に、NAT-PMPは、有限の時間の長さのために、クライアントへの外部ポートをリース。 NAT-PMPクライアントはunrenewed DHCPアドレスのように、それが再利用され、有効期限が切れる前に、ポートマッピングを更新、または必要があります。ラップトップコンピュータが突然そのポートマッピングを削除する機会なしにネットワークから切断されている場合は、それらが更新されていない場合、NATゲートウェイは、これらのマッピングを再利用します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In principle, UPnP IGD should allow clients to specify a lifetime on port mappings. However, a Google search for &#34;UPnP NewLeaseDuration&#34; shows that in practice pretty much every client uses &#34;&lt;NewLeaseDuration&gt;0&lt;/NewLeaseDuration&gt;&#34; to request an infinite lease, and the protocol has no way for the NAT gateway to decline that infinite lease request and require the client to renew it at reasonable intervals. Furthermore, anecdotal evidence is that if the client requests a lease other than zero, there are IGD home gateways that will ignore the request, fail in other ways, or even crash completely. As a client implementer then, you would be well advised not to attempt to request a lease other than zero, unless you want to suffer the support costs and bad publicity of lots of people complaining that your device brought down their entire network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
原則として、UPnPのIGDは、クライアントがポートマッピングの寿命を指定できるようにする必要があります。しかし、「UPnPのNewLeaseDuration」のGoogle検索は、実際にはほとんどすべてのクライアントは、無限のリースを要求するために、「&lt;NewLeaseDuration&gt; 0 &lt;/ NewLeaseDuration&gt;」を使用し、プロトコルがNATゲートウェイはその無限のリースを拒否するための方法がないことを示しています合理的な間隔で、それを更新するために、クライアントを要求し、必要としています。さらに、事例証拠は、クライアントがゼロ以外のリースを要求した場合、要求を無視する他の方法で失敗し、あるいは完全にクラッシュしますIGDのホームゲートウェイがあるということです。クライアントの実装のように、あなたもあなたのデバイスは、そのネットワーク全体をダウンさせていること文句多くの人々のサポートコストと悪評に苦しむする場合を除き、ゼロ以外のリースを要求しようとしないのが賢明でしょう。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Because none of the early UPnP IGD clients requested port mapping leases, many UPnP IGD home gateway vendors never tested that functionality, and got away with shipping home gateways where that functionality was buggy or nonexistent. Because there are so many buggy UPnP IGD home gateways already deployed, client writers wisely stick to the well-trodden path of only requesting infinite leases. Because there are now few (if any) clients attempting to request non-zero leases, home gateway vendors have little incentive to expend resources implementing a feature no one uses.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
早期のUPnP IGDクライアントのいずれもポートマッピングのリースを要求していないので、多くのUPnP IGDホームゲートウェイ・ベンダーは、その機能をテストしていない、とその機能にバグまたは存在しなかった海運ホームゲートウェイで逃げたん。既に展開ように多くのバグだらけのUPnP IGDのホームゲートウェイがあるため、クライアントの作家は賢明にのみ無限のリースを要求するのはよく踏まパスに固執します。ゼロ以外のリースを要求しようとすると（もしあれば）いくつかのクライアントが存在することになりますので、ホームゲートウェイベンダーは誰も使用しない機能を実装リソースを消費するインセンティブを持っています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This unfortunate consequence of the way UPnP IGD was developed and deployed means that in practice it has no usable port mapping lease facility today, and therefore when run for a long period of time UPnP IGD home gateways have no good way to avoid accumulating an unbounded number of stale port mappings.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnPのIGDが開発され、配備された方法のこの不幸な結果は、時間のUPnP IGDのホームゲートウェイの長い期間のために実行したときに、実際にそれがゆえ、今日何も使用可能なポートマッピングリース施設を持っていないことを意味し、無制限の数の蓄積を避けるために良い方法がありません古いポートマッピングの。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.6. State Change Announcements
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.6。状態変更のお知らせ
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When using DHCP on the external interface, as is the norm for home gateways, there is no guarantee that a UPnP IGD home gateway&#39;s external IPv4 address will remain unchanged. Indeed, some ISPs change their customer&#39;s IPv4 address every 24 hours (possibly in an effort to make it harder for their customers to &#34;run a server&#34; at home). What this means is that if the home gateway&#39;s external IPv4 address changes, it needs to inform its clients, so that they can make any necessary updates to global directory information (e.g., performing a Dynamic DNS update to update their address record).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ホームゲートウェイのための規範であるとして、外部インターフェイス上でDHCPを使用する場合は、UPnPのIGDのホームゲートウェイの外部IPv4アドレスが変更されないままになる保証はありません。実際、いくつかのISPは、（おそらくそれが難しく、顧客が自宅で「サーバーを実行」できるようにするために努力して）顧客のIPv4アドレスを24時間ごとに変更します。これが意味することは、ホームゲートウェイの外部IPv4アドレスが変更された場合、それは（例えば、そのアドレスのレコードを更新するダイナミックDNS更新を実行する）は、グローバルなディレクトリ情報に必要な更新を行うことができるように、そのクライアントに通知する必要があるということです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When a NAT-PMP gateway&#39;s external IPv4 address changes, it broadcasts announcement packets to inform clients of this. UPnP IGD does not.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
NAT-PMPゲートウェイの外部IPv4アドレスの変更は、それが発表パケットをブロードキャストすると、こののクライアントに通知します。 UPnPのIGDはしていません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.7. Soft State Recovery
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.7。ソフトステート回復
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When run for a long enough period of time, any network will have devices that fail, get rebooted, suffer power outages, or lose state for other reasons. A home gateway that runs for long enough is likely to suffer some such incident eventually. After losing state, it has no record of the port mappings it created, and clients suffer a consequent loss of connectivity.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
時間の十分長い時間実行すると、任意のネットワークは、再起動します、失敗停電に苦しむ、またはその他の理由で状態を失うのデバイスを持っています。十分な長さのために実行されるホームゲートウェイは最終的にこのようないくつかの事件に苦しむ可能性があります。状態を失った後、それが作成されたポートマッピングのレコードがない、そしてクライアントは、接続の必然的な損失を被ります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To handle this case, NAT-PMP has the &#34;Seconds Since Start of Epoch&#34; mechanism. After a reboot or other loss of state, a NAT-PMP gateway broadcasts announcement packets giving its external IPv4 address, with the Seconds Since Start of Epoch field reset to begin counting from zero again. When a NAT-PMP client observes packets from its NAT-PMP gateway where the gateway&#39;s notion of time has apparently gone backwards compared to the client&#39;s, the client knows the gateway has probably lost state, and immediately recreates its mappings to restore connectivity.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このような場合に対処するには、NAT-PMPは「秒エポックの開始以来、」機構を有しています。リブートまたは状態の他の損失の後、NAT-PMPゲートウェイブロードキャストアナウンスメントパケットは、Epochのフィールドのリセットの開始が再びゼロからカウントを開始するので秒と、その外部IPv4アドレスを与えます。 NAT-PMPクライアントは時間のゲートウェイの概念は、明らかに、クライアントのに比べて後方行ってきましたそのNAT-PMPゲートウェイからのパケットを観測した場合、クライアントは、ゲートウェイは、おそらく状態を失い、すぐに接続を復元するために、そのマッピングを再作成している知っています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnP IGD has no equivalent mechanism.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UPnPのIGDには同等のメカニズムを持っていません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.8. On-Path NAT Discovery
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.8。パス上のNAT発見
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
For any given host, it is only useful to request NAT port mappings in the NAT gateway through which that host&#39;s packets are flowing. A NAT port mapping is a request for packets to be translated in a certain way; the NAT gateway can only perform that translation if it&#39;s actually forwarding inbound and outbound packets for that host.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
任意のホストの場合、そのホストのパケットが流れている、それを通してNATゲートウェイでNATポートマッピングを要求するためにのみ有用です。 NATポートマッピングは、特定の方法で翻訳されるパケットのための要求です。それは実際にそのホストのインバウンドとアウトバウンドのパケットを転送するかどうNATゲートウェイは、それだけで変換を実行することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This is why NAT-PMP sends its requests to the host&#39;s default router, since this is the device that is forwarding (and possibly translating) inbound and outbound packets for that host. (In a larger network with multiple hops between a host and its NAT gateway, some other mechanism would need to be used to discover the correct on-path NAT for a host; this is possible, but outside the scope of this document.)
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これは、そのホストのインバウンドとアウトバウンドのパケットを転送する（そしておそらく翻訳）されているデバイスであるため、NAT-PMPは、ホストのデフォルトルータにその要求を送信する理由です。 （ホストとNATゲートウェイの間の複数のホップを持つ大規模ネットワークでは、いくつかの他のメカニズムは、ホストの正しいオンパスNATを発見するために使用される必要があるであろう、これは可能であるが、この文書の範囲外）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In contrast, UPnP IGD does not limit itself to using only on-path NATs. UPnP IGD uses a multicast SSDP query, and uses any device it finds on the local network claiming UPnP IGD capability, regardless of whether any inbound or outbound traffic is actually flowing through that device. Over the past few years this led to many bug reports being sent to Apple with the general form: &#34;Port Mapping doesn&#39;t work on my Mac and that&#39;s a bug because everything else on my network says UPnP IGD is working fine.&#34; Upon investigation it always turned out that: (i) these people had NAT gateways that either didn&#39;t support port mapping requests, or had that capability disabled, and (ii) for some reason they also had some other old NAT device still connected to their network, and those other NAT devices were advertising UPnP IGD capability, even though they were not the active NAT gateway for the network. This led to UPnP IGD clients falsely reporting that they were &#34;working fine&#34;, and only the Mac correctly reporting that it was unable to make any useful port mappings. In many cases the people reporting this &#34;bug&#34; had devices like game consoles on their home network that for many years had been reporting that UPnP IGD was &#34;working fine&#34;, yet during those years they had never once successfully received any inbound network packet or connection. The irony is that, for these people who were reporting bugs to Apple, UPnP IGD &#34;working fine&#34; had been indistinguishable from UPnP IGD doing nothing useful at all. It was only when Back to My Mac [RFC6281] started reporting that it was unable to make any functional port mappings that these people discovered they&#39;d never had any working port mappings on their NAT gateway.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
対照的に、UPnPのIGDのみオンパスのNATを使用すること自体を限定するものではありません。 UPnPのIGDは、マルチキャストSSDPクエリを使用し、それは関係なく、任意のインバウンドまたはアウトバウンドのトラフィックが実際にそのデバイスを通って流れているかどうかの、のUPnP IGD機能を主張し、ローカルネットワーク上にあるすべてのデバイスを使用しています。過去数年間で、これは一般的な形式でアップルに送信されている多くのバグレポートにつながった：「ポートマッピングは、私のMac上では動作しませんし、私のネットワーク上の他のすべては、UPnP IGDが正常に動作していると言うので、それはバグです。」これらの人々はどちらかがポートマッピング要求をサポートしていませんでしたNATゲートウェイを持っていた、またはその機能が無効になっていた、および（ii）何らかの理由で、彼らはまた、他のいくつかの古いNATデバイスがまだに接続されていた（I）：調査の結果、それは常にことが判明しました彼らのネットワーク、およびそれらの他のNATデバイスは、それらがネットワークのためのアクティブNATゲートウェイではなかったにもかかわらず、UPnPのIGD機能を宣伝しました。これは、UPnP IGDクライアントが誤って、彼らは「細かい作業」し、Macのみが正しく、任意の有用なポートマッピングを行うことができなかったことを報告していることを報告するに至りました。多くの場合、この「バグ」を報告し、人々が長年にわたってのUPnP IGDは「細かい作業」されたことを報告していた彼らのホームネットワーク上のゲーム機のようなデバイスを持っていた、まだそれらの年の間に、彼らは一度に成功任意の受信ネットワークパケットを受信したことがなかったですか、接続。皮肉は、Apple、UPnPのIGDにバグを報告する「細かい作業」されたこれらの人々のためにすべての有用な何もしないのUPnP IGDと区別できていた、ということです。マック[RFC6281]は、これらの人々は、彼らが自分のNATゲートウェイ上の任意の現用ポートマッピングを持っていたことがありませんでし発見された機能のポートマッピングを作ることができなかったことを報告し始めたときに戻る私にそれだけでした。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10. References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.参考文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.1. Normative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.1。引用規格
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC1918] Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G., and E. Lear, &#34;Address Allocation for Private Internets&#34;, BCP 5, RFC 1918, February 1996.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC1918] Rekhter、Y.、モスコウィッツ、B.、Karrenberg、D.、グルート、G.、およびE.リアド、 &#34;個人的なインターネットのための配分&#34;、BCP 5、RFC 1918、1996年2月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2119] Bradner, S., &#34;Key words for use in RFCs to Indicate Requirement Levels&#34;, BCP 14, RFC 2119, March 1997.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2119]ブラドナーの、S.、 &#34;要件レベルを示すためにRFCsにおける使用のためのキーワード&#34;、BCP 14、RFC 2119、1997年3月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.2. Informative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.2。参考文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[Bonjour] Apple &#34;Bonjour&#34; &lt;http://developer.apple.com/bonjour/&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[こんにちは]アップル、 &#34;こんにちは&#34; &lt;http://developer.apple.com/bonjour/&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[ETEAISD] J. Saltzer, D. Reed and D. Clark: &#34;End-to-end arguments in system design&#34;, ACM Trans. Comp. Sys., 2(4):277-88, November 1984.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[ETEAISD] J. Saltzer、D.リードとD.クラーク：「システム設計におけるエンドツーエンドの引数」、ACMトランス。コンプ。 SYS、2（4）：277から88、1984年11月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[IGD] UPnP Standards &#34;Internet Gateway Device (IGD) Standardized Device Control Protocol V 1.0&#34;, November 2001, &lt;http://www.upnp.org/standardizeddcps/igd.asp&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[IGD]のUPnP規格 &#34;インターネットゲートウェイデバイス（IGD）標準化されたデバイス制御プロトコルV 1.0&#34;、2001年11月、&lt;http://www.upnp.org/standardizeddcps/igd.asp&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2131] Droms, R., &#34;Dynamic Host Configuration Protocol&#34;, RFC 2131, March 1997.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2131] Droms、R.、 &#34;動的ホスト構成プロトコル&#34;、RFC 2131、1997年3月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2663] Srisuresh, P. and M. Holdrege, &#34;IP Network Address Translator (NAT) Terminology and Considerations&#34;, RFC 2663, August 1999.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2663] Srisuresh、P.とM.ホールドレッジ、 &#34;IPネットワークアドレス変換（NAT）用語と考慮事項&#34;、RFC 2663、1999年8月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3007] Wellington, B., &#34;Secure Domain Name System (DNS) Dynamic Update&#34;, RFC 3007, November 2000.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3007]ウェリントン、B.、RFC 3007、2000年11月 &#34;ドメインネームシステム（DNS）動的更新をセキュア&#34;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3022] Srisuresh, P. and K. Egevang, &#34;Traditional IP Network Address Translator (Traditional NAT)&#34;, RFC 3022, January 2001.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3022] Srisuresh、P.とK. Egevang、 &#34;伝統的なIPネットワークアドレス変換（NAT繁体字）&#34;、RFC 3022、2001年1月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3424] Daigle, L., Ed., and IAB, &#34;IAB Considerations for UNilateral Self-Address Fixing (UNSAF) Across Network Address Translation&#34;, RFC 3424, November 2002.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC3424] Daigle氏、L.、エド。、およびIAB、RFC 3424 &#34;一方的な自己アドレス固定ネットワークアドレス変換アクロス（UNSAF）のためのIABの考慮事項&#34;、2002年11月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC4301] Kent, S. and K. Seo, &#34;Security Architecture for the Internet Protocol&#34;, RFC 4301, December 2005.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC4301]ケント、S.とK. Seo、 &#34;インターネットプロトコルのためのセキュリティアーキテクチャ&#34;、RFC 4301、2005年12月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6281] Cheshire, S., Zhu, Z., Wakikawa, R., and L. Zhang, &#34;Understanding Apple&#39;s Back to My Mac (BTMM) Service&#34;, RFC 6281, June 2011.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6281]チェシャー、S.、朱、Z.、Wakikawa、R.、およびL.チャン、RFC 6281、2011年6月、 &#34;どこでもMy Mac（BTMM）サービスにAppleのバックを理解します&#34;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6763] Cheshire, S. and M. Krochmal, &#34;DNS-Based Service Discovery&#34;, RFC 6763, February 2013.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6763]チェシャー、S.及びM. Krochmal、 &#34;DNSベースのサービス発見&#34;、RFC 6763、2013年2月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6887] Wing, D., Ed., Cheshire, S., Boucadair, M., Penno, R., and P. Selkirk, &#34;Port Control Protocol (PCP)&#34;, RFC 6887, April 2013.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC6887]ウイング、D.、エド。、チェシャー、S.、Boucadair、M.、Penno、R.、およびP.セルカーク、 &#34;ポート制御プロトコル（PCP）&#34;、RFC 6887、2013年4月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[SEE] SubEthaEdit, &lt;http://www.codingmonkeys.de/subethaedit/&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
【参照】SubEthaEdit、&lt;http://www.codingmonkeys.de/subethaedit/&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[VU347812] United States Computer Emergency Readiness Team Vulnerability Note VU#347812, &lt;http://www.kb.cert.org/vuls/id/347812&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[VU347812]米国コンピュータ緊急即応チーム脆弱性ノートVU＃347812、&lt;http://www.kb.cert.org/vuls/id/347812&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Authors&#39; Addresses
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著者のアドレス
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Stuart Cheshire Apple Inc. 1 Infinite Loop Cupertino, CA 95014 USA
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
スチュアートチェシャーれたApple Inc. 1無限ループクパチーノ、CA 95014 USA
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
EMail: cheshire@apple.com
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
メールアドレス：cheshire@apple.com
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Marc Krochmal Apple Inc. 1 Infinite Loop Cupertino, CA 95014 USA
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
マルク・KrochmalされたApple Inc. 1無限ループクパチーノ、CA 95014 USA
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
EMail: marc@apple.com
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
メールアドレス：marc@apple.com
        </p>
      </div>
    </div>
  </div>
  <div class="footer"></div>
</body>
</html>
