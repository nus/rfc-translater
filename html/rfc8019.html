<!DOCTYPE html>

<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>RFC 8019 - Protecting Internet Key Exchange Protocol Version 2 (IKEv2) Implementations from Distributed Denial-of-Service Attacks 日本語訳</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style type="text/css">
    p.text { font-size: 100%; }
    pre.text { font-size: 75%; }
  </style>

  <script src="index.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-75892425-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>
<body>
  <nav class="navbar navbar-expand navbar-light bg-light">
    <a class="navbar-brand" href="index.html">RFC Trans</a>
    <div class="collapse navbar-collapse" id="navbarText">
      <div class="navbar-nav mr-auto">
        <a class="nav-item nav-link" href="privacy-policy.html">Privacy Policy</a>
        <a class="nav-item nav-link" href="contact.html">Contact</a>
      </div>
      <div class="navbar-nav ml-auto">
        <span class="navbar-text"><small>@tex2e</small></span>
      </div>
    </div>
  </nav>
  <div style="height: 1ex;"></div>
  <div class="container">
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <div class="alert alert-info" role="alert">
          <h4 class="alert-heading">RFC 8019 - Protecting Internet Key Exchange Protocol Version 2 (IKEv2) Implementations from Distributed Denial-of-Service Attacks 日本語訳</h4>
          <span class="URL">URL :
            <a href="https://tools.ietf.org/html/rfc8019">
              https://tools.ietf.org/html/rfc8019
            </a>
          </span><br>
          <span class="title_ja">
            タイトル : <strong>RFC 8019 - 分散型サービス拒否攻撃からのインターネットキー交換プロトコルバージョン2（IKEv2）実装の保護</strong></span><br>
          <span class="created_at">生成日時 : 2019-10-19 21:54:26.195487+09:00</span><br>
          <span class="updated_by">翻訳編集 : 自動生成</span><br>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
Internet Engineering Task Force (IETF)                            Y. Nir
Request for Comments: 8019                                   Check Point
Category: Standards Track                                     V. Smyslov
ISSN: 2070-1721                                               ELVIS-PLUS
                                                           November 2016
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
      Protecting Internet Key Exchange Protocol Version 2 (IKEv2)
       Implementations from Distributed Denial-of-Service Attacks
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Abstract
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
抽象
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document recommends implementation and configuration best practices for Internet Key Exchange Protocol version 2 (IKEv2) Responders, to allow them to resist Denial-of-Service and Distributed Denial-of-Service attacks. Additionally, the document introduces a new mechanism called &#34;Client Puzzles&#34; that helps accomplish this task.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントでは、インターネットキー交換プロトコルバージョン2（IKEv2）レスポンダーの実装と構成のベストプラクティスを推奨し、サービス拒否攻撃および分散型サービス拒否攻撃に抵抗できるようにします。 さらに、このドキュメントでは、このタスクを達成するのに役立つ「クライアントパズル」と呼ばれる新しいメカニズムを紹介しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Status of This Memo
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このメモのステータス
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This is an Internet Standards Track document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これはインターネット標準化過程の文書です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 7841.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントは、Internet Engineering Task Force（IETF）の製品です。 IETFコミュニティのコンセンサスを表しています。 これは公開レビューを受けており、Internet Engineering Steering Group（IESG）による公開が承認されています。 インターネット標準の詳細については、RFC 7841のセクション2を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc8019.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントの現在のステータス、エラッタ、およびフィードバックに関する情報は、http：//www.rfc-editor.org/info/rfc8019で入手できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Copyright Notice
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著作権表示
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Copyright (c) 2016 IETF Trust and the persons identified as the document authors. All rights reserved.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Copyright（c）2016 IETF Trustおよび文書の著者として特定された人物。 全著作権所有。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document is subject to BCP 78 and the IETF Trust&#39;s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この文書は、この文書の発行日に有効なBCP 78およびIETFトラストのIETF文書に関する法的条項（http://trustee.ietf.org/license-info）の対象となります。 これらのドキュメントは、このドキュメントに関するあなたの権利と制限を説明しているので、注意深く確認してください。 このドキュメントから抽出されたコードコンポーネントには、Trust Legal Provisionsのセクション4.eに記載されているSimplified BSD Licenseテキストを含める必要があり、Simplified BSD Licenseに記載されている保証なしで提供されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Table of Contents
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
目次
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   3
   3.  The Vulnerability . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Defense Measures While the IKE SA Is Being Created  . . . . .   6
     4.1.  Retention Periods for Half-Open SAs . . . . . . . . . . .   6
     4.2.  Rate Limiting . . . . . . . . . . . . . . . . . . . . . .   7
     4.3.  The Stateless Cookie  . . . . . . . . . . . . . . . . . .   8
     4.4.  Puzzles . . . . . . . . . . . . . . . . . . . . . . . . .   8
     4.5.  Session Resumption  . . . . . . . . . . . . . . . . . . .  11
     4.6.  Keeping Computed Shared Keys  . . . . . . . . . . . . . .  11
     4.7.  Preventing &#34;Hash and URL&#34; Certificate Encoding Attacks  .  11
     4.8.  IKE Fragmentation . . . . . . . . . . . . . . . . . . . .  12
   5.  Defense Measures after an IKE SA Is Created . . . . . . . . .  12
   6.  Plan for Defending a Responder  . . . . . . . . . . . . . . .  14
   7.  Using Puzzles in the Protocol . . . . . . . . . . . . . . . .  16
     7.1.  Puzzles in IKE_SA_INIT Exchange . . . . . . . . . . . . .  16
       7.1.1.  Presenting a Puzzle . . . . . . . . . . . . . . . . .  17
       7.1.2.  Solving a Puzzle and Returning the Solution . . . . .  19
       7.1.3.  Computing a Puzzle  . . . . . . . . . . . . . . . . .  20
       7.1.4.  Analyzing Repeated Request  . . . . . . . . . . . . .  21
       7.1.5.  Deciding Whether to Serve the Request . . . . . . . .  22
     7.2.  Puzzles in an IKE_AUTH Exchange . . . . . . . . . . . . .  23
       7.2.1.  Presenting the Puzzle . . . . . . . . . . . . . . . .  24
       7.2.2.  Solving the Puzzle and Returning the Solution . . . .  24
       7.2.3.  Computing the Puzzle  . . . . . . . . . . . . . . . .  25
       7.2.4.  Receiving the Puzzle Solution . . . . . . . . . . . .  25
   8.  Payload Formats . . . . . . . . . . . . . . . . . . . . . . .  26
     8.1.  PUZZLE Notification . . . . . . . . . . . . . . . . . . .  26
     8.2.  Puzzle Solution Payload . . . . . . . . . . . . . . . . .  27
   9.  Operational Considerations  . . . . . . . . . . . . . . . . .  28
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  28
   11. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  30
   12. References  . . . . . . . . . . . . . . . . . . . . . . . . .  30
     12.1.  Normative References . . . . . . . . . . . . . . . . . .  30
     12.2.  Informative References . . . . . . . . . . . . . . . . .  31
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  31
   Authors&#39; Addresses  . . . . . . . . . . . . . . . . . . . . . . .  32
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1. Introduction
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.はじめに
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Denial-of-Service (DoS) attacks have always been considered a serious threat. These attacks are usually difficult to defend against since the amount of resources the victim has is always bounded (regardless of how high it is) and because some resources are required for distinguishing a legitimate session from an attack.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
サービス拒否（DoS）攻撃は常に深刻な脅威と見なされてきました。 これらの攻撃は、被害者のリソースの量が常に制限されているため（どれだけ高いかに関係なく）、正当なセッションと攻撃を区別するために必要なリソースがあるため、通常は防御が困難です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Internet Key Exchange Protocol version 2 (IKEv2) described in [RFC7296] includes defense against DoS attacks. In particular, there is a cookie mechanism that allows the IKE Responder to defend itself against DoS attacks from spoofed IP addresses. However, botnets have become widespread, allowing attackers to perform Distributed Denial-of-Service (DDoS) attacks, which are more difficult to defend against. This document presents recommendations to help the Responder counter DoS and DDoS attacks. It also introduces a new mechanism -- &#34;puzzles&#34; -- that can help accomplish this task.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]で説明されているインターネットキー交換プロトコルバージョン2（IKEv2）には、DoS攻撃に対する防御が含まれています。 特に、IKEレスポンダーがスプーフィングされたIPアドレスからのDoS攻撃から身を守るためのCookieメカニズムがあります。 ただし、ボットネットが広く普及しているため、攻撃者は防御がより難しい分散型サービス拒否（DDoS）攻撃を実行できます。 このドキュメントでは、レスポンダーがDoSおよびDDoS攻撃に対処するための推奨事項を示します。 また、このタスクを達成するのに役立つ新しいメカニズム「パズル」も導入します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
2. Conventions Used in This Document
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
2.このドキュメントで使用される規則
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;NOT RECOMMENDED&#34;, &#34;MAY&#34;, and &#34;OPTIONAL&#34; in this document are to be interpreted as described in [RFC2119].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
キーワード「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「NOT RECOMMENDED」、「MAY」、および「OPTIONAL」 「このドキュメントの」は、[RFC2119]で説明されているように解釈されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3. The Vulnerability
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.脆弱性
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The IKE_SA_INIT exchange described in Section 1.2 of [RFC7296] involves the Initiator sending a single message. The Responder replies with a single message and also allocates memory for a structure called a half-open IKE Security Association (SA). This half-open SA is later authenticated in the IKE_AUTH exchange. If that IKE_AUTH request never comes, the half-open SA is kept for an unspecified amount of time. Depending on the algorithms used and implementation, such a half-open SA will use from around one hundred to several thousand bytes of memory.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]のセクション1.2で説明されているIKE_SA_INIT交換では、イニシエーターが単一のメッセージを送信します。 レスポンダーは単一のメッセージで応答し、ハーフオープンIKEセキュリティアソシエーション（SA）と呼ばれる構造にメモリを割り当てます。 このハーフオープンSAは、IKE_AUTH交換で後で認証されます。 そのIKE_AUTH要求が来ない場合、ハーフオープンSAは不特定の期間保持されます。 使用されるアルゴリズムと実装に応じて、そのようなハーフオープンSAは約100〜数千バイトのメモリを使用します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This creates an easy attack vector against an IKE Responder. Generating the IKE_SA_INIT request is cheap. Sending large amounts of IKE_SA_INIT requests can cause a Responder to use up all its resources. If the Responder tries to defend against this by throttling new requests, this will also prevent legitimate Initiators from setting up IKE SAs.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
これにより、IKEレスポンダーに対する簡単な攻撃ベクトルが作成されます。 IKE_SA_INIT要求の生成は安価です。 大量のIKE_SA_INIT要求を送信すると、レスポンダーがそのすべてのリソースを使い果たす可能性があります。 レスポンダーが新しい要求を調整することでこれを防御しようとすると、正当なイニシエーターがIKE SAをセットアップできなくなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
An obvious defense, which is described in Section 4.2, is limiting the number of half-open SAs opened by a single peer. However, since all that is required is a single packet, an attacker can use multiple spoofed source IP addresses.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
セクション4.2で説明されている明らかな防御は、単一のピアによって開かれるハーフオープンSAの数を制限することです。 ただし、必要なのは1つのパケットだけなので、攻撃者は複数のスプーフィングされたソースIPアドレスを使用できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If we break down what a Responder has to do during an initial exchange, there are three stages:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
最初の交換でレスポンダーがしなければならないことを分析する場合、3つの段階があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. When the IKE_SA_INIT request arrives, the Responder:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. IKE_SA_INIT要求が到着すると、レスポンダーは次のことを行います。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Generates or reuses a Diffie-Hellman (DH) private part.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Diffie-Hellman（DH）プライベートパーツを生成または再利用します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Generates a Responder Security Parameter Index (SPI).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
*レスポンダーセキュリティパラメーターインデックス（SPI）を生成します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Stores the private part and peer public part in a half-open SA database.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
*プライベートな部分とピアのパブリックな部分をハーフオープンSAデータベースに保存します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. When the IKE_AUTH request arrives, the Responder:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. IKE_AUTH要求が到着すると、レスポンダーは次のことを行います。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Derives the keys from the half-open SA.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
*半オープンSAからキーを取得します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
* Decrypts the request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
*要求を解読します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
3. If the IKE_AUTH request decrypts properly, the Responder:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
3. IKE_AUTH要求が正しく復号化されると、レスポンダーは次のことを行います。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
       *  Validates the certificate chain (if present) in the IKE_AUTH
          request.
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The fourth stage where the Responder creates the Child SA is not reached by attackers who cannot pass the authentication step.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーが子SAを作成する4番目の段階には、認証手順に合格できない攻撃者が到達しません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Stage #1 is pretty light on CPU usage, but requires some storage, and it&#39;s very light for the Initiator as well. Stage #2 includes private-key operations, so it is much heavier CPU-wise. Stage #3 may include public key operations if certificates are involved. These operations are often more computationally expensive than those performed at stage #2.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ステージ＃1はCPU使用率はかなり軽いですが、いくらかのストレージが必要であり、イニシエーターにとっても非常に軽いです。 ステージ＃2には秘密キー操作が含まれているため、CPUの面ではるかに重いです。 証明書が関係する場合、ステージ＃3には公開キー操作が含まれる場合があります。 これらの操作は、多くの場合、ステージ2で実行される操作よりも計算コストが高くなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To attack such a Responder, an attacker can attempt to exhaust either memory or CPU. Without any protection, the most efficient attack is to send multiple IKE_SA_INIT requests and exhaust memory. This is easy because IKE_SA_INIT requests are cheap.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このようなレスポンダーを攻撃するために、攻撃者はメモリまたはCPUを使い果たすことができます。 保護がなければ、最も効率的な攻撃は、複数のIKE_SA_INIT要求を送信し、メモリを使い果たすことです。 IKE_SA_INIT要求は安価であるため、これは簡単です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
There are obvious ways for the Responder to protect itself without changes to the protocol. It can reduce the time that an entry remains in the half-open SA database, and it can limit the amount of concurrent half-open SAs from a particular address or prefix. The attacker can overcome this by using spoofed source addresses.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがプロトコルを変更せずに自身を保護する明らかな方法があります。 エントリがハーフオープンSAデータベースに残る時間を短縮でき、特定のアドレスまたはプレフィックスからの同時ハーフオープンSAの量を制限できます。 攻撃者は、スプーフィングされた送信元アドレスを使用してこれを克服できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The stateless cookie mechanism from Section 2.6 of [RFC7296] prevents an attack with spoofed source addresses. This doesn&#39;t completely solve the issue, but it makes the limiting of half-open SAs by address or prefix work. Puzzles, introduced in Section 4.4,
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]のセクション2.6のステートレスCookieメカニズムは、なりすましソースアドレスによる攻撃を防ぎます。 これは問題を完全には解決しませんが、アドレスまたはプレフィックスによるハーフオープンSAの制限を機能させます。 セクション4.4で紹介したパズル
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
accomplish the same thing -- only more of it. They make it harder for an attacker to reach the goal of getting a half-open SA. Puzzles do not have to be so hard that an attacker cannot afford to solve a single puzzle; it is enough that puzzles increase the cost of creating half-open SAs, so the attacker is limited in the amount they can create.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
同じことを達成する-それだけの。 攻撃者がハーフオープンSAを取得するという目標を達成することを困難にします。 パズルはそれほど難しくなくても、攻撃者は1つのパズルを解く余裕はありません。 パズルはハーフオープンSAの作成コストを増やすだけで十分であるため、攻撃者は作成できる量が制限されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Reducing the lifetime of an abandoned half-open SA also reduces the impact of such attacks. For example, if a half-open SA is kept for 1 minute and the capacity is 60,000 half-open SAs, an attacker would need to create 1,000 half-open SAs per second. If the retention time is reduced to 3 seconds, the attacker would need to create 20,000 half-open SAs per second to get the same result. By introducing a puzzle, each half-open SA becomes more expensive for an attacker, making it more likely to prevent an exhaustion attack against Responder memory.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
放棄されたハーフオープンSAのライフタイムを短縮すると、このような攻撃の影響も軽減されます。 たとえば、ハーフオープンSAが1分間保持され、容量が60,000のハーフオープンSAである場合、攻撃者は毎秒1,000のハーフオープンSAを作成する必要があります。 保持時間が3秒に短縮された場合、攻撃者は毎秒20,000のハーフオープンSAを作成して同じ結果を得る必要があります。 パズルを導入することにより、各ハーフオープンSAは攻撃者にとってより高価になり、レスポンダーメモリに対する枯渇攻撃を防ぐ可能性が高くなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
At this point, filling up the half-open SA database is no longer the most efficient DoS attack. The attacker has two alternative attacks to do better:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この時点で、ハーフオープンSAデータベースをいっぱいにすることは、もはや最も効率的なDoS攻撃ではありません。 攻撃者には、より効果的な2つの代替攻撃があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. Go back to spoofed addresses and try to overwhelm the CPU that deals with generating cookies, or
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1.スプーフィングされたアドレスに戻り、Cookieの生成を処理するCPUを圧倒しようとします。または
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. Take the attack to the next level by also sending an IKE_AUTH request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. IKE_AUTHリクエストも送信して、攻撃を次のレベルに進めます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If an attacker is so powerful that it is able to overwhelm the Responder&#39;s CPU that deals with generating cookies, then the attack cannot be dealt with at the IKE level and must be handled by means of the Intrusion Prevention System (IPS) technology.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
攻撃者が非常に強力で、Cookieの生成を処理するレスポンダーのCPUを圧倒できる場合、攻撃はIKEレベルで処理できず、侵入防止システム（IPS）テクノロジーを使用して処理する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
On the other hand, the second alternative of sending an IKE_AUTH request is very cheap. It requires generating a proper IKE header with the correct IKE SPIs and a single Encrypted payload. The content of the payload is irrelevant and might be junk. The Responder has to perform the relatively expensive key derivation, only to find that the Message Authentication Code (MAC) on the Encrypted payload on the IKE_AUTH request fails the integrity check. If a Responder does not hold on to the calculated SKEYSEED and SK_* keys (which it should in case a valid IKE_AUTH comes in later), this attack might be repeated on the same half-open SA. Puzzles make attacks of such sort more costly for an attacker. See Section 7.2 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
一方、IKE_AUTHリクエストを送信する2番目の方法は非常に安価です。 正しいIKE SPIと単一の暗号化されたペイロードを持つ適切なIKEヘッダーを生成する必要があります。 ペイロードの内容は無関係であり、ジャンクになる可能性があります。 レスポンダーは、IKE_AUTH要求の暗号化されたペイロードのメッセージ認証コード（MAC）が整合性チェックに失敗したことを見つけるためにのみ、比較的高価なキー派生を実行する必要があります。 レスポンダーが計算されたSKEYSEEDおよびSK_ *キーを保持しない場合（有効なIKE_AUTHが後で入った場合に備えて）、この攻撃は同じハーフオープンSAで繰り返される可能性があります。 パズルは、攻撃者にとってこの種の攻撃をより高価にします。 詳細については、セクション7.2を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Here too, the number of half-open SAs that the attacker can achieve is crucial, because each one allows the attacker to waste some CPU time. So making it hard to make many half-open SAs is important.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ここでも、攻撃者がCPU時間を浪費する可能性があるため、攻撃者が達成できるハーフオープンSAの数が重要です。 したがって、多くのハーフオープンSAを作成するのを難しくすることが重要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A strategy against DDoS has to rely on at least 4 components:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
DDoSに対する戦略は、少なくとも4つのコンポーネントに依存する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. Hardening the half-open SA database by reducing retention time.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1.保持時間を短縮して、ハーフオープンSAデータベースを強化します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. Hardening the half-open SA database by rate-limiting single IPs/ prefixes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2.単一のIP /プレフィックスをレート制限することにより、ハーフオープンSAデータベースを強化します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
3. Guidance on what to do when an IKE_AUTH request fails to decrypt.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
3. IKE_AUTH要求が復号化に失敗した場合の対処方法に関するガイダンス。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
4. Increasing the cost of half-open SAs up to what is tolerable for legitimate clients.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
4.ハーフオープンSAのコストを、正当なクライアントが許容できるレベルまで増やす。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Puzzles are used as a solution for strategy #4.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルは、戦略＃4のソリューションとして使用されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. Defense Measures While the IKE SA Is Being Created
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. IKE SAが作成されている間の防衛手段
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.1. Retention Periods for Half-Open SAs
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.1。 ハーフオープンSAの保持期間
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
As a UDP-based protocol, IKEv2 has to deal with packet loss through retransmissions. Section 2.4 of [RFC7296] recommends &#34;that messages be retransmitted at least a dozen times over a period of at least several minutes before giving up.&#34; Many retransmission policies in practice wait one or two seconds before retransmitting for the first time.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
UDPベースのプロトコルとして、IKEv2は再送信によるパケット損失に対処する必要があります。 [RFC7296]のセクション2.4は、「あきらめる前に、少なくとも数分間、メッセージを少なくとも数十回再送信すること」を推奨しています。 実際の再送信ポリシーの多くは、最初に再送信する前に1〜2秒待機します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Because of this, setting the timeout on a half-open SA too low will cause it to expire whenever even one IKE_AUTH request packet is lost. When not under attack, the half-open SA timeout SHOULD be set high enough that the Initiator will have enough time to send multiple retransmissions, minimizing the chance of transient network congestion causing an IKE failure.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このため、ハーフオープンSAのタイムアウトの設定が低すぎると、IKE_AUTH要求パケットが1つでも失われた場合にタイムアウトになります。 攻撃を受けていない場合、ハーフオープンSAタイムアウトは、イニシエーターが複数の再送信を送信するのに十分な時間を確保できるように十分に高く設定する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When the system is under attack, as measured by the amount of half-open SAs, it makes sense to reduce this lifetime. The Responder should still allow enough time for the round-trip, for the Initiator to derive the DH shared value, and to derive the IKE SA keys and create the IKE_AUTH request. Two seconds is probably as low a value as can realistically be used.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ハーフオープンSAの量で測定されるように、システムが攻撃を受けている場合、この寿命を短くすることは理にかなっています。 レスポンダーは、ラウンドトリップ、イニシエーターがDH共有値を取得し、IKE SAキーを取得してIKE_AUTH要求を作成するのに十分な時間を許可する必要があります。 2秒は、おそらく現実的に使用できる値と同じくらい低い値です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
It could make sense to assign a shorter value to half-open SAs originating from IP addresses or prefixes that are considered suspect because of multiple concurrent half-open SAs.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
複数の同時ハーフオープンSAが原因で疑わしいと考えられるIPアドレスまたはプレフィックスから発信されるハーフオープンSAに、より短い値を割り当てることは理にかなっています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.2. Rate Limiting
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.2。 レート制限
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Even with DDoS, the attacker has only a limited amount of nodes participating in the attack. By limiting the amount of half-open SAs that are allowed to exist concurrently with each such node, the total amount of half-open SAs is capped, as is the total amount of key derivations that the Responder is forced to complete.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
DDoSを使用しても、攻撃者が攻撃に参加できるノードの数は限られています。 そのような各ノードと同時に存在することができるハーフオープンSAの量を制限することにより、レスポンダーが完了を強制されるキー派生の合計量と同様に、ハーフオープンSAの合計量が制限されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In IPv4, it makes sense to limit the number of half-open SAs based on IP address. Most IPv4 nodes are either directly attached to the Internet using a routable address or hidden behind a NAT device with a single IPv4 external address. For IPv6, ISPs assign between a /48 and a /64, so it does not make sense for rate limiting to work on single IPv6 IPs. Instead, rate limits should be done based on either the /48 or /64 of the misbehaving IPv6 address observed.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IPv4では、IPアドレスに基づいてハーフオープンSAの数を制限することは理にかなっています。 ほとんどのIPv4ノードは、ルーティング可能なアドレスを使用してインターネットに直接接続されるか、単一のIPv4外部アドレスを持つNATデバイスの背後に隠されます。 IPv6の場合、ISPは/ 48〜/ 64を割り当てるため、レート制限が単一のIPv6 IPで機能することは意味がありません。 代わりに、監視されている不正なIPv6アドレスの/ 48または/ 64に基づいてレート制限を行う必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The number of half-open SAs is easy to measure, but it is also worthwhile to measure the number of failed IKE_AUTH exchanges. If possible, both factors should be taken into account when deciding which IP address or prefix is considered suspicious.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ハーフオープンSAの数は簡単に測定できますが、失敗したIKE_AUTH交換の数を測定することも価値があります。 可能であれば、どちらのIPアドレスまたはプレフィックスが疑わしいと見なされるかを決定する際に、両方の要因を考慮する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
There are two ways to rate limit a peer address or prefix:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ピアアドレスまたはプレフィックスのレート制限には2つの方法があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. Hard Limit -- where the number of half-open SAs is capped, and any further IKE_SA_INIT requests are rejected.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1.ハード制限-ハーフオープンSAの数に上限があり、それ以上のIKE_SA_INIT要求は拒否されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. Soft Limit -- where if a set number of half-open SAs exist for a particular address or prefix, any IKE_SA_INIT request will be required to solve a puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2.ソフト制限-特定のアドレスまたはプレフィックスに対して設定された数のハーフオープンSAが存在する場合、パズルを解決するにはIKE_SA_INIT要求が必要になります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The advantage of the hard limit method is that it provides a hard cap on the amount of half-open SAs that the attacker is able to create. The disadvantage is that it allows the attacker to block IKE initiation from small parts of the Internet. For example, if a network service provider or some establishment offers Internet connectivity to its customers or employees through an IPv4 NAT device, a single malicious customer can create enough half-open SAs to fill the quota for the NAT device external IP address. Legitimate Initiators on the same network will not be able to initiate IKE.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ハードリミット方式の利点は、攻撃者が作成できるハーフオープンSAの量にハードキャップを提供することです。 欠点は、攻撃者がインターネットの小さな部分からのIKE開始をブロックできることです。 たとえば、ネットワークサービスプロバイダーまたはある施設がIPv4 NATデバイスを介して顧客または従業員にインターネット接続を提供している場合、1人の悪意のある顧客は、NATデバイスの外部IPアドレスのクォータを満たすのに十分なハーフオープンSAを作成できます。 同じネットワーク上の正当なイニシエーターは、IKEを開始できません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The advantage of a soft limit is that legitimate clients can always connect. The disadvantage is that an adversary with sufficient CPU resources can still effectively DoS the Responder.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ソフト制限の利点は、正当なクライアントが常に接続できることです。 欠点は、十分なCPUリソースを持つ敵が、レスポンダーを効果的にDoSできることです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Regardless of the type of rate limiting used, legitimate Initiators that are not on the same network segments as the attackers will not be affected. This is very important as it reduces the adverse impact caused by the measures used to counteract the attack and allows most Initiators to keep working even if they do not support puzzles.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
使用されるレート制限のタイプに関係なく、攻撃者と同じネットワークセグメント上にない正当なイニシエーターは影響を受けません。 これは、攻撃に対抗するために使用される手段によって引き起こされる悪影響を軽減し、パズルをサポートしていなくてもほとんどのイニシエーターが動作し続けることができるため、非常に重要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3. The Stateless Cookie
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.3。 ステートレスCookie
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Section 2.6 of [RFC7296] offers a mechanism to mitigate DoS attacks: the stateless cookie. When the server is under load, the Responder responds to the IKE_SA_INIT request with a calculated &#34;stateless cookie&#34; -- a value that can be recalculated based on values in the IKE_SA_INIT request without storing Responder-side state. The Initiator is expected to repeat the IKE_SA_INIT request, this time including the stateless cookie. This mechanism prevents DoS attacks from spoofed IP addresses, since an attacker needs to have a routable IP address to return the cookie.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]のセクション2.6は、DoS攻撃を軽減するメカニズム、ステートレスCookieを提供します。 サーバーに負荷がかかっている場合、レスポンダーは、計算された「ステートレスCookie」でIKE_SA_INIT要求に応答します。この値は、レスポンダー側の状態を保存せずにIKE_SA_INIT要求の値に基づいて再計算できます。 イニシエーターはIKE_SA_INIT要求を繰り返すことが期待されますが、今回はステートレスCookieが含まれます。 このメカニズムは、スプーフィングされたIPアドレスからのDoS攻撃を防ぎます。これは、攻撃者がCookieを返すためにルーティング可能なIPアドレスを持っている必要があるためです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Attackers that have multiple source IP addresses with return routability, such as in the case of botnets, can fill up a half-open SA table anyway. The cookie mechanism limits the amount of allocated state to the number of attackers, multiplied by the number of half-open SAs allowed per peer address, multiplied by the amount of state allocated for each half-open SA. With typical values, this can easily reach hundreds of megabytes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ボットネットの場合など、リターンルーティングが可能な複数のソースIPアドレスを持つ攻撃者は、とにかくハーフオープンSAテーブルを埋めることができます。 Cookieメカニズムは、割り当てられた状態の量を、攻撃者の数に、ピアアドレスごとに許可されるハーフオープンSAの数、各ハーフオープンSAに割り当てられた状態の量を掛けた数に制限します。 通常の値では、これは数百メガバイトに達する可能性があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.4. Puzzles
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.4。 パズル
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The puzzle introduced here extends the cookie mechanism of [RFC7296]. It is loosely based on the proof-of-work technique used in Bitcoin [BITCOINS]. Puzzles set an upper bound, determined by the attacker&#39;s CPU, to the number of negotiations the attacker can initiate in a unit of time.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
ここで紹介するパズルは、[RFC7296]のCookieメカニズムを拡張します。 Bitcoin [BITCOINS]で使用されているPoCテクニックに大まかに基づいています。 パズルは、攻撃者のCPUによって決定される上限を、攻撃者が時間単位で開始できるネゴシエーションの数に設定します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A puzzle is sent to the Initiator in two cases:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
次の2つの場合、パズルがイニシエーターに送信されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The Responder is so overloaded that no half-open SAs may be created without solving a puzzle, or
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oレスポンダーの負荷が非常に高いため、パズルを解かない限りハーフオープンSAを作成できない
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The Responder is not too loaded, but the rate-limiting method described in Section 4.2 prevents half-open SAs from being created with this particular peer address or prefix without first solving a puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oレスポンダーの負荷は高くありませんが、セクション4.2で説明したレート制限方法は、パズルを解くことなく、この特定のピアアドレスまたはプレフィックスでハーフオープンSAが作成されるのを防ぎます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When the Responder decides to send the challenge to solve a puzzle in response to an IKE_SA_INIT request, the message includes at least three components:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがIKE_SA_INIT要求への応答としてパズルを解くためにチャレンジを送信することを決定すると、メッセージには少なくとも3つのコンポーネントが含まれます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. Cookie -- this is calculated the same as in [RFC7296], i.e., the process of generating the cookie is not specified.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. Cookie-[RFC7296]と同じように計算されます。つまり、Cookieの生成プロセスは指定されていません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. Algorithm, this is the identifier of a Pseudorandom Function (PRF) algorithm, one of those proposed by the Initiator in the SA payload.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2.アルゴリズム。これは、SAペイロード内のイニシエーターによって提案されたものの1つである、疑似ランダム関数（PRF）アルゴリズムの識別子です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
3. Zero-Bit Count (ZBC). This is a number between 8 and 255 (or a special value - 0; see Section 7.1.1.1) that represents the length of the zero-bit run at the end of the output of the PRF function calculated over the cookie that the Initiator is to send. The values 1-8 are explicitly excluded, because they create a puzzle that is too easy to solve. Since the mechanism is supposed to be stateless for the Responder, either the same ZBC is used for all Initiators or the ZBC is somehow encoded in the cookie. If it is global, then it means that this value is the same for all the Initiators who are receiving puzzles at any given point of time. The Responder, however, may change this value over time depending on its load.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
3.ゼロビットカウント（ZBC）。 これは8〜255の数値（または特別な値-0。セクション7.1.1.1を参照）で、イニシエーターがCookieに対して計算したPRF関数の出力の最後で実行されるゼロビットの長さを表します 送信します。 1〜8の値は、簡単に解決できないパズルを作成するため、明示的に除外されます。 メカニズムはレスポンダーに対してステートレスであると想定されているため、すべてのイニシエーターに同じZBCが使用されるか、ZBCが何らかの方法でCookieにエンコードされます。 グローバルな場合、この値は、特定の時点でパズルを受け取っているすべてのイニシエーターで同じであることを意味します。 ただし、レスポンダーは、負荷に応じてこの値を経時的に変更する場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Upon receiving this challenge, the Initiator attempts to calculate the PRF output using different keys. When enough keys are found such that the resulting PRF output calculated using each of them has a sufficient number of trailing zero bits, that result is sent to the Responder.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このチャレンジを受信すると、イニシエーターは異なるキーを使用してPRF出力を計算しようとします。 それぞれのキーを使用して計算された結果のPRF出力に十分な数の後続ゼロビットがあるように十分なキーが見つかると、その結果がレスポンダーに送信されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The reason for using several keys in the results, rather than just one key, is to reduce the variance in the time it takes the Initiator to solve the puzzle. We have chosen the number of keys to be four (4) as a compromise between the conflicting goals of reducing variance and reducing the work the Responder needs to perform to verify the puzzle solution.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
結果で1つのキーだけでなく複数のキーを使用する理由は、イニシエーターがパズルを解くのにかかる時間のばらつきを減らすためです。 キーの数は、分散を減らすという矛盾する目標とパズルの解を検証するためにレスポンダーが実行する必要のある作業を減らすという妥協点として4つに選択しました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When receiving a request with a solved puzzle, the Responder verifies two things:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルを解決したリクエストを受信すると、レスポンダーは次の2つのことを確認します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o That the cookie is indeed valid.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Cookieが実際に有効であること。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o That the results of PRF of the transmitted cookie calculated with the transmitted keys has a sufficient number of trailing zero bits.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o送信されたキーで計算された送信されたCookieのPRFの結果に、十分な数の後続ゼロビットがあること。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Example 1: Suppose the calculated cookie is 739ae7492d8a810cf5e8dc0f9626c9dda773c5a3 (20 octets), the algorithm is PRF-HMAC-SHA256, and the required number of zero bits is 18. After successively trying a bunch of keys, the Initiator finds the following four 3-octet keys that work:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
例1：計算されたCookieが739ae7492d8a810cf5e8dc0f9626c9dda773c5a3（20オクテット）であり、アルゴリズムがPRF-HMAC-SHA256であり、ゼロビットの必要数が18であると仮定すると、イニシエーターは次の4つの3オクテットを見つけます 動作するキー：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
      +--------+----------------------------------+----------------+
      |  Key   | Last 32 Hex PRF Digits           | # of Zero Bits |
      +--------+----------------------------------+----------------+
      | 061840 | e4f957b859d7fb1343b7b94a816c0000 |       18       |
      | 073324 | 0d4233d6278c96e3369227a075800000 |       23       |
      | 0c8a2a | 952a35d39d5ba06709da43af40700000 |       20       |
      | 0d94c8 | 5a0452b21571e401a3d00803679c0000 |       18       |
      +--------+----------------------------------+----------------+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Table 1: Four Solutions for the 18-Bit Puzzle
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
表1：18ビットパズルの4つのソリューション
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Example 2: Same cookie, but modify the required number of zero bits to 22. The first 4-octet keys that work to satisfy that requirement are 005d9e57, 010d8959, 0110778d, and 01187e37. Finding these requires 18,382,392 invocations of the PRF.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
例2：Cookieは同じですが、必要なゼロビット数を22に変更します。その要件を満たすために機能する最初の4オクテットキーは、005d9e57、010d8959、0110778d、および01187e37です。 これらを見つけるには、PRFの18,382,392回の呼び出しが必要です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
            +----------------+-------------------------------+
            | # of Zero Bits | Time to Find 4 Keys (Seconds) |
            +----------------+-------------------------------+
            |       8        |                        0.0025 |
            |       10       |                        0.0078 |
            |       12       |                        0.0530 |
            |       14       |                        0.2521 |
            |       16       |                        0.8504 |
            |       17       |                        1.5938 |
            |       18       |                        3.3842 |
            |       19       |                        3.8592 |
            |       20       |                       10.8876 |
            +----------------+-------------------------------+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Table 2: The Time Needed to Solve a Puzzle of Various Difficulty for the Cookie 39ae7492d8a810cf5e8dc0f9626c9dda773c5a3
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
表2：Cookie 39ae7492d8a810cf5e8dc0f9626c9dda773c5a3のさまざまな難易度のパズルを解くのに必要な時間
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The figures above were obtained on a 2.4 GHz single-core Intel i5 processor in a 2013 Apple MacBook Pro. Run times can be halved or quartered with multi-core code, but they would be longer on mobile phone processors, even if those are multi-core as well. With these figures, 18 bits is believed to be a reasonable choice for puzzle level difficulty for all Initiators, and 20 bits is acceptable for specific hosts/prefixes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
上記の数値は、2013 Apple MacBook Proの2.4 GHzシングルコアIntel i5プロセッサーで取得されたものです。 実行時間は、マルチコアコードを使用して半分または4分の1にできますが、携帯電話のプロセッサでは、マルチコアでも同様に長くなります。 これらの図では、18ビットがすべてのイニシエーターのパズルレベルの難易度の合理的な選択であると考えられ、20ビットは特定のホスト/プレフィックスに受け入れられます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Using the puzzles mechanism in the IKE_SA_INIT exchange is described in Section 7.1.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INIT交換でパズルメカニズムを使用する方法については、セクション7.1で説明しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.5. Session Resumption
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.5。 セッション再開
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When the Responder is under attack, it SHOULD prefer previously authenticated peers who present a Session Resumption ticket [RFC5723]. However, the Responder SHOULD NOT serve resumed Initiators exclusively because dropping all IKE_SA_INIT requests would lock out legitimate Initiators that have no resumption ticket. When under attack, the Responder SHOULD require Initiators presenting Session Resumption tickets to pass a return routability check by including the COOKIE notification in the IKE_SESSION_RESUME response message, as described in Section 4.3.2. of [RFC5723]. Note that the Responder SHOULD cache tickets for a short time to reject reused tickets (Section 4.3.1 of [RFC5723]); therefore, there should be no issue of half-open SAs resulting from replayed IKE_SESSION_RESUME messages.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Responderが攻撃を受けている場合、セッション再開チケット[RFC5723]を提示する以前に認証されたピアを優先する必要があります。 ただし、すべてのIKE_SA_INIT要求をドロップすると再開チケットのない正当なイニシエーターがロックアウトされるため、レスポンダーは再開されたイニシエーターのみを提供するべきではありません。 攻撃を受けている場合、Responderは、セクション4.3.2で説明されているように、IKE_SESSION_RESUME応答メッセージにCOOKIE通知を含めることにより、セッション再開チケットを提示するイニシエーターがリターンルーティング可能性チェックに合格する必要があります。 [RFC5723]の。 レスポンダは、再利用されたチケットを拒否するためにチケットを短時間キャッシュする必要があります（[RFC5723]のセクション4.3.1）。 したがって、再生されたIKE_SESSION_RESUMEメッセージに起因するハーフオープンSAの問題はないはずです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Several kinds of DoS attacks are possible on servers supported by IKE Session Resumption. See Section 9.3 of [RFC5723] for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEセッション再開によってサポートされるサーバーでは、いくつかの種類のDoS攻撃が可能です。 詳細については、[RFC5723]のセクション9.3を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.6. Keeping Computed Shared Keys
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.6。 計算された共有キーの保持
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Once the IKE_SA_INIT exchange is finished, the Responder is waiting for the first message of the IKE_AUTH exchange from the Initiator. At this point, the Initiator is not yet authenticated, and this fact allows an attacker to perform an attack, described in Section 3. Instead of sending a properly formed and encrypted IKE_AUTH message, the attacker can just send arbitrary data, forcing the Responder to perform costly CPU operations to compute SK_* keys.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INIT交換が完了すると、レスポンダーはイニシエーターからのIKE_AUTH交換の最初のメッセージを待っています。 この時点で、イニシエーターはまだ認証されておらず、この事実により、攻撃者はセクション3で説明する攻撃を実行できます。正しく形成され暗号化されたIKE_AUTHメッセージを送信する代わりに、攻撃者は任意のデータを送信して、レスポンダーに 高価なCPU操作を実行してSK_ *キーを計算します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the received IKE_AUTH message failed to decrypt correctly (or failed to pass the Integrity Check Value (ICV) check), then the Responder SHOULD still keep the computed SK_* keys, so that if it happened to be an attack, then an attacker cannot get an advantage of repeating the attack multiple times on a single IKE SA. The Responder can also use puzzles in the IKE_AUTH exchange as described in Section 7.2.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
受信したIKE_AUTHメッセージが正しく復号化できなかった場合（または整合性チェック値（ICV）チェックに合格しなかった場合）、レスポンダーは計算されたSK_ *キーを保持する必要があるため、攻撃が発生した場合、攻撃者は 単一のIKE SAで攻撃を複数回繰り返すという利点があります。 レスポンダーは、セクション7.2で説明されているように、IKE_AUTH交換でパズルを使用することもできます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.7. Preventing &#34;Hash and URL&#34; Certificate Encoding Attacks
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.7。 「ハッシュおよびURL」証明書エンコード攻撃の防止
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In IKEv2, each side may use the &#34;Hash and URL&#34; Certificate Encoding to instruct the peer to retrieve certificates from the specified location (see Section 3.6 of [RFC7296] for details). Malicious Initiators can use this feature to mount a DoS attack on the Responder by providing a URL pointing to a large file possibly containing meaningless bits. While downloading the file, the Responder consumes CPU, memory, and network bandwidth.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEv2では、各サイドは「ハッシュおよびURL」証明書エンコーディングを使用して、指定された場所から証明書を取得するようピアに指示することができます（詳細については[RFC7296]のセクション3.6を参照）。 悪意のあるイニシエーターは、この機能を使用して、無意味なビットを含む可能性のある大きなファイルを指すURLを提供することにより、レスポンダーにDoS攻撃を仕掛けることができます。 ファイルのダウンロード中、レスポンダーはCPU、メモリ、およびネットワーク帯域幅を消費します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To prevent this kind of attack, the Responder should not blindly download the whole file. Instead, it SHOULD first read the initial few bytes, decode the length of the ASN.1 structure from these bytes, and then download no more than the decoded number of bytes. Note that it is always possible to determine the length of ASN.1 structures used in IKEv2, if they are DER-encoded, by analyzing the first few bytes. However, since the content of the file being downloaded can be under the attacker&#39;s control, implementations should not blindly trust the decoded length and SHOULD check whether it makes sense before continuing to download the file. Implementations SHOULD also apply a configurable hard limit to the number of pulled bytes and SHOULD provide an ability for an administrator to either completely disable this feature or limit its use to a configurable list of trusted URLs.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この種の攻撃を防ぐために、レスポンダーは盲目的にファイル全体をダウンロードしないでください。 代わりに、最初に最初の数バイトを読み取り、これらのバイトからASN.1構造の長さをデコードしてから、デコードされたバイト数以下をダウンロードする必要があります。 最初の数バイトを分析することによって、DERエンコードされている場合、IKEv2で使用されるASN.1構造の長さを常に判断できることに注意してください。 ただし、ダウンロードされるファイルのコンテンツは攻撃者の制御下にある可能性があるため、実装はデコードされた長さを盲目的に信頼してはならず、ファイルのダウンロードを続行する前に意味があるかどうかを確認する必要があります 実装は、プルされたバイト数に設定可能なハード制限を適用する必要があり（SHOULD）、管理者がこの機能を完全に無効にするか、信頼できるURLの設定可能なリストに使用を制限する機能を提供する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.8. IKE Fragmentation
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.8。 IKEフラグメンテーション
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE fragmentation described in [RFC7383] allows IKE peers to avoid IP fragmentation of large IKE messages. Attackers can mount several kinds of DoS attacks using IKE fragmentation. See Section 5 of [RFC7383] for details on how to mitigate these attacks.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7383]で説明されているIKEフラグメンテーションにより、IKEピアは大きなIKEメッセージのIPフラグメンテーションを回避できます。 攻撃者は、IKEフラグメンテーションを使用して、数種類のDoS攻撃を仕掛けることができます。 これらの攻撃を軽減する方法の詳細については、[RFC7383]のセクション5を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5. Defense Measures after an IKE SA Is Created
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5. IKE SAが作成された後の防衛手段
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Once an IKE SA is created, there is usually only a limited amount of IKE messages exchanged. This IKE traffic consists of exchanges aimed to create additional Child SAs, IKE rekeys, IKE deletions, and IKE liveness tests. Some of these exchanges require relatively little resources (like a liveness check), while others may be resource consuming (like creating or rekeying a Child SA with DH exchange).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE SAが作成されると、通常、交換されるIKEメッセージの量は限られています。 このIKEトラフィックは、追加の子SA、IKEキー再生成、IKE削除、IKE活性テストの作成を目的とした交換で構成されます。 これらの交換の一部は、比較的少ないリソース（活性チェックなど）を必要としますが、他のリソースはリソースを消費する場合があります（DH交換で子SAを作成またはキー再生成するなど）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Since any endpoint can initiate a new exchange, there is a possibility that a peer would initiate too many exchanges that could exhaust host resources. For example, the peer can perform endless continuous Child SA rekeying or create an overwhelming number of Child SAs with the same Traffic Selectors, etc. Such behavior can be caused by broken implementations, misconfiguration, or as an intentional attack. The latter becomes more of a real threat if the peer uses NULL Authentication, as described in [RFC7619]. In this case, the peer remains anonymous, allowing it to escape any responsibility for its behavior. See Section 3 of [RFC7619] for details on how to mitigate attacks when using NULL Authentication.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
エンドポイントは新しい交換を開始できるため、ピアがホストリソースを使い果たす可能性のある交換をあまりにも多く開始する可能性があります。 たとえば、ピアは無限の継続的な子SAのキー再生成を実行したり、同じトラフィックセレクターなどで圧倒的な数の子SAを作成したりできます。このような動作は、実装の失敗、設定ミス、または意図的な攻撃として発生する可能性があります。 [RFC7619]で説明されているように、ピアがNULL認証を使用する場合、後者はより大きな脅威になります。 この場合、ピアは匿名のままであり、ピアの動作に対する責任を免れることができます。 NULL認証の使用時に攻撃を緩和する方法の詳細については、[RFC7619]のセクション3を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The following recommendations apply especially for NULL-authenticated IKE sessions, but also apply to authenticated IKE sessions, with the difference that in the latter case, the identified peer can be locked out.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
以下の推奨事項は、特にNULL認証されたIKEセッションに適用されますが、認証されたIKEセッションにも適用されます。後者の場合、識別されたピアをロックアウトできるという違いがあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o If the IKEv2 window size is greater than one, peers are able to initiate multiple simultaneous exchanges that increase host resource consumption. Since there is no way in IKEv2 to decrease window size once it has been increased (see Section 2.3 of [RFC7296]), the window size cannot be dynamically adjusted depending on the load. It is NOT RECOMMENDED to allow an IKEv2 window size greater than one when NULL Authentication has been used.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o IKEv2ウィンドウサイズが1より大きい場合、ピアはホストリソースの消費を増やす複数の同時交換を開始できます。 IKEv2では、ウィンドウサイズを一度大きくすると（[RFC7296]のセクション2.3を参照）小さくする方法がないため、負荷に応じてウィンドウサイズを動的に調整できません。 NULL認証が使用されている場合、IKEv2ウィンドウサイズを1より大きくすることはお勧めしません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o If a peer initiates an abusive amount of CREATE_CHILD_SA exchanges to rekey IKE SAs or Child SAs, the Responder SHOULD reply with TEMPORARY_FAILURE notifications indicating the peer must slow down their requests.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oピアが不正な量のCREATE_CHILD_SA交換を開始してIKE SAまたは子SAのキーを再生成する場合、レスポンダーは、ピアが要求をスローダウンする必要があることを示すTEMPORARY_FAILURE通知で応答する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o If a peer creates many Child SAs with the same or overlapping Traffic Selectors, implementations MAY respond with the NO_ADDITIONAL_SAS notification.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oピアが同じまたは重複するトラフィックセレクタで多くの子SAを作成する場合、実装はNO_ADDITIONAL_SAS通知で応答する場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o If a peer initiates many exchanges of any kind, the Responder MAY introduce an artificial delay before responding to each request message. This delay would decrease the rate the Responder needs to process requests from any particular peer and frees up resources on the Responder that can be used for answering legitimate clients. If the Responder receives retransmissions of the request message during the delay period, the retransmitted messages MUST be silently discarded. The delay must be short enough to avoid legitimate peers deleting the IKE SA due to a timeout. It is believed that a few seconds is enough. Note, however, that even a few seconds may be too long when settings rely on an immediate response to the request message, e.g., for the purposes of quick detection of a dead peer.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oピアがあらゆる種類の交換を多数開始する場合、レスポンダーは各要求メッセージに応答する前に人為的な遅延を導入する場合があります。 この遅延により、レスポンダーが特定のピアからの要求を処理するのに必要な速度が低下し、正当なクライアントへの応答に使用できるレスポンダーのリソースが解放されます。 Responderが遅延期間中に要求メッセージの再送信を受信した場合、再送信されたメッセージは静かに破棄されなければなりません。 遅延は、正当なピアがタイムアウトのためにIKE SAを削除しないように十分に短くする必要があります。 数秒で十分であると考えられています。 ただし、たとえば、死んだピアをすばやく検出するために、設定が要求メッセージへの即時応答に依存している場合、数秒でも長すぎる場合があることに注意してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o If these countermeasures are inefficient, implementations MAY delete the IKE SA with an offending peer by sending Delete Payload.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oこれらの対策が非効率的な場合、実装はDelete Payloadを送信することにより、攻撃ピアとのIKE SAを削除してもよい（MAY）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In IKE, a client can request various configuration attributes from the server. Most often, these attributes include internal IP addresses. Malicious clients can try to exhaust a server&#39;s IP address pool by continuously requesting a large number of internal addresses. Server implementations SHOULD limit the number of IP addresses allocated to any particular client. Note, this is not possible with clients using NULL Authentication, since their identity cannot be verified.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEでは、クライアントはサーバーにさまざまな構成属性を要求できます。 ほとんどの場合、これらの属性には内部IPアドレスが含まれます。 悪意のあるクライアントは、多数の内部アドレスを継続的に要求することにより、サーバーのIPアドレスプールを使い果たすことを試みることができます。 サーバー実装は、特定のクライアントに割り当てられるIPアドレスの数を制限する必要があります。 NULL認証を使用するクライアントでは、IDを確認できないため、これは不可能です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6. Plan for Defending a Responder
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6.応答者の防御計画
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This section outlines a plan for defending a Responder from a DDoS attack based on the techniques described earlier. The numbers given here are not normative, and their purpose is to illustrate the configurable parameters needed for surviving DDoS attacks.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このセクションでは、前述の手法に基づいて、DDoS攻撃からレスポンダーを防御する計画の概要を説明します。 ここに記載されている数値は規範的なものではなく、その目的は、DDoS攻撃を生き抜くために必要な構成可能なパラメーターを示すことです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Implementations are deployed in different environments, so it is RECOMMENDED that the parameters be settable. For example, most commercial products are required to undergo benchmarking where the IKE SA establishment rate is measured. Benchmarking is indistinguishable from a DoS attack, and the defenses described in this document may defeat the benchmark by causing exchanges to fail or to take a long time to complete. Parameters SHOULD be tunable to allow for benchmarking (if only by turning DDoS protection off).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
実装はさまざまな環境にデプロイされるため、パラメータを設定可能にすることをお勧めします。 たとえば、ほとんどの商用製品は、IKE SAの確立率を測定するベンチマークを実施する必要があります。 ベンチマークはDoS攻撃と見分けがつかないため、このドキュメントで説明する防御策は、交換が失敗したり、完了するまでに長い時間がかかったりすることでベンチマークを打ち負かす可能性があります。 パラメーターは、ベンチマークを可能にするために調整可能にする必要があります（DDoS保護をオフにする場合のみ）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Since all countermeasures may cause delays and additional work for the Initiators, they SHOULD NOT be deployed unless an attack is likely to be in progress. To minimize the burden imposed on Initiators, the Responder should monitor incoming IKE requests for two scenarios:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
すべての対策がイニシエーターに遅延と追加作業を引き起こす可能性があるため、攻撃が進行する可能性が高い場合を除き、それらは展開されるべきではありません。 イニシエーターにかかる負担を最小限に抑えるために、レスポンダーは次の2つのシナリオで着信IKE要求を監視する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
1. A general DDoS attack. Such an attack is indicated by a high number of concurrent half-open SAs, a high rate of failed IKE_AUTH exchanges, or a combination of both. For example, consider a Responder that has 10,000 distinct peers of which at peak, 7,500 concurrently have VPN tunnels. At the start of peak time, 600 peers might establish tunnels within any given minute, and tunnel establishment (both IKE_SA_INIT and IKE_AUTH) takes anywhere from 0.5 to 2 seconds. For this Responder, we expect there to be less than 20 concurrent half-open SAs, so having 100 concurrent half-open SAs can be interpreted as an indication of an attack. Similarly, IKE_AUTH request decryption failures should never happen. Supposing that the tunnels are established using Extensible Authentication Protocol (EAP) (see Section 2.16 of [RFC7296]), users may be expected to enter a wrong password about 20% of the time. So we&#39;d expect 125 wrong password failures a minute. If we get IKE_AUTH decryption failures from multiple sources more than once per second, or EAP failures more than 300 times per minute, this can also be an indication of a DDoS attack.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
1.一般的なDDoS攻撃。このような攻撃は、多数の同時ハーフオープンSA、高い割合のIKE_AUTH交換の失敗、またはその両方の組み合わせによって示されます。たとえば、ピーク時に7,500個のVPNトンネルを同時に持つ10,000個の個別のピアを持つレスポンダーを考えてみましょう。ピーク時間の開始時に、600ピアが任意の1分以内にトンネルを確立し、トンネルの確立（IKE_SA_INITとIKE_AUTHの両方）は0.5〜2秒かかります。このレスポンダーの場合、20個未満の同時ハーフオープンSAが存在すると予想されるため、100個の同時ハーフオープンSAがあることは、攻撃の兆候として解釈できます。同様に、IKE_AUTH要求の復号化の失敗は決して発生しないはずです。トンネルがExtensible Authentication Protocol（EAP）を使用して確立されたと仮定すると（[RFC7296]のセクション2.16を参照）、ユーザーは約20％の時間に間違ったパスワードを入力することが期待されます。したがって、1分間に125回の誤ったパスワードの失敗が予想されます。複数のソースからIKE_AUTH復号化エラーが1秒間に1回以上、またはEAPエラーが1分間に300回以上発生した場合、これはDDoS攻撃を示している可能性もあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
2. An attack from a particular IP address or prefix. Such an attack is indicated by an inordinate amount of half-open SAs from a specific IP address or prefix, or an inordinate amount of IKE_AUTH failures. A DDoS attack may be viewed as multiple such attacks. If these are mitigated successfully, there will not be a need to enact countermeasures on all Initiators. For example, measures might be 5 concurrent half-open SAs, 1 decrypt failure, or 10 EAP failures within a minute.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
2.特定のIPアドレスまたはプレフィックスからの攻撃。 このような攻撃は、特定のIPアドレスまたはプレフィックスからの大量のハーフオープンSA、または大量のIKE_AUTHの失敗によって示されます。 DDoS攻撃は、このような複数の攻撃と見なされる場合があります。 これらが正常に緩和された場合、すべてのイニシエーターで対策を実施する必要はありません。 たとえば、1分以内に5つの同時ハーフオープンSA、1つの復号化失敗、または10のEAP失敗が測定される場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note that using countermeasures against an attack from a particular IP address may be enough to avoid the overload on the half-open SA database. In this case, the number of failed IKE_AUTH exchanges will never exceed the threshold of attack detection.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
特定のIPアドレスからの攻撃に対する対策を使用すれば、ハーフオープンSAデータベースの過負荷を回避するのに十分な場合があることに注意してください。 この場合、失敗したIKE_AUTH交換の数が攻撃検出のしきい値を超えることはありません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When there is no general DDoS attack, it is suggested that no cookie or puzzles be used. At this point, the only defensive measure is to monitor the number of half-open SAs, and set a soft limit per peer IP or prefix. The soft limit can be set to 3-5. If the puzzles are used, the puzzle difficulty SHOULD be set to such a level (number of zero bits) that all legitimate clients can handle it without degraded user experience.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
一般的なDDoS攻撃がない場合は、Cookieやパズルを使用しないことをお勧めします。 この時点での唯一の防御手段は、ハーフオープンSAの数を監視し、ピアIPまたはプレフィックスごとにソフト制限を設定することです。 ソフト制限は3〜5に設定できます。 パズルを使用する場合、パズルの難易度は、すべての正当なクライアントがユーザーエクスペリエンスを低下させずに処理できるレベル（ゼロビット数）に設定する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
As soon as any kind of attack is detected, either a lot of initiations from multiple sources or a lot of initiations from a few sources, it is best to begin by requiring stateless cookies from all Initiators. This will mitigate attacks based on IP address spoofing and help avoid the need to impose a greater burden in the form of puzzles on the general population of Initiators. This makes the per-node or per-prefix soft limit more effective.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
複数のソースからの多数の開始または少数のソースからの多数の開始のいずれかの種類の攻撃が検出されるとすぐに、すべてのイニシエーターからステートレスCookieを要求することから始めるのが最善です。 これにより、IPアドレスのスプーフィングに基づく攻撃が緩和され、イニシエーターの一般集団にパズルの形で大きな負担をかける必要がなくなります。 これにより、ノードごとまたはプレフィックスごとのソフト制限がより効果的になります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When cookies are activated for all requests and the attacker is still managing to consume too many resources, the Responder MAY start to use puzzles for these requests or increase the difficulty of puzzles imposed on IKE_SA_INIT requests coming from suspicious nodes/ prefixes. This should still be doable by all legitimate peers, but the use of puzzles at a higher difficulty may degrade the user experience, for example, by taking up to 10 seconds to solve the puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cookieがすべてのリクエストに対してアクティブ化され、攻撃者が依然として多くのリソースを消費している場合、レスポンダーはこれらのリクエストにパズルを使用し始めるか、疑わしいノード/プレフィックスからのIKE_SA_INITリクエストに課せられるパズルの難易度を高めます。 これはすべての正当なピアで実行可能ですが、パズルを解くのに最大10秒かかるなど、難易度の高いパズルを使用するとユーザーエクスペリエンスが低下する可能性があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the load on the Responder is still too great, and there are many nodes causing multiple half-open SAs or IKE_AUTH failures, the Responder MAY impose hard limits on those nodes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーの負荷が依然として大きすぎ、複数のハーフオープンSAまたはIKE_AUTH障害を引き起こす多くのノードがある場合、レスポンダーはそれらのノードに強い制限を課すことができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If it turns out that the attack is very widespread and the hard caps are not solving the issue, a puzzle MAY be imposed on all Initiators. Note that this is the last step, and the Responder should avoid this if possible.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
攻撃が非常に広範囲であり、ハードキャップが問題を解決していないことが判明した場合、すべてのイニシエーターにパズルを課すことができます。 これは最後のステップであり、レスポンダーは可能であればこれを避ける必要があることに注意してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7. Using Puzzles in the Protocol
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.プロトコルでパズルを使用する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This section describes how the puzzle mechanism is used in IKEv2. It is organized as follows. Section 7.1 describes using puzzles in the IKE_SA_INIT exchange and Section 7.2 describes using puzzles in the IKE_AUTH exchange. Both sections are divided into subsections describing how puzzles should be presented, solved, and processed by the Initiator and the Responder.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このセクションでは、IKEv2でパズルメカニズムを使用する方法について説明します。 次のように構成されています。 セクション7.1ではIKE_SA_INIT交換でのパズルの使用について説明し、セクション7.2ではIKE_AUTH交換でのパズルの使用について説明します。 両方のセクションは、イニシエーターとレスポンダーがパズルを提示、解決、および処理する方法を説明するサブセクションに分かれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1. Puzzles in IKE_SA_INIT Exchange
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1。 IKE_SA_INIT Exchangeのパズル
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The IKE Initiator indicates the desire to create a new IKE SA by sending an IKE_SA_INIT request message. The message may optionally contain a COOKIE notification if this is a repeated request performed after the Responder&#39;s demand to return a cookie.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEイニシエーターは、IKE_SA_INIT要求メッセージを送信することにより、新しいIKE SAを作成したいことを示します。 Cookieを返すというレスポンダーの要求後に実行される繰り返し要求である場合、メッセージにはオプションでCOOKIE通知が含まれる場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR, [N(COOKIE),] SA, KE, Ni, [V+][N+] --&gt;
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR、[N（COOKIE）、] SA、KE、Ni、[V +] [N +]-&gt;
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Figure 1: Initial IKE_SA_INIT Request
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
図1：最初のIKE_SA_INIT要求
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
According to the plan, described in Section 6, the IKE Responder monitors incoming requests to detect whether it is under attack. If the Responder learns that a DoS or DDoS attack is likely to be in progress, then its actions depend on the volume of the attack. If the volume is moderate, then the Responder requests the Initiator to return a cookie. If the volume is high to such an extent that puzzles need to be used for defense, then the Responder requests the Initiator to solve a puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
セクション6で説明した計画によれば、IKEレスポンダーは着信要求を監視して、攻撃を受けているかどうかを検出します。 レスポンダーがDoSまたはDDoS攻撃が進行中である可能性があることを知った場合、そのアクションは攻撃の量に依存します。 ボリュームが中程度の場合、レスポンダーはイニシエーターにCookieを返すよう要求します。 防御のためにパズルを使用する必要があるほどボリュームが大きい場合、レスポンダーはイニシエーターにパズルの解決を要求します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder MAY choose to process some fraction of IKE_SA_INIT requests without presenting a puzzle while being under attack to allow legacy clients, that don&#39;t support puzzles, to have a chance to be served. The decision whether to process any particular request must be probabilistic, with the probability depending on the Responder&#39;s load (i.e., on the volume of attack). The requests that don&#39;t contain the COOKIE notification MUST NOT participate in this lottery. In other words, the Responder must first perform a return routability check before allowing any legacy client to be served if it is under attack. See Section 7.1.4 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、攻撃を受けている間にパズルを提示せずにIKE_SA_INITリクエストの一部を処理して、パズルをサポートしていないレガシークライアントにサービスを提供することを選択できます。 特定のリクエストを処理するかどうかの決定は確率的である必要があり、その確率はレスポンダーの負荷（つまり、攻撃の量）に依存します。 COOKIE通知を含まないリクエストは、この宝くじに参加してはいけません。 言い換えると、レスポンダーは、攻撃を受けている場合にレガシークライアントにサービスを提供する前に、まずリターンルーティング可能性チェックを実行する必要があります。 詳細については、セクション7.1.4を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1. Presenting a Puzzle
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1。 パズルを提示する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Responder makes a decision to use puzzles, then it includes two notifications in its response message -- the COOKIE notification and the PUZZLE notification. Note that the PUZZLE notification MUST always be accompanied with the COOKIE notification, since the content of the COOKIE notification is used as an input data when solving the puzzle. The format of the PUZZLE notification is described in Section 8.1.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがパズルを使用することを決定した場合、応答メッセージに2つの通知（COOKIE通知とPUZZLE通知）が含まれます。 COOKIE通知の内容はパズルを解くときに入力データとして使用されるため、PUZZLE通知には必ずCOOKIE通知を添付する必要があることに注意してください。 PUZZLE通知の形式については、セクション8.1で説明しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
&lt;-- HDR, N(COOKIE), N(PUZZLE), [V+][N+]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
&lt;-HDR、N（COOKIE）、N（PUZZLE）、[V +] [N +]
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Figure 2: IKE_SA_INIT Response Containing Puzzle
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
図2：パズルを含むIKE_SA_INIT応答
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The presence of these notifications in an IKE_SA_INIT response message indicates to the Initiator that it should solve the puzzle to have a better chance to be served.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INIT応答メッセージにこれらの通知が存在することは、イニシエーターに、パズルを解いてより良い機会を提供する必要があることを示しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.1. Selecting the Puzzle Difficulty Level
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.1。 パズルの難易度を選択する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The PUZZLE notification contains the difficulty level of the puzzle -- the minimum number of trailing zero bits that the result of PRF must contain. In diverse environments, it is nearly impossible for the Responder to set any specific difficulty level that will result in roughly the same amount of work for all Initiators, because computation power of different Initiators may vary by an order of magnitude, or even more. The Responder may set the difficulty level to 0, meaning that the Initiator is requested to spend as much power to solve a puzzle as it can afford. In this case, no specific value of ZBC is required from the Initiator; however, the larger the ZBC that the Initiator is able to get, the better the chance is that it will be served by the Responder. In diverse environments, it is RECOMMENDED that the Initiator set the difficulty level to 0, unless the attack volume is very high.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
PUZZLE通知には、パズルの難易度、つまりPRFの結果に含まれる必要がある後続ゼロビットの最小数が含まれます。 多様な環境では、レスポンダーが特定の難易度を設定することはほぼ不可能です。これにより、すべてのイニシエーターに対してほぼ同じ量の作業が行われます。異なるイニシエーターの計算能力は、桁違いに、またはさらに大きくなる可能性があるためです。 レスポンダーは難易度を0に設定できます。つまり、イニシエーターは、パズルを解決するために、できるだけ多くの力を費やすように要求されます。 この場合、イニシエーターからZBCの特定の値は必要ありません。 ただし、イニシエーターが取得できるZBCが大きいほど、レスポンダーがサービスを提供する可能性が高くなります。 多様な環境では、攻撃量が非常に大きい場合を除き、イニシエーターが難易度を0に設定することが推奨されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Responder sets a non-zero difficulty level, then the level SHOULD be determined by analyzing the volume of the attack. The Responder MAY set different difficulty levels to different requests depending on the IP address the request has come from.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがゼロ以外の難易度レベルを設定している場合、攻撃の量を分析することでレベルを決定する必要があります。 レスポンダーは、リクエストの送信元のIPアドレスに応じて、異なるリクエストに異なる難易度を設定できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.2. Selecting the Puzzle Algorithm
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.2。 パズルアルゴリズムの選択
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The PUZZLE notification also contains an identifier of the algorithm that is used by the Initiator to compute the puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
PUZZLE通知には、パズルを計算するためにイニシエーターが使用するアルゴリズムの識別子も含まれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cryptographic algorithm agility is considered an important feature for modern protocols [RFC7696]. Algorithm agility ensures that a protocol doesn&#39;t rely on a single built-in set of cryptographic algorithms but has a means to replace one set with another and negotiate new algorithms with the peer. IKEv2 fully supports cryptographic algorithm agility for its core operations.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
暗号アルゴリズムの俊敏性は、最新のプロトコル[RFC7696]の重要な機能と考えられています。 アルゴリズムの俊敏性により、プロトコルは暗号化アルゴリズムの単一の組み込みセットに依存せず、あるセットを別のセットに置き換え、ピアと新しいアルゴリズムをネゴシエートする手段を備えています。 IKEv2は、コア操作の暗号化アルゴリズムの俊敏性を完全にサポートしています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To support crypto-agility in case of puzzles, the algorithm that is used to compute a puzzle needs to be negotiated during the IKE_SA_INIT exchange. The negotiation is performed as follows. The initial request message from the Initiator contains an SA payload containing a list of transforms of different types. In that manner, the Initiator asserts that it supports all transforms from this list and can use any of them in the IKE SA being established. The Responder parses the received SA payload and finds mutually supported transforms of type PRF. The Responder selects the preferred PRF from the list of mutually supported ones and includes it into the PUZZLE notification. There is no requirement that the PRF selected for puzzles be the same as the PRF that is negotiated later for use in core IKE SA crypto operations. If there are no mutually supported PRFs, then IKE SA negotiation will fail anyway and there is no reason to return a puzzle. In this case, the Responder returns a NO_PROPOSAL_CHOSEN notification. Note that PRF is a mandatory transform type for IKE SA (see Sections 3.3.2 and 3.3.3 of [RFC7296]), and at least one transform of this type is always present in the SA payload in an IKE_SA_INIT request message.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルの場合に暗号アジリティをサポートするには、IKE_SA_INIT交換中にパズルの計算に使用されるアルゴリズムをネゴシエートする必要があります。ネゴシエーションは次のように実行されます。イニシエーターからの最初の要求メッセージには、さまざまなタイプの変換のリストを含むSAペイロードが含まれています。その方法で、イニシエーターはこのリストからのすべての変換をサポートし、確立されているIKE SAでそれらのいずれかを使用できると断言します。レスポンダーは受信したSAペイロードを解析し、相互にサポートされているPRFタイプのトランスフォームを見つけます。レスポンダーは、相互にサポートされているもののリストから優先PRFを選択し、それをPUZZLE通知に含めます。パズル用に選択されたPRFが、後でIKE SA暗号化コア操作で使用するためにネゴシエートされるPRFと同じであるという要件はありません。相互にサポートされているPRFがない場合、IKE SAネゴシエーションはとにかく失敗し、パズルを返す理由はありません。この場合、レスポンダーはNO_PROPOSAL_CHOSEN通知を返します。 PRFはIKE SAの必須の変換タイプであり（[RFC7296]のセクション3.3.2および3.3.3を参照）、このタイプの少なくとも1つの変換がIKE_SA_INIT要求メッセージのSAペイロードに常に存在することに注意してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.3. Generating a Cookie
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.1.3。 クッキーを生成する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Responder supports puzzles, then a cookie should be computed in such a manner that the Responder is able to learn some important information from the sole cookie, when it is later returned back by the Initiator. In particular, the Responder SHOULD be able to learn the following information:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがパズルをサポートしている場合、後でイニシエーターから返されるときに、レスポンダーが唯一のCookieから重要な情報を学習できるように、Cookieを計算する必要があります。 特に、レスポンダーは次の情報を学習できる必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Whether the puzzle was given to the Initiator or only the cookie was requested.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oパズルがイニシエーターに提供されたか、Cookieのみが要求されたか。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The difficulty level of the puzzle given to the Initiator.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターに与えられたパズルの難易度。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The number of consecutive puzzles given to the Initiator.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターに与えられた連続パズルの数。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The amount of time the Initiator spent to solve the puzzles. This can be calculated if the cookie is timestamped.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターがパズルの解決に費やした時間。 これは、Cookieにタイムスタンプが付けられている場合に計算できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This information helps the Responder to make a decision whether to serve this request or demand more work from the Initiator.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この情報は、レスポンダーがこの要求を処理するか、イニシエーターにさらに作業を要求するかを決定するのに役立ちます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
One possible approach to get this information is to encode it in the cookie. The format of such encoding is an implementation detail of the Responder, as the cookie would remain an opaque block of data to the Initiator. If this information is encoded in the cookie, then the Responder MUST make it integrity protected, so that any intended or accidental alteration of this information in the returned cookie is detectable. So, the cookie would be generated as:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この情報を取得する1つの可能なアプローチは、Cookieにエンコードすることです。 Cookieはイニシエーターにとって不透明なデータブロックのままなので、このようなエンコードの形式はレスポンダーの実装の詳細です。 この情報がCookieにエンコードされている場合、レスポンダーは完全性を保護する必要があるため、返されたCookieのこの情報の意図的または偶発的な変更は検出可能です。 したがって、Cookieは次のように生成されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cookie = &lt;VersionIDofSecret&gt; | &lt;AdditionalInfo&gt; | Hash(Ni | IPi | SPIi | &lt;AdditionalInfo&gt; | &lt;secret&gt;)
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cookie = &lt;VersionIDofSecret&gt; | &lt;AdditionalInfo&gt; | ハッシュ（Ni | IPi | SPIi | &lt;AdditionalInfo&gt; | &lt;secret&gt;）
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note that according to Section 2.6 of [RFC7296], the size of the cookie cannot exceed 64 bytes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]のセクション2.6によると、Cookieのサイズは64バイトを超えることはできません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Alternatively, the Responder may generate a cookie as suggested in Section 2.6 of [RFC7296], but associate the additional information, using local storage identified with the particular version of the secret. In this case, the Responder should have different secrets for every combination of difficulty level and number of consecutive puzzles, and should change the secrets periodically, keeping a few previous versions, to be able to calculate how long ago a cookie was generated.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
あるいは、[RFC7296]のセクション2.6で示唆されているように、レスポンダーはCookieを生成できますが、特定のバージョンのシークレットで識別されるローカルストレージを使用して追加情報を関連付けます。 この場合、レスポンダーは難易度と連続するパズルの数の組み合わせごとに異なるシークレットを持っている必要があり、Cookieが生成された時間を計算できるように、以前のバージョンをいくつか保持しながら、シークレットを定期的に変更する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder may also combine these approaches. This document doesn&#39;t mandate how the Responder learns this information from a cookie.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーはこれらのアプローチを組み合わせることもできます。 このドキュメントでは、レスポンダーがこの情報をCookieからどのように学習するかを義務付けていません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
When selecting cookie generation, algorithm implementations MUST ensure that an attacker gains no or insignificant benefit from reusing puzzle solutions in several requests. See Section 10 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cookie生成を選択する場合、アルゴリズムの実装では、攻撃者が複数のリクエストでパズルソリューションを再利用することによる利益を得ないか、取るに足らない利益を獲得する必要があります。 詳細については、セクション10を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.2. Solving a Puzzle and Returning the Solution
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.2。 パズルを解いて解決策を返す
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator receives a puzzle but it doesn&#39;t support puzzles, then it will ignore the PUZZLE notification as an unrecognized status notification (in accordance with Section 3.10.1 of [RFC7296]). The Initiator MAY ignore the PUZZLE notification if it is not willing to spend resources to solve the puzzle of the requested difficulty, even if it supports puzzles. In both cases, the Initiator acts as described in Section 2.6 of [RFC7296] -- it restarts the request and includes the received COOKIE notification in it. The Responder should be able to distinguish the situation when it just requested a cookie from the situation where the puzzle was given to the Initiator, but the Initiator for some reason ignored it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターがパズルを受信したが、パズルをサポートしていない場合、PUZZLE通知を認識されないステータス通知として無視します（[RFC7296]のセクション3.10.1に従って）。 イニシエーターは、パズルをサポートしている場合でも、要求された難易度のパズルを解決するためにリソースを費やす意思がない場合、PUZZLE通知を無視してもよい（MAY）。 どちらの場合も、イニシエーターは[RFC7296]のセクション2.6で説明されているように動作します-要求を再開し、受信したCOOKIE通知をその中に含めます。 レスポンダーは、クッキーを要求したばかりの状況と、イニシエーターにパズルが与えられたが、何らかの理由でイニシエーターがそれを無視した状況とを区別できるはずです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the received message contains a PUZZLE notification and doesn&#39;t contain a COOKIE notification, then this message is malformed because it requests to solve the puzzle but doesn&#39;t provide enough information to allow the puzzle to be solved. In this case, the Initiator MUST ignore the received message and continue to wait until either a valid PUZZLE notification is received or the retransmission timer fires. If it fails to receive a valid message after several retransmissions of IKE_SA_INIT requests, then this means that something is wrong and the IKE SA cannot be established.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
受信したメッセージにPUZZLE通知が含まれ、COOKIE通知が含まれていない場合、このメッセージはパズルの解決を要求しますが、パズルを解決するのに十分な情報を提供しないため、不正な形式です。 この場合、イニシエーターは受信したメッセージを無視し、有効なパズル通知が受信されるか、再送信タイマーが起動するまで待機し続けなければなりません。 IKE_SA_INIT要求の数回の再送信後に有効なメッセージの受信に失敗した場合、これは何かが間違っており、IKE SAを確立できないことを意味します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator supports puzzles and is ready to solve them, then it tries to solve the given puzzle. After the puzzle is solved, the Initiator restarts the request and returns back to the Responder the puzzle solution in a new payload called a Puzzle Solution (PS) payload (see Section 8.2) along with the received COOKIE notification.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターがパズルをサポートし、それらを解決する準備ができている場合、指定されたパズルを解決しようとします。 パズルが解決された後、イニシエーターはリクエストを再開し、受信したCOOKIE通知とともにパズルソリューション（PS）ペイロード（セクション8.2を参照）と呼ばれる新しいペイロードでパズルソリューションをレスポンダーに返します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR, N(COOKIE), [PS,] SA, KE, Ni, [V+][N+] --&gt;
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR、N（COOKIE）、[PS、] SA、KE、Ni、[V +] [N +]-&gt;
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Figure 3: IKE_SA_INIT Request Containing Puzzle Solution
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
図3：パズルソリューションを含むIKE_SA_INITリクエスト
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.3. Computing a Puzzle
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.3。 パズルの計算
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
General principles of constructing puzzles in IKEv2 are described in Section 4.4. They can be summarized as follows: given unpredictable string S and PRF, find N different keys Ki (where i=[1..N]) for that PRF so that the result of PRF(Ki,S) has at least the specified number of trailing zero bits. This specification requires that the puzzle solution contains 4 different keys (i.e., N=4).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEv2でパズルを構築する一般的な原則については、セクション4.4で説明しています。 それらは次のように要約できます：予測不能な文字列SとPRFが与えられた場合、PRF（Ki、S）の結果が少なくとも指定された数になるように、そのPRFのN個の異なるキーKi（i = [1..N]）を見つけます 後続ゼロビットの。 この仕様では、パズルソリューションに4つの異なるキー（N = 4）が含まれている必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
In the IKE_SA_INIT exchange, it is the cookie that plays the role of unpredictable string S. In other words, in the IKE_SA_INIT, the task for the IKE Initiator is to find the four different, equal-sized keys Ki for the agreed upon PRF such that each result of PRF(Ki,cookie) where i = [1..4] has a sufficient number of trailing zero bits. Only the content of the COOKIE notification is used in puzzle calculation, i.e., the header of the Notify payload is not included.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INIT交換では、予測不能な文字列Sの役割を果たすのはCookieです。言い換えると、IKE_SA_INITでは、IKEイニシエーターのタスクは、合意されたPRFの4つの異なるサイズのキーKiを見つけることです。 PRF（Ki、cookie）の各結果（i = [1..4]）には、十分な数の後続ゼロビットがあります。 COOKIE通知のコンテンツのみがパズルの計算に使用されます。つまり、Notifyペイロードのヘッダーは含まれません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note that puzzles in the IKE_AUTH exchange are computed differently than in the IKE_SA_INIT_EXCHANGE. See Section 7.2.3 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_AUTH交換のパズルは、IKE_SA_INIT_EXCHANGEとは異なる方法で計算されることに注意してください。 詳細については、セクション7.2.3を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.4. Analyzing Repeated Request
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.4。 繰り返しリクエストの分析
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The received request must at least contain a COOKIE notification. Otherwise, it is an initial request and in this case, it MUST be processed according to Section 7.1. First, the cookie MUST be checked for validity. If the cookie is invalid, then the request is treated as initial and is processed according to Section 7.1. It is RECOMMENDED that a new cookie is requested in this case.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
受信したリクエストには、少なくともCOOKIE通知が含まれている必要があります。 それ以外の場合、それは最初の要求であり、この場合、セクション7.1に従って処理する必要があります。 まず、Cookieの有効性を確認する必要があります。 Cookieが無効な場合、リクエストは初期として処理され、セクション7.1に従って処理されます。 この場合、新しいCookieが要求されることが推奨されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the cookie is valid, then some important information is learned from it or from local state based on the identifier of the cookie&#39;s secret (see Section 7.1.1.3 for details). This information helps the Responder to sort out incoming requests, giving more priority to those that were created by spending more of the Initiator&#39;s resources.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Cookieが有効な場合、Cookieの秘密の識別子に基づいて、Cookieまたはローカル状態からいくつかの重要な情報が学習されます（詳細についてはセクション7.1.1.3を参照）。 この情報は、レスポンダーが着信要求を整理し、イニシエーターのリソースをより多く使用して作成された要求に優先順位を付けるのに役立ちます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
First, the Responder determines if it requested only a cookie or presented a puzzle to the Initiator. If no puzzle was given, this means that at the time the Responder requested a cookie, it didn&#39;t detect the DoS or DDoS attack, or the attack volume was low. In this case, the received request message must not contain the PS payload, and this payload MUST be ignored if the message contains a PS payload for any reason. Since no puzzle was given, the Responder marks the request with the lowest priority since the Initiator spent little resources creating it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
最初に、レスポンダーはCookieのみを要求したか、イニシエーターにパズルを提示したかを判断します。 パズルが与えられなかった場合、これは、レスポンダーがCookieをリクエストしたときに、DoSまたはDDoS攻撃を検出しなかったか、攻撃量が少ないことを意味します。 この場合、受信した要求メッセージにはPSペイロードを含めることはできません。何らかの理由でメッセージにPSペイロードが含まれている場合、このペイロードは無視する必要があります。 パズルが提供されなかったため、イニシエーターは作成にほとんどリソースを費やさなかったため、レスポンダーはリクエストを最も低い優先度でマークします。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Responder learns from the cookie that the puzzle was given to the Initiator, then it looks for the PS payload to determine whether its request to solve the puzzle was honored or not. If the incoming message doesn&#39;t contain a PS payload, this means that the Initiator either doesn&#39;t support puzzles or doesn&#39;t want to deal with them. In either case, the request is marked with the lowest priority since the Initiator spent little resources creating it.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Responderは、Cookieからパズルがイニシエーターに与えられたことを知ると、PSペイロードを探して、パズルを解決する要求が受け入れられたかどうかを判断します。 受信メッセージにPSペイロードが含まれていない場合、これはイニシエーターがパズルをサポートしていないか、パズルを処理したくないことを意味します。 どちらの場合でも、イニシエーターはそれを作成するためにほとんどリソースを消費しなかったため、リクエストは最も低い優先度でマークされます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If a PS payload is found in the message, then the Responder MUST verify the puzzle solution that it contains. The solution is interpreted as four different keys. The result of using each of them in the PRF (as described in Section 7.1.3) must contain at least the requested number of trailing zero bits. The Responder MUST check all of the four returned keys.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
メッセージにPSペイロードが見つかった場合、レスポンダーはそれに含まれるパズルソリューションを検証する必要があります。 ソリューションは4つの異なるキーとして解釈されます。 PRFでそれらを使用した結果（セクション7.1.3で説明）には、少なくとも要求された数の後続ゼロビットが含まれていなければなりません。 レスポンダーは、返された4つのキーすべてをチェックする必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If any checked result contains fewer bits than were requested, this means that the Initiator spent less resources than expected by the Responder. This request is marked with the lowest priority.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
チェック結果に要求されたよりも少ないビットが含まれている場合、これはイニシエーターがレスポンダーが予想するよりも少ないリソースを使用したことを意味します。 この要求には、最も低い優先度がマークされます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator provided the solution to the puzzle satisfying the requested difficulty level, or if the Responder didn&#39;t indicate any particular difficulty level (by setting the ZBC to 0) and the
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターが要求された難易度を満たすパズルの解決策を提供した場合、またはレスポンダーが特定の難易度を示さなかった場合（ZBCを0に設定すること）、および
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Initiator was free to select any difficulty level it can afford, then the priority of the request is calculated based on the following considerations:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターは、余裕のある難易度を自由に選択でき、リクエストの優先度は次の考慮事項に基づいて計算されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The Responder MUST take the smallest number of trailing zero bits among the checked results and count it as the number of zero bits the Initiator solved for.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oレスポンダーは、チェックされた結果の中で末尾のゼロビットの最小数を取り、イニシエーターが解決したゼロビットの数としてカウントしなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The higher number of zero bits the Initiator provides, the higher priority its request should receive.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターが提供するゼロビットの数が多いほど、リクエストが受け取る優先順位が高くなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The more consecutive puzzles the Initiator solved, the higher priority it should receive.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターが連続してパズルを解くほど、受け取る優先度が高くなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o The more time the Initiator spent solving the puzzles, the higher priority it should receive.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターがパズルを解くのに費やした時間が長いほど、受け取るべき優先順位が高くなります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
After the priority of the request is determined, the final decision whether to serve it or not is made.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
リクエストの優先度が決定された後、リクエストを処理するかどうかの最終決定が行われます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.5. Deciding Whether to Serve the Request
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1.5。 リクエストを処理するかどうかの決定
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder decides what to do with the request based on the request&#39;s priority and the Responder&#39;s current load. There are three possible actions:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、リクエストの優先度とレスポンダーの現在の負荷に基づいて、リクエストの処理方法を決定します。 3つの可能なアクションがあります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Accept request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o要求を受け入れます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Reject request.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oリクエストを拒否します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Demand more work from the Initiator by giving it a new puzzle.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oイニシエーターに新しいパズルを与えることにより、イニシエーターにさらに多くの作業を要求します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder SHOULD accept an incoming request if its priority is high -- this means that the Initiator spent quite a lot of resources. The Responder MAY also accept some low-priority requests where the Initiators don&#39;t support puzzles. The percentage of accepted legacy requests depends on the Responder&#39;s current load.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、優先度が高い場合、着信要求を受け入れる必要があります-これは、イニシエーターがかなりのリソースを費やしたことを意味します。 レスポンダーは、イニシエーターがパズルをサポートしていない優先度の低いリクエストも受け入れる場合があります。 受け入れられたレガシーリクエストの割合は、レスポンダーの現在の負荷によって異なります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator solved the puzzle, but didn&#39;t spend much resources for it (the selected puzzle difficulty level appeared to be low and the Initiator solved it quickly), then the Responder SHOULD give it another puzzle. The more puzzles the Initiator solves the higher its chances are to be served.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターがパズルを解決したが、あまり多くのリソースを使用しなかった場合（選択したパズルの難易度が低く、イニシエーターがすぐに解決した場合）、レスポンダーは別のパズルを与える必要があります。 イニシエーターが解決するパズルが多ければ多いほど、そのチャンスが提供されることになります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The details of how the Responder makes a decision for any particular request are implementation dependent. The Responder can collect all of the incoming requests for some short period of time, sort them out based on their priority, calculate the number of available memory slots for half-open IKE SAs, and then serve that number of requests from the head of the sorted list. The remainder of requests can be either discarded or responded to with new puzzle requests.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーが特定の要求に対してどのように決定を行うかの詳細は、実装に依存します。 レスポンダーは、着信リクエストを短時間収集し、優先度に基づいてそれらを並べ替え、ハーフオープンIKE SAの利用可能なメモリスロットの数を計算し、その数のリクエストをそのヘッドから処理できます。 ソートされたリスト。 残りのリクエストは破棄するか、新しいパズルリクエストで応答することができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Alternatively, the Responder may decide whether to accept every incoming request with some kind of lottery, taking into account its priority and the available resources.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
あるいは、レスポンダーは、優先度と使用可能なリソースを考慮して、何らかの宝くじですべての着信要求を受け入れるかどうかを決定する場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2. Puzzles in an IKE_AUTH Exchange
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2。 IKE_AUTH交換のパズル
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Once the IKE_SA_INIT exchange is completed, the Responder has created a state and is waiting for the first message of the IKE_AUTH exchange from the Initiator. At this point, the Initiator has already passed the return routability check and has proved that it has performed some work to complete the IKE_SA_INIT exchange. However, the Initiator is not yet authenticated, and this allows a malicious Initiator to perform an attack, as described in Section 3. Unlike a DoS attack in the IKE_SA_INIT exchange, which is targeted on the Responder&#39;s memory resources, the goal of this attack is to exhaust a Responder&#39;s CPU power. The attack is performed by sending the first IKE_AUTH message containing arbitrary data. This costs nothing to the Initiator, but the Responder has to perform relatively costly operations when computing the DH shared secret and deriving SK_* keys to be able to verify authenticity of the message. If the Responder doesn&#39;t keep the computed keys after an unsuccessful verification of the IKE_AUTH message, then the attack can be repeated several times on the same IKE SA.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INIT交換が完了すると、レスポンダーは状態を作成し、イニシエーターからのIKE_AUTH交換の最初のメッセージを待っています。この時点で、イニシエーターはすでにリターンルーティング可能性チェックに合格しており、IKE_SA_INIT交換を完了するための何らかの作業を実行したことを証明しています。ただし、イニシエーターはまだ認証されていないため、セクション3で説明するように、悪意のあるイニシエーターが攻撃を実行できます。レスポンダーのメモリリソースを標的とするIKE_SA_INIT交換のDoS攻撃とは異なり、この攻撃の目的はレスポンダーのCPUパワーを使い果たします。攻撃は、任意のデータを含む最初のIKE_AUTHメッセージを送信することにより実行されます。これはイニシエーターに何もかかりませんが、レスポンダーは、DH共有シークレットを計算し、メッセージの信頼性を検証できるようにSK_ *キーを導出するときに、比較的コストのかかる操作を実行する必要があります。 IKE_AUTHメッセージの検証に失敗した後、レスポンダーが計算されたキーを保持しない場合、同じIKE SAで攻撃を数回繰り返すことができます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder can use puzzles to make this attack more costly for the Initiator. The idea is that the Responder includes a puzzle in the IKE_SA_INIT response message and the Initiator includes a puzzle solution in the first IKE_AUTH request message outside the Encrypted payload, so that the Responder is able to verify a puzzle solution before computing the DH shared secret.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーはパズルを使用して、この攻撃をイニシエーターにとってより高価にすることができます。 レスポンダーはIKE_SA_INIT応答メッセージにパズルを含め、イニシエーターは暗号化されたペイロードの外側の最初のIKE_AUTH要求メッセージにパズルソリューションを含めるため、レスポンダーはDH共有シークレットを計算する前にパズルソリューションを検証できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder constantly monitors the amount of the half-open IKE SA states that receive IKE_AUTH messages that cannot be decrypted due to integrity check failures. If the percentage of such states is high and it takes an essential fraction of the Responder&#39;s computing power to calculate keys for them, then the Responder may assume that it is under attack and SHOULD use puzzles to make it harder for attackers.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、整合性チェックの失敗のために復号化できないIKE_AUTHメッセージを受信するハーフオープンIKE SA状態の量を常に監視します。 そのような状態の割合が高く、それらのキーを計算するのにレスポンダーの計算能力の本質的な部分が必要な場合、レスポンダーはそれが攻撃を受けていると想定し、パズルを使用して攻撃者を難しくする必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1. Presenting the Puzzle
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1。 パズルを提示する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder requests the Initiator to solve a puzzle by including the PUZZLE notification in the IKE_SA_INIT response message. The Responder MUST NOT use puzzles in the IKE_AUTH exchange unless a puzzle has been previously presented and solved in the preceding IKE_SA_INIT exchange.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、IKE_SA_INIT応答メッセージにPUZZLE通知を含めることにより、イニシエーターにパズルを解決するように要求します。 レスポンダーは、前のIKE_SA_INIT交換でパズルが提示されて解決されていない限り、IKE_AUTH交換でパズルを使用してはなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
&lt;-- HDR, SA, KE, Nr, N(PUZZLE), [V+][N+]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
&lt;-HDR、SA、KE、Nr、N（パズル）、[V +] [N +]
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Figure 4: IKE_SA_INIT Response Containing IKE_AUTH Puzzle
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
図4：IKE_AUTHパズルを含むIKE_SA_INIT応答
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1.1. Selecting Puzzle Difficulty Level
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1.1。 パズルの難易度を選択する
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The difficulty level of the puzzle in the IKE_AUTH exchange should be chosen so that the Initiator would spend more time to solve the puzzle than the Responder to compute the DH shared secret and the keys needed to decrypt and verify the IKE_AUTH request message. On the other hand, the difficulty level should not be too high, otherwise legitimate clients will experience an additional delay while establishing the IKE SA.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_AUTH交換のパズルの難易度は、イニシエーターがパズルを解決するのにレスポンダーよりも多くの時間を費やし、DH共有シークレットとIKE_AUTH要求メッセージの解読と検証に必要なキーを計算するように選択する必要があります。 一方、難易度は高すぎてはなりません。さもないと、正当なクライアントはIKE SAの確立中に追加の遅延を経験します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Note that since puzzles in the IKE_AUTH exchange are only allowed to be used if they were used in the preceding IKE_SA_INIT exchange, the Responder would be able to roughly estimate the computational power of the Initiator and select the difficulty level accordingly. Unlike puzzles in the IKE_SA_INIT, the requested difficulty level for IKE_AUTH puzzles MUST NOT be 0. In other words, the Responder must always set a specific difficulty level and must not let the Initiator choose it on its own.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_AUTH交換のパズルは、前のIKE_SA_INIT交換で使用された場合にのみ使用できるため、レスポンダーはイニシエーターの計算能力を大まかに推定し、それに応じて難易度を選択できることに注意してください。 IKE_SA_INITのパズルとは異なり、IKE_AUTHパズルに要求される難易度は0であってはなりません。言い換えると、レスポンダーは常に特定の難易度を設定する必要があり、イニシエーターが独自に選択することはできません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1.2. Selecting the Puzzle Algorithm
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.1.2。 パズルアルゴリズムの選択
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The algorithm for the puzzle is selected as described in Section 7.1.1.2. There is no requirement that the algorithm for the puzzle in the IKE_SA INIT exchange be the same as the algorithm for the puzzle in the IKE_AUTH exchange; however, it is expected that in most cases they will be the same.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルのアルゴリズムは、セクション7.1.1.2で説明されているように選択されます。 IKE_SA INIT交換のパズルのアルゴリズムがIKE_AUTH交換のパズルのアルゴリズムと同じであるという要件はありません。 ただし、ほとんどの場合、同じであると予想されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.2. Solving the Puzzle and Returning the Solution
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.2。 パズルを解いて解決策を返す
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the IKE_SA_INIT regular response message (i.e., the message containing SA, KE, NONCE payloads) contains the PUZZLE notification and the Initiator supports puzzles, it MUST solve the puzzle. Note that puzzle construction in the IKE_AUTH exchange differs from the puzzle construction in the IKE_SA_INIT exchange and is described in Section 7.2.3. Once the puzzle is solved, the Initiator sends the IKE_AUTH request message containing the PS payload.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_SA_INITの通常の応答メッセージ（SA、KE、NONCEペイロードを含むメッセージ）にPUZZLE通知が含まれ、イニシエーターがパズルをサポートしている場合、パズルを解決する必要があります。 IKE_AUTH交換のパズルの構築はIKE_SA_INIT交換のパズルの構築とは異なり、セクション7.2.3で説明されていることに注意してください。 パズルが解決されると、イニシエーターはPSペイロードを含むIKE_AUTH要求メッセージを送信します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR, PS, SK {IDi, [CERT,] [CERTREQ,] [IDr,] AUTH, SA, TSi, TSr} --&gt;
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
HDR、PS、SK {IDi、[CERT、] [CERTREQ、] [IDr、] AUTH、SA、TSi、TSr}-&gt;
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Figure 5: IKE_AUTH Request Containing IKE_AUTH Puzzle Solution
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
図5：IKE_AUTHパズルソリューションを含むIKE_AUTHリクエスト
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The PS payload MUST be placed outside the Encrypted payload, so that the Responder is able to verify the puzzle before calculating the DH shared secret and the SK_* keys.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
PSペイロードは、暗号化されたペイロードの外側に配置する必要があります。これにより、レスポンダーは、DH共有シークレットとSK_ *キーを計算する前にパズルを検証できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If IKE fragmentation [RFC7383] is used in the IKE_AUTH exchange, then the PS payload MUST be present only in the first IKE Fragment message, in accordance with Section 2.5.3 of [RFC7383]. Note that calculation of the puzzle in the IKE_AUTH exchange doesn&#39;t depend on the content of the IKE_AUTH message (see Section 7.2.3). Thus, the Initiator has to solve the puzzle only once, and the solution is valid for both unfragmented and fragmented IKE messages.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKEフラグメンテーション[RFC7383]がIKE_AUTH交換で使用される場合、[RFC7383]のセクション2.5.3に従って、PSペイロードは最初のIKEフラグメントメッセージにのみ存在しなければなりません。 IKE_AUTH交換でのパズルの計算は、IKE_AUTHメッセージの内容に依存しないことに注意してください（セクション7.2.3を参照）。 したがって、イニシエーターはパズルを1回だけ解く必要があり、ソリューションは断片化されていないIKEメッセージと断片化されたIKEメッセージの両方に有効です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.3. Computing the Puzzle
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.3。 パズルの計算
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
A puzzle in the IKE_AUTH exchange is computed differently than in the IKE_SA_INIT exchange (see Section 7.1.3). The general principle is the same; the difference is in the construction of the string S. Unlike the IKE_SA_INIT exchange, where S is the cookie, in the IKE_AUTH exchange, S is a concatenation of Nr and SPIr. In other words, the task for the IKE Initiator is to find the four different keys Ki for the agreed upon PRF such that each result of PRF(Ki,Nr | SPIr) where i=[1..4] has a sufficient number of trailing zero bits. Nr is a nonce used by the Responder in the IKE_SA_INIT exchange, stripped of any headers. SPIr is the IKE Responder&#39;s SPI from the IKE header of the SA being established.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
IKE_AUTH交換のパズルは、IKE_SA_INIT交換とは異なる方法で計算されます（セクション7.1.3を参照）。 一般的な原則は同じです。 違いは文字列Sの構成にあります。IKEがCookieであるIKE_SA_INIT交換とは異なり、IKE_AUTH交換では、SはNrとSPIrの連結です。 つまり、IKEイニシエーターのタスクは、PRF（Ki、Nr | SPIr）の各結果が十分な数のPRF（Ki、Nr | SPIr）になるように、合意されたPRFの4つの異なるキーKiを見つけることです。 末尾のゼロビット。 Nrは、IKE_SA_INIT交換でレスポンダーによって使用されるノンスであり、ヘッダーは取り除かれます。 SPIrは、確立されているSAのIKEヘッダーからのIKEレスポンダーのSPIです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.4. Receiving the Puzzle Solution
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2.4。 パズルソリューションを受け取る
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Responder requested the Initiator to solve a puzzle in the IKE_AUTH exchange, then it MUST silently discard all the IKE_AUTH request messages without the PS payload.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーがイニシエーターにIKE_AUTH交換でパズルを解くように要求した場合、PSペイロードのないすべてのIKE_AUTH要求メッセージを静かに破棄しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Once the message containing a solution to the puzzle is received, the Responder MUST verify the solution before performing computationally intensive operations, i.e., computing the DH shared secret and the SK_* keys. The Responder MUST verify all four of the returned keys.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルの解決策を含むメッセージを受信すると、レスポンダーは、計算集約的な操作、つまりDH共有シークレットとSK_ *キーを計算する前に、解決策を検証する必要があります。 レスポンダーは、返された4つのキーすべてを検証しなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder MUST silently discard the received message if any checked verification result is not correct (contains insufficient number of trailing zero bits). If the Responder successfully verifies the puzzle and calculates the SK_* key, but the message authenticity check fails, then it SHOULD save the calculated keys in the IKE SA state while waiting for the retransmissions from the
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
確認された検証結果が正しくない場合（レスポンダーは、末尾のゼロビットの数が不十分である場合）、受信したメッセージを静かに破棄しなければなりません。 レスポンダーがパズルの検証とSK_ *キーの計算に成功したが、メッセージの信頼性チェックが失敗した場合、計算されたキーをIKE SA状態で保存する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Initiator. In this case, the Responder may skip verification of the puzzle solution and ignore the PS payload in the retransmitted messages.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエータ。 この場合、レスポンダーはパズルソリューションの検証をスキップし、再送信されたメッセージのPSペイロードを無視する場合があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator uses IKE fragmentation, then it sends all fragments of a message simultaneously. Due to packets loss and/or reordering, it is possible that the Responder receives subsequent fragments before receiving the first one that contains the PS payload. In this case, the Responder MAY choose to keep the received fragments until the first fragment containing the solution to the puzzle is received. In this case, the Responder SHOULD NOT try to verify authenticity of the kept fragments until the first fragment with the PS payload is received, and the solution to the puzzle is verified. After successful verification of the puzzle, the Responder can then calculate the SK_* key and verify authenticity of the collected fragments.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターがIKEフラグメンテーションを使用する場合、メッセージのすべてのフラグメントを同時に送信します。 パケットの損失や再順序付けのために、PSペイロードを含む最初のフラグメントを受信する前に、レスポンダーが後続のフラグメントを受信する可能性があります。 この場合、レスポンダーはパズルの解を含む最初のフラグメントが受信されるまで、受信したフラグメントを保持することを選択できます。 この場合、PSペイロードを持つ最初のフラグメントが受信され、パズルの解決策が検証されるまで、レスポンダーは保持されたフラグメントの信頼性を検証しようとすべきではありません。 パズルの検証に成功すると、レスポンダーはSK_ *キーを計算し、収集されたフラグメントの信頼性を検証できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8. Payload Formats
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.ペイロード形式
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.1. PUZZLE Notification
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.1。 パズル通知
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The PUZZLE notification is used by the IKE Responder to inform the Initiator about the need to solve the puzzle. It contains the difficulty level of the puzzle and the PRF the Initiator should use.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルの通知は、IKE Responderによって使用され、パズルを解決する必要があることをイニシエーターに通知します。 パズルの難易度とイニシエーターが使用するPRFが含まれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Next Payload  |C|  RESERVED   |         Payload Length        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Protocol ID(=0)| SPI Size (=0) |      Notify Message Type      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              PRF              |  Difficulty   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Protocol ID (1 octet) -- MUST be 0.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oプロトコルID（1オクテット）-0でなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o SPI Size (1 octet) -- MUST be 0, meaning no SPI is present.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o SPIサイズ（1オクテット）-0でなければならず、SPIが存在しないことを意味します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Notify Message Type (2 octets) -- MUST be 16434, the value assigned for the PUZZLE notification.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Notify Message Type（2オクテット）-16434、PUZZLE通知に割り当てられた値でなければなりません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o PRF (2 octets) -- Transform ID of the PRF algorithm that MUST be used to solve the puzzle. Readers should refer to the &#34;Transform Type 2 - Pseudorandom Function Transform IDs&#34; subregistry on [IKEV2-IANA] for the list of possible values.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o PRF（2オクテット）-パズルを解くために使用しなければならないPRFアルゴリズムの変換ID。 可能な値のリストについては、[IKEV2-IANA]の「変換タイプ2-擬似乱数関数変換ID」サブレジストリを参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Difficulty (1 octet) -- Difficulty level of the puzzle. Specifies the minimum number of trailing zero bits (ZBC) that each of the results of PRF must contain. Value 0 means that the Responder doesn&#39;t request any specific difficulty level, and the Initiator is free to select an appropriate difficulty level on its own (see Section 7.1.1.1 for details).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
o難易度（1オクテット）-パズルの難易度。 PRFの各結果に含める必要がある後続ゼロビット（ZBC）の最小数を指定します。 値0は、レスポンダーが特定の難易度を要求せず、イニシエーターが独自に適切な難易度を自由に選択できることを意味します（詳細はセクション7.1.1.1を参照）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This notification contains no data.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
この通知にはデータが含まれていません。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.2. Puzzle Solution Payload
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
8.2。 パズルソリューションペイロード
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The solution to the puzzle is returned back to the Responder in a dedicated payload, called the PS payload.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルのソリューションは、PSペイロードと呼ばれる専用のペイロードでレスポンダーに返されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Next Payload  |C|  RESERVED   |         Payload Length        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                     Puzzle Solution Data                      ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
o Puzzle Solution Data (variable length) -- Contains the solution to the puzzle -- four different keys for the selected PRF. This field MUST NOT be empty. All of the keys MUST have the same size; therefore, the size of this field is always a multiple of 4 bytes. If the selected PRF accepts only fixed-size keys, then the size of each key MUST be of that fixed size. If the agreed upon PRF accepts keys of any size, then the size of each key MUST be between 1 octet and the preferred key length of the PRF (inclusive). It is expected that in most cases, the keys will be 4 (or even less) octets in length; however, it depends on puzzle difficulty and on the Initiator&#39;s strategy to find solutions, and thus the size is not mandated by this specification. The Responder determines the size of each key by dividing the size of the Puzzle Solution Data by 4 (the number of keys). Note that the size of Puzzle Solution Data is the size of the Payload (as indicated in the Payload Length field) minus 4 -- the size of the Payload header.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
oパズルソリューションデータ（可変長）-パズルのソリューションが含まれています-選択したPRFの4つの異なるキー。このフィールドは空にしないでください。すべてのキーは同じサイズでなければなりません。したがって、このフィールドのサイズは常に4バイトの倍数です。選択したPRFが固定サイズのキーのみを受け入れる場合、各キーのサイズはその固定サイズでなければなりません。合意されたPRFが任意のサイズのキーを受け入れる場合、各キーのサイズは1オクテットからPRFの優先キー長（両端を含む）の間でなければなりません。ほとんどの場合、キーの長さは4オクテット（またはそれ以下）になると予想されます。ただし、パズルの難易度と解決策を見つけるためのイニシエーターの戦略に依存するため、この仕様ではサイズは必須ではありません。レスポンダーは、パズルソリューションデータのサイズを4（キーの数）で割ることにより、各キーのサイズを決定します。パズルソリューションデータのサイズは、ペイロードのサイズ（ペイロード長フィールドに示されている）-4-ペイロードヘッダーのサイズです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The payload type for the PS payload is 54.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
PSペイロードのペイロードタイプは54です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9. Operational Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
9.操作上の考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The puzzle difficulty level should be set by balancing the requirement to minimize the latency for legitimate Initiators with making things difficult for attackers. A good rule of thumb is taking about 1 second to solve the puzzle. At the time this document was written, a typical Initiator or botnet member can perform slightly less than a million hashes per second per core, so setting the number of zero bits to 20 is a good compromise. It should be noted that mobile Initiators, especially phones, are considerably weaker than that. Implementations should allow administrators to set the difficulty level and/or be able to set the difficulty level dynamically in response to load.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルの難易度は、正当なイニシエーターの待機時間を最小限に抑える要件と、攻撃者にとって物事を難しくする要件のバランスをとって設定する必要があります。 大まかな目安として、パズルを解くのに約1秒かかります。 このドキュメントが作成された時点で、典型的なイニシエーターまたはボットネットメンバーはコアあたり毎秒100万回未満のハッシュを実行できるため、ゼロビット数を20に設定することは適切な妥協案です。 モバイルイニシエーター、特に電話は、それよりもかなり弱いことに注意してください。 実装では、管理者が負荷に応じて難易度を設定したり、難易度を動的に設定したりできるようにする必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Initiators SHOULD set a maximum difficulty level beyond which they won&#39;t try to solve the puzzle and log or display a failure message to the administrator or user.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターは、パズルを解こうとしたり、管理者またはユーザーにエラーメッセージを記録または表示しようとしない最大難易度を設定する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Until the widespread adoption of puzzles happens, most Initiators will ignore them, as will all attackers. For puzzles to become a really powerful defense measure against DDoS attacks, they must be supported by the majority of legitimate clients.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルが広く採用されるまで、ほとんどのイニシエーターは、すべての攻撃者がそうであるように、パズルを無視します。 パズルがDDoS攻撃に対する本当に強力な防御手段となるためには、正当なクライアントの大半がパズルをサポートする必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10. Security Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
10.セキュリティに関する考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Care must be taken when selecting parameters for the puzzles, in particular the puzzle difficulty. If the puzzles are too easy for the majority of attackers, then the puzzle mechanism wouldn&#39;t be able to prevent DoS or DDoS attacks and would only impose an additional burden on legitimate Initiators. On the other hand, if the puzzles are too hard for the majority of Initiators, then many legitimate users would experience unacceptable delays in IKE SA setup (and unacceptable power consumption on mobile devices) that might cause them to cancel the connection attempt. In this case, the resources of the Responder are preserved; however, the DoS attack can be considered successful. Thus, a sensible balance should be kept by the Responder while choosing the puzzle difficulty -- to defend itself and to not over-defend itself. It is RECOMMENDED that the puzzle difficulty be chosen, so that the Responder&#39;s load remains close to the maximum it can tolerate. It is also RECOMMENDED to dynamically adjust the puzzle difficulty in accordance to the current Responder&#39;s load.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルのパラメーター、特にパズルの難易度を選択するときは注意が必要です。パズルが大多数の攻撃者にとって簡単すぎる場合、パズルメカニズムはDoSまたはDDoS攻撃を防ぐことができず、正当なイニシエーターに追加の負担をかけるだけです。一方、多くのイニシエーターにとってパズルが難しすぎると、正当なユーザーの多くがIKE SAのセットアップの許容できない遅延（およびモバイルデバイスの許容できない電力消費）を経験し、接続試行をキャンセルする可能性があります。この場合、レスポンダーのリソースは保持されます。ただし、DoS攻撃は成功したと見なすことができます。したがって、レスポンダーはパズルの難易度を選択している間、賢明なバランスを保つ必要があります。パズルの難易度を選択することをお勧めします。これにより、レスポンダーの負荷が許容できる最大値に近いままになります。また、現在のレスポンダーの負荷に応じてパズルの難易度を動的に調整することをお勧めします。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the cookie is generated as suggested in Section 2.6 of [RFC7296], then an attacker can use the same SPIi and the same Ni for several requests from the same IPi. This will result in generating the same cookies for these requests until the Responder changes the value of its cookie generation secret. Since the cookies are used as an input data for puzzles in the IKE_SA_INIT exchange, generating the same cookies allows the attacker to reuse puzzle solutions, thus bypassing the proof-of-work requirement. Note that the attacker can get only limited benefit from this situation -- once the half-open SA is created by the Responder, all the subsequent initial requests with the same IPi and SPIi will be treated as retransmissions and discarded by the Responder. However, once this half-open SA is expired and deleted, the attacker can create a new one for free if the Responder hasn&#39;t changed its cookie generation secret yet.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296]のセクション2.6で示唆されているようにCookieが生成された場合、攻撃者は同じIPiからの複数のリクエストに同じSPIiと同じNiを使用できます。 これにより、レスポンダーがCookie生成シークレットの値を変更するまで、これらの要求に対して同じCookieが生成されます。 CookieはIKE_SA_INIT交換でパズルの入力データとして使用されるため、同じCookieを生成すると、攻撃者はパズルソリューションを再利用でき、作業証明要件をバイパスできます。 攻撃者はこの状況からは限られた利益しか得られないことに注意してください。レスポンダーがハーフオープンSAを作成すると、同じIPiとSPIiを持つすべての後続の初期リクエストは再送信として扱われ、レスポンダーによって破棄されます。 ただし、このハーフオープンSAの有効期限が切れて削除されると、レスポンダーがCookie生成シークレットをまだ変更していない場合、攻撃者は新しいSAを無料で作成できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The Responder can use various countermeasures to completely eliminate or mitigate this scenario. First, the Responder can change its cookie generation secret frequently especially if under attack, as recommended in Section 2.6 of [RFC7296]. For example, if the Responder keeps two values of the secret (current and previous) and the secret lifetime is no more than a half of the current half-open SA retention time (see Section 4.1), then the attacker cannot get benefit from reusing a puzzle solution. However, short cookie generation secret lifetime could have a negative consequence on weak legitimate Initiators, since it could take too long for them to solve puzzles, and their solutions would be discarded if the cookie generation secret has been already changed few times.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーは、さまざまな対策を使用して、このシナリオを完全に排除または軽減できます。 最初に、[RFC7296]のセクション2.6で推奨されているように、特に攻撃を受けている場合、レスポンダーは頻繁にCookie生成シークレットを変更できます。 たとえば、レスポンダーがシークレットの2つの値（現在と以前）を保持し、シークレットライフタイムが現在のハーフオープンSA保持時間の半分以下（セクション4.1を参照）である場合、攻撃者は再利用から利益を得ることができません パズルソリューション。 ただし、Cookie生成シークレットの寿命が短いと、正当なイニシエーターが弱い場合、パズルを解くのに時間がかかりすぎる可能性があり、Cookie生成シークレットが既に数回変更されている場合、ソリューションは破棄されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Another approach for the Responder is to modify the cookie generation algorithm in such a way that the generated cookies are always different or are repeated only within a short time period. If the Responder includes a timestamp in &lt;AdditionalInfo&gt; as suggested in Section 7.1.1.3, then the cookies will repeat only within a short time interval equal to timestamp resolution. Another approach for the Responder is to maintain a global counter that is incremented every time a cookie is generated and include this counter in &lt;AdditionalInfo&gt;. This will make every cookie unique.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
レスポンダーの別のアプローチは、生成されたCookieが常に異なるように、または短期間でのみ繰り返されるように、Cookie生成アルゴリズムを変更することです。 セクション7.1.1.3で提案されているように、レスポンダーの&lt;AdditionalInfo&gt;にタイムスタンプが含まれている場合、Cookieはタイムスタンプ解決に等しい短い時間間隔内でのみ繰り返されます。 Responderの別のアプローチは、Cookieが生成されるたびに増分されるグローバルカウンターを維持し、このカウンターを&lt;AdditionalInfo&gt;に含めることです。 これにより、すべてのCookieが一意になります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Implementations MUST use one of the above (or some other) countermeasures to completely eliminate or make insignificant the possible benefit an attacker can get from reusing puzzle solutions. Note that this issue doesn&#39;t exist in IKE_AUTH puzzles (Section 7.2) since the puzzles in IKE_AUTH are always unique if the Responder generates SPIr and Nr randomly in accordance with [RFC7296].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
実装では、上記（または他の）対策のいずれかを使用して、パズルソリューションを再利用することで攻撃者が得られる可能性のある利益を完全に排除または取るに足らないものにしなければなりません。 応答者が[RFC7296]に従ってSPIrとNrをランダムに生成する場合、IKE_AUTHのパズルは常に一意であるため、この問題はIKE_AUTHパズル（セクション7.2）には存在しないことに注意してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Solving puzzles requires a lot of CPU usage that increases power consumption. This additional power consumption can negatively affect battery-powered Initiators, e.g., mobile phones or some Internet of Things (IoT) devices. If puzzles are too hard, then the required additional power consumption may appear to be unacceptable for some Initiators. The Responder SHOULD take this possibility into consideration while choosing the puzzle difficulty and while selecting which percentage of Initiators are allowed to reject solving puzzles. See Section 7.1.4 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
パズルを解くには、消費電力を増やす多くのCPU使用が必要です。 この追加の電力消費は、バッテリー駆動のイニシエーター、たとえば携帯電話やモノのインターネット（IoT）デバイスに悪影響を及ぼす可能性があります。 パズルが難しすぎる場合、必要な追加の電力消費は、一部のイニシエーターに受け入れられないように見える場合があります。 レスポンダーは、パズルの難易度を選択し、イニシエーターの何パーセントがパズルの解答を拒否できるかを選択する際に、この可能性を考慮する必要があります。 詳細については、セクション7.1.4を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
If the Initiator uses NULL Authentication [RFC7619], then its identity is never verified. This condition may be used by attackers to perform a DoS attack after the IKE SA is established. Responders that allow unauthenticated Initiators to connect must be prepared to deal with various kinds of DoS attacks even after the IKE SA is created. See Section 5 for details.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
イニシエーターがNULL認証[RFC7619]を使用する場合、そのIDは検証されません。 この条件は、IKE SAが確立された後にDoS攻撃を実行するために攻撃者によって使用される可能性があります。 認証されていないイニシエーターの接続を許可するレスポンダーは、IKE SAが作成された後でも、さまざまな種類のDoS攻撃に対処する準備が必要です。 詳細については、セクション5を参照してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
To prevent amplification attacks, implementations must strictly follow the retransmission rules described in Section 2.1 of [RFC7296].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
増幅攻撃を防ぐために、実装は[RFC7296]のセクション2.1で説明されている再送信ルールに厳密に従う必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
11. IANA Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
11. IANAの考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document defines a new payload in the &#34;IKEv2 Payload Types&#34; registry:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントでは、「IKEv2 Payload Types」レジストリに新しいペイロードを定義しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
54 Puzzle Solution PS
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
54パズルソリューションPS
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
This document also defines a new Notify Message Type in the &#34;IKEv2 Notify Message Types - Status Types&#34; registry:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
このドキュメントでは、「IKEv2通知メッセージタイプ-ステータスタイプ」レジストリで新しい通知メッセージタイプも定義しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
16434 PUZZLE
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
16434パズル
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12. References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12.参照
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12.1. Normative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12.1。 規範的参考文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[IKEV2-IANA] IANA, &#34;Internet Key Exchange Version 2 (IKEv2) Parameters&#34;, &lt;http://www.iana.org/assignments/ikev2-parameters&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[IKEV2-IANA] IANA、「インターネットキー交換バージョン2（IKEv2）パラメーター」、&lt;http://www.iana.org/assignments/ikev2-parameters&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2119] Bradner, S., &#34;Key words for use in RFCs to Indicate Requirement Levels&#34;, BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, &lt;http://www.rfc-editor.org/info/rfc2119&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC2119] Bradner、S。、「要求レベルを示すためにRFCで使用するキーワード」、BCP 14、RFC 2119、DOI 10.17487 / RFC2119、1997年3月、&lt;http://www.rfc-editor.org/info/ rfc2119&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC5723] Sheffer, Y. and H. Tschofenig, &#34;Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption&#34;, RFC 5723, DOI 10.17487/RFC5723, January 2010, &lt;http://www.rfc-editor.org/info/rfc5723&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC5723] Sheffer、Y。、およびH. Tschofenig、「インターネットキー交換プロトコルバージョン2（IKEv2）セッション再開」、RFC 5723、DOI 10.17487 / RFC5723、2010年1月、&lt;http://www.rfc-editor.org/ info / rfc5723&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296] Kaufman, C., Hoffman, P., Nir, Y., Eronen, P., and T. Kivinen, &#34;Internet Key Exchange Protocol Version 2 (IKEv2)&#34;, STD 79, RFC 7296, DOI 10.17487/RFC7296, October 2014, &lt;http://www.rfc-editor.org/info/rfc7296&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7296] Kaufman、C.、Hoffman、P.、Nir、Y.、Eronen、P。、およびT. Kivinen、「インターネットキー交換プロトコルバージョン2（IKEv2）」、STD 79、RFC 7296、DOI 10.17487 / RFC7296 、2014年10月、&lt;http://www.rfc-editor.org/info/rfc7296&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7383] Smyslov, V., &#34;Internet Key Exchange Protocol Version 2 (IKEv2) Message Fragmentation&#34;, RFC 7383, DOI 10.17487/RFC7383, November 2014, &lt;http://www.rfc-editor.org/info/rfc7383&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7383] Smyslov、V。、「インターネットキー交換プロトコルバージョン2（IKEv2）メッセージの断片化」、RFC 7383、DOI 10.17487 / RFC7383、2014年11月、&lt;http://www.rfc-editor.org/info/rfc7383&gt; 。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12.2. Informative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
12.2。 参考資料
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[BITCOINS] Nakamoto, S., &#34;Bitcoin: A Peer-to-Peer Electronic Cash System&#34;, October 2008, &lt;https://bitcoin.org/bitcoin.pdf&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[BITCOINS] Nakamoto、S.、「ビットコイン：ピアツーピア電子キャッシュシステム」、2008年10月、&lt;https://bitcoin.org/bitcoin.pdf&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7619] Smyslov, V. and P. Wouters, &#34;The NULL Authentication Method in the Internet Key Exchange Protocol Version 2 (IKEv2)&#34;, RFC 7619, DOI 10.17487/RFC7619, August 2015, &lt;http://www.rfc-editor.org/info/rfc7619&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7619] Smyslov、V。およびP. Wouters、「インターネットキー交換プロトコルバージョン2（IKEv2）のNULL認証方式」、RFC 7619、DOI 10.17487 / RFC7619、2015年8月、&lt;http：//www.rfc- editor.org/info/rfc7619&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7696] Housley, R., &#34;Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms&#34;, BCP 201, RFC 7696, DOI 10.17487/RFC7696, November 2015, &lt;http://www.rfc-editor.org/info/rfc7696&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
[RFC7696] Housley、R。、「暗号化アルゴリズムの敏ility性および必須アルゴリズムから実装アルゴリズムの選択に関するガイドライン」、BCP 201、RFC 7696、DOI 10.17487 / RFC7696、2015年11月、&lt;http://www.rfc-editor.org / info / rfc7696&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Acknowledgements
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
謝辞
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
The authors thank Tero Kivinen, Yaron Sheffer, and Scott Fluhrer for their contributions to the design of the protocol. In particular, Tero Kivinen suggested the kind of puzzle where the task is to find a solution with a requested number of zero trailing bits. Yaron Sheffer and Scott Fluhrer suggested a way to make puzzle difficulty less erratic by solving several weaker puzzles. The authors also thank David Waltermire and Paul Wouters for their careful reviews of the document, Graham Bartlett for pointing out the possibility of an attack related to &#34;Hash &amp; URL&#34;, Stephen Farrell for catching the repeated cookie issue, and all others who commented on the document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著者は、プロトコルの設計に貢献してくれたTero Kivinen、Yaron Sheffer、およびScott Fluhrerに感謝します。 特に、Tero Kivinenは、要求された数のゼロトレーリングビットを持つソリューションを見つけることが課題であるようなパズルを提案しました。 Yaron ShefferとScott Fluhrerは、いくつかの弱いパズルを解くことで、パズルの難易度を低くする方法を提案しました。 著者はまた、文書を注意深くレビューしてくれたDavid WaltermireとPaul Wouters、「Hash＆URL」に関連する攻撃の可能性を指摘したGraham Bartlett、繰り返されるCookieの問題をキャッチしたStephen Farrell、およびコメントした他のすべてに感謝します ドキュメント。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Authors&#39; Addresses
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
著者のアドレス
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Yoav Nir Check Point Software Technologies Ltd. 5 Hasolelim st. Tel Aviv 6789735 Israel
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Yoav Nir Check Point Software Technologies Ltd. 5 Hasolelim st。 テルアビブ6789735イスラエル
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Email: ynir.ietf@gmail.com
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
メール：ynir.ietf@gmail.com
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Valery Smyslov ELVIS-PLUS PO Box 81 Moscow (Zelenograd) 124460 Russian Federation
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
Valery Smyslov ELVIS-PLUS PO Box 81 Moscow（Zelenograd）124460ロシア連邦
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text">
Phone: +7 495 276 0211 Email: svan@elvis.ru
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text">
電話：+7 495 276 0211メール：svan@elvis.ru
        </p>
      </div>
    </div>
  </div>
  <div class="footer"></div>
</body>
</html>
